# Ğ Ğ¾Ğ·Ğ´Ñ–Ğ» 51: WebAssembly â€” ĞĞ³ĞµĞ½Ñ‚Ğ¸ Ñƒ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ñ–

---

## ğŸ“‹ ĞĞ½Ğ¾Ñ‚Ğ°Ñ†Ñ–Ñ

Ğ’Ğ¸ Ğ¿Ğ¾Ğ±ÑƒĞ´ÑƒĞ²Ğ°Ğ»Ğ¸ Ğ¿Ğ¾Ñ‚ÑƒĞ¶Ğ½Ñƒ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ: BDI-Ğ°Ğ³ĞµĞ½Ñ‚Ğ¸ Ğ· Ğ¿Ğ»Ğ°Ğ½Ğ°Ğ¼Ğ¸, Ğ¼ĞµÑ€ĞµĞ¶ĞµĞ²Ğ° ĞºĞ¾Ğ¼ÑƒĞ½Ñ–ĞºĞ°Ñ†Ñ–Ñ, ECS Ğ´Ğ»Ñ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±ÑƒĞ²Ğ°Ğ½Ğ½Ñ. ĞĞ»Ğµ ÑĞº **Ğ¿Ğ¾Ğ±Ğ°Ñ‡Ğ¸Ñ‚Ğ¸** Ñ€Ñ–Ğ¹ Ğ² Ğ´Ñ–Ñ—? Ğ¯Ğº Ğ´Ğ°Ñ‚Ğ¸ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ñƒ **Ñ–Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ** Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ½Ñ–Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ñƒ Ñ‚Ğ° ĞºĞµÑ€ÑƒĞ²Ğ°Ğ½Ğ½Ñ?

**WebAssembly (Wasm)** Ğ´Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑÑ” Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğ¸ Rust-ĞºĞ¾Ğ´ **Ğ¿Ñ€ÑĞ¼Ğ¾ Ñƒ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ñ–** Ğ· Ğ±Ğ»Ğ¸Ğ·ÑŒĞºĞ¾Ñ Ğ´Ğ¾ Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ñ— Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¸Ğ²Ğ½Ñ–ÑÑ‚Ñ. Ğ¦Ğµ Ğ²Ñ–Ğ´ĞºÑ€Ğ¸Ğ²Ğ°Ñ” Ğ¼Ğ¾Ğ¶Ğ»Ğ¸Ğ²Ğ¾ÑÑ‚Ñ–:
- **Ğ’Ñ–Ğ·ÑƒĞ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ** Ñ€Ğ¾Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ñ–Ğ² Ñƒ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ Ñ‡Ğ°ÑÑ–
- **Ğ†Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¸Ğ¹ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ** Ñ‡ĞµÑ€ĞµĞ· Ğ²ĞµĞ±-Ñ–Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ
- **Ğ¡Ğ¸Ğ¼ÑƒĞ»ÑÑ†Ñ–Ñ—** Ğ½Ğ° ĞºĞ»Ñ–Ñ”Ğ½Ñ‚ÑÑŒĞºĞ¸Ñ… Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ°Ñ… Ğ±ĞµĞ· Ğ²ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ ĞŸĞ—
- **Edge computing** â€” Ğ¾Ğ±Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ½Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ° Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ñ–

Ğ¦ĞµĞ¹ Ñ€Ğ¾Ğ·Ğ´Ñ–Ğ» Ğ¾Ñ…Ğ¾Ğ¿Ğ»ÑÑ” Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñƒ WebAssembly, ĞµĞºĞ¾ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ñ–Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ–Ğ² Rust â†’ Wasm, Ñ‚Ğ° Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸Ñ‡Ğ½Ñƒ Ñ€ĞµĞ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ²Ñ–Ğ·ÑƒĞ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ— Ñ€Ğ¾Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ñ–Ğ².

---

## ğŸ¯ Ğ¦Ñ–Ğ»Ñ– Ğ½Ğ°Ğ²Ñ‡Ğ°Ğ½Ğ½Ñ

ĞŸÑ–ÑĞ»Ñ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ Ñ†ÑŒĞ¾Ğ³Ğ¾ Ñ€Ğ¾Ğ·Ğ´Ñ–Ğ»Ñƒ Ğ²Ğ¸ Ğ·Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ:

1. **ĞŸĞ¾ÑÑĞ½Ğ¸Ñ‚Ğ¸** Ñ‰Ğ¾ Ñ‚Ğ°ĞºĞµ WebAssembly Ñ‚Ğ° Ñ‡Ğ¾Ğ¼Ñƒ Ğ²Ğ¾Ğ½Ğ¾ Ğ²Ğ°Ğ¶Ğ»Ğ¸Ğ²Ğµ
2. **ĞĞ¿Ğ¸ÑĞ°Ñ‚Ğ¸** Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ Ğ¿Ğ°Ğ¼'ÑÑ‚Ñ– Ñ‚Ğ° Ğ±ĞµĞ·Ğ¿ĞµĞºĞ¸ Wasm
3. **Ğ’Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒĞ²Ğ°Ñ‚Ğ¸** wasm-pack Ñ‚Ğ° wasm-bindgen
4. **Ğ¡Ñ‚Ğ²Ğ¾Ñ€ÑĞ²Ğ°Ñ‚Ğ¸** Ğ²Ğ·Ğ°Ñ”Ğ¼Ğ¾Ğ´Ñ–Ñ Ğ¼Ñ–Ğ¶ Rust Ñ‚Ğ° JavaScript
5. **Ğ ĞµĞ°Ğ»Ñ–Ğ·ÑƒĞ²Ğ°Ñ‚Ğ¸** Canvas-Ğ²Ñ–Ğ·ÑƒĞ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ñ€Ğ¾Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ñ–Ğ²
6. **Ğ‘ÑƒĞ´ÑƒĞ²Ğ°Ñ‚Ğ¸** Ñ–Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ– Ğ²ĞµĞ±-Ğ·Ğ°ÑÑ‚Ğ¾ÑÑƒĞ½ĞºĞ¸ Ğ½Ğ° Rust

---

## ğŸ“š ĞšĞ»ÑÑ‡Ğ¾Ğ²Ñ– Ñ‚ĞµÑ€Ğ¼Ñ–Ğ½Ğ¸

| Ğ¢ĞµÑ€Ğ¼Ñ–Ğ½ | Ğ’Ğ¸Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ |
|--------|------------|
| **WebAssembly (Wasm)** | Ğ‘Ñ–Ğ½Ğ°Ñ€Ğ½Ğ¸Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ´Ğ»Ñ Ğ²Ğ¸ĞºĞ¾Ğ½Ğ°Ğ½Ğ½Ñ ĞºĞ¾Ğ´Ñƒ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ñ– |
| **wasm-pack** | Ğ†Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ·Ğ±Ñ–Ñ€ĞºĞ¸ Rust â†’ Wasm |
| **wasm-bindgen** | Ğ‘Ñ–Ğ±Ğ»Ñ–Ğ¾Ñ‚ĞµĞºĞ° Ğ´Ğ»Ñ Ğ²Ğ·Ğ°Ñ”Ğ¼Ğ¾Ğ´Ñ–Ñ— Rust â†” JavaScript |
| **web-sys** | Rust bindings Ğ´Ğ¾ Web APIs (DOM, Canvas, etc.) |
| **js-sys** | Rust bindings Ğ´Ğ¾ JavaScript ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ¾Ñ— Ğ±Ñ–Ğ±Ğ»Ñ–Ğ¾Ñ‚ĞµĞºĞ¸ |
| **Linear memory** | Ğ›Ñ–Ğ½Ñ–Ğ¹Ğ½Ğ° Ğ¿Ğ°Ğ¼'ÑÑ‚ÑŒ Wasm â€” Ğ¾Ğ´Ğ¸Ğ½ Ğ±ĞµĞ·Ğ¿ĞµÑ€ĞµÑ€Ğ²Ğ½Ğ¸Ğ¹ Ğ¼Ğ°ÑĞ¸Ğ² |
| **Canvas API** | Ğ‘Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ½Ğ¸Ğ¹ API Ğ´Ğ»Ñ 2D Ğ³Ñ€Ğ°Ñ„Ñ–ĞºĞ¸ |

---

## ğŸ’¡ ĞœĞ¾Ñ‚Ğ¸Ğ²Ğ°Ñ†Ñ–Ğ¹Ğ½Ğ¸Ğ¹ ĞºĞµĞ¹Ñ: Ğ¦ĞµĞ½Ñ‚Ñ€ ĞºĞµÑ€ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ñ€Ğ¾Ñ”Ğ¼

Ğ£ÑĞ²Ñ–Ğ¼Ğ¾: Ğ²Ğ¸ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ Ñ€Ğ¾Ñ Ğ· 50 Ğ‘ĞŸĞ›Ğ. Ğ’Ğ°Ğ¼ Ğ¿Ğ¾Ñ‚Ñ€Ñ–Ğ±ĞµĞ½ Ñ–Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ´Ğ»Ñ:
- Ğ‘Ğ°Ñ‡Ğ¸Ñ‚Ğ¸ Ğ²ÑÑ–Ñ… Ğ°Ğ³ĞµĞ½Ñ‚Ñ–Ğ² Ğ½Ğ° ĞºĞ°Ñ€Ñ‚Ñ– Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ Ñ‡Ğ°ÑÑ–
- ĞĞ±Ğ¸Ñ€Ğ°Ñ‚Ğ¸ Ğ°Ğ³ĞµĞ½Ñ‚Ğ° Ñ– Ğ±Ğ°Ñ‡Ğ¸Ñ‚Ğ¸ Ğ¹Ğ¾Ğ³Ğ¾ Ğ´ĞµÑ‚Ğ°Ğ»Ñ–
- ĞĞ°Ğ´ÑĞ¸Ğ»Ğ°Ñ‚Ğ¸ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¸ Ğ¾ĞºÑ€ĞµĞ¼Ğ¸Ğ¼ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°Ğ¼ Ğ°Ğ±Ğ¾ Ğ³Ñ€ÑƒĞ¿Ğ°Ğ¼
- Ğ‘Ğ°Ñ‡Ğ¸Ñ‚Ğ¸ Ğ°Ğ»ĞµÑ€Ñ‚Ğ¸ Ñ‚Ğ° ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ Ğ¼Ñ–ÑÑ–Ñ—

**Ğ’Ğ°Ñ€Ñ–Ğ°Ğ½Ñ‚ 1: Desktop application**
- ĞŸĞ¾Ñ‚Ñ€Ñ–Ğ±Ğ½Ğ¾ Ğ²ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ÑĞ²Ğ°Ñ‚Ğ¸
- Ğ¡ĞºĞ»Ğ°Ğ´Ğ½Ğ¾ Ğ¾Ğ½Ğ¾Ğ²Ğ»ÑĞ²Ğ°Ñ‚Ğ¸
- Ğ Ñ–Ğ·Ğ½Ñ– Ğ²ĞµÑ€ÑÑ–Ñ— Ğ´Ğ»Ñ Windows/Mac/Linux

**Ğ’Ğ°Ñ€Ñ–Ğ°Ğ½Ñ‚ 2: Web application Ğ· WebAssembly**
- ĞŸÑ€Ğ°Ñ†ÑÑ” Ğ² Ğ±ÑƒĞ´ÑŒ-ÑĞºĞ¾Ğ¼Ñƒ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ñ–
- ĞÑ–Ñ‡Ğ¾Ğ³Ğ¾ Ğ²ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ÑĞ²Ğ°Ñ‚Ğ¸
- ĞĞ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ Ğ¼Ğ¸Ñ‚Ñ‚Ñ”Ğ²Ñ–
- **ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¸Ğ²Ğ½Ñ–ÑÑ‚ÑŒ Rust** Ğ´Ğ»Ñ ÑĞºĞ»Ğ°Ğ´Ğ½Ğ¸Ñ… Ğ¾Ğ±Ñ‡Ğ¸ÑĞ»ĞµĞ½ÑŒ

---

## 51.1 Ğ©Ğ Ğ¢ĞĞšĞ• WEBASSEMBLY

### 51.1.1 Ğ†ÑÑ‚Ğ¾Ñ€Ñ–Ñ Ñ‚Ğ° Ğ¼Ğ¾Ñ‚Ğ¸Ğ²Ğ°Ñ†Ñ–Ñ

**Ğ¥Ñ€Ğ¾Ğ½Ğ¾Ğ»Ğ¾Ğ³Ñ–Ñ ĞµĞ²Ğ¾Ğ»ÑÑ†Ñ–Ñ— Ğ²ĞµĞ±-Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ñ–Ğ¹:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ•Ğ’ĞĞ›Ğ®Ğ¦Ğ†Ğ¯ Ğ’Ğ˜ĞšĞĞĞĞĞĞ¯ ĞšĞĞ”Ğ£ Ğ’ Ğ‘Ğ ĞĞ£Ğ—Ğ•Ğ Ğ†                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1995: JavaScript                                                  â”‚
â”‚  â””â”€â”€ Ğ†Ğ½Ñ‚ĞµÑ€Ğ¿Ñ€ĞµÑ‚Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ¼Ğ¾Ğ²Ğ°, Ğ¿Ğ¾Ğ²Ñ–Ğ»ÑŒĞ½Ğ°                                 â”‚
â”‚                                                                     â”‚
â”‚  2008: V8 Ñ‚Ğ° JIT ĞºĞ¾Ğ¼Ğ¿Ñ–Ğ»ÑÑ†Ñ–Ñ                                        â”‚
â”‚  â””â”€â”€ JavaScript ÑÑ‚Ğ°Ğ² Ğ½Ğ°Ğ±Ğ°Ğ³Ğ°Ñ‚Ğ¾ ÑˆĞ²Ğ¸Ğ´ÑˆĞ¸Ğ¼                              â”‚
â”‚  â””â”€â”€ ĞĞ»Ğµ Ğ²ÑĞµ Ñ‰Ğµ Ñ–Ğ½Ñ‚ĞµÑ€Ğ¿Ñ€ĞµÑ‚Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ¼Ğ¾Ğ²Ğ° Ğ· Ğ´Ğ¸Ğ½Ğ°Ğ¼Ñ–Ñ‡Ğ½Ğ¸Ğ¼Ğ¸ Ñ‚Ğ¸Ğ¿Ğ°Ğ¼Ğ¸           â”‚
â”‚                                                                     â”‚
â”‚  2013: asm.js (Mozilla)                                            â”‚
â”‚  â””â”€â”€ ĞŸÑ–Ğ´Ğ¼Ğ½Ğ¾Ğ¶Ğ¸Ğ½Ğ° JavaScript Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ñ–Ğ·Ğ°Ñ†Ñ–Ñ—                         â”‚
â”‚  â””â”€â”€ "use asm"; â€” Ğ¿Ñ–Ğ´ĞºĞ°Ğ·ĞºĞ° ĞºĞ¾Ğ¼Ğ¿Ñ–Ğ»ÑÑ‚Ğ¾Ñ€Ñƒ                             â”‚
â”‚  â””â”€â”€ C/C++ â†’ Emscripten â†’ asm.js                                   â”‚
â”‚                                                                     â”‚
â”‚  2017: WebAssembly 1.0                                             â”‚
â”‚  â””â”€â”€ Ğ‘Ñ–Ğ½Ğ°Ñ€Ğ½Ğ¸Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚, ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ W3C                         â”‚
â”‚  â””â”€â”€ ĞŸÑ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ĞºĞ° Ğ²ÑÑ–Ğ¼Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¸Ğ¼Ğ¸ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ°Ğ¼Ğ¸                          â”‚
â”‚  â””â”€â”€ Ğ‘Ğ»Ğ¸Ğ·ÑŒĞºĞ° Ğ´Ğ¾ Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ñ— Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¸Ğ²Ğ½Ñ–ÑÑ‚ÑŒ                            â”‚
â”‚                                                                     â”‚
â”‚  2020+: WASI, GC proposal, Threads                                 â”‚
â”‚  â””â”€â”€ WebAssembly Ğ²Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒ Ğ·Ğ° Ğ¼ĞµĞ¶Ñ– Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ°                         â”‚
â”‚  â””â”€â”€ Ğ¡ĞµÑ€Ğ²ĞµÑ€Ğ½Ğ¸Ğ¹ Wasm, edge computing                                â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 51.1.2 Ğ©Ğ¾ Ñ‚Ğ°ĞºĞµ WebAssembly?

**WebAssembly (Wasm)** â€” Ñ†Ğµ:
- **Ğ‘Ñ–Ğ½Ğ°Ñ€Ğ½Ğ¸Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚** Ñ–Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ñ–Ğ¹ Ğ´Ğ»Ñ ÑÑ‚ĞµĞºĞ¾Ğ²Ğ¾Ñ— Ğ²Ñ–Ñ€Ñ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ñ— Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ¸
- **ĞŸĞ¾Ñ€Ñ‚Ğ°Ğ±ĞµĞ»ÑŒĞ½Ğ¸Ğ¹** â€” Ğ¿Ñ€Ğ°Ñ†ÑÑ” Ğ¾Ğ´Ğ½Ğ°ĞºĞ¾Ğ²Ğ¾ Ğ½Ğ° Ñ€Ñ–Ğ·Ğ½Ğ¸Ñ… Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ…
- **Ğ‘ĞµĞ·Ğ¿ĞµÑ‡Ğ½Ğ¸Ğ¹** â€” Ğ²Ğ¸ĞºĞ¾Ğ½ÑƒÑ”Ñ‚ÑŒÑÑ Ğ² sandbox
- **Ğ¨Ğ²Ğ¸Ğ´ĞºĞ¸Ğ¹** â€” Ğ±Ğ»Ğ¸Ğ·ÑŒĞºĞ° Ğ´Ğ¾ Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ñ— Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¸Ğ²Ğ½Ñ–ÑÑ‚ÑŒ

**WebAssembly â€” Ñ†Ğµ ĞĞ•:**
- ĞœĞ¾Ğ²Ğ° Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼ÑƒĞ²Ğ°Ğ½Ğ½Ñ (Ñ…Ğ¾Ñ‡Ğ° Ñ” Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¸Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ WAT)
- Ğ—Ğ°Ğ¼Ñ–Ğ½Ğ° JavaScript (Ğ²Ğ¾Ğ½Ğ¸ Ğ´Ğ¾Ğ¿Ğ¾Ğ²Ğ½ÑÑÑ‚ÑŒ Ğ¾Ğ´Ğ¸Ğ½ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾)
- Ğ¢Ñ–Ğ»ÑŒĞºĞ¸ Ğ´Ğ»Ñ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ° (WASI Ğ´Ğ»Ñ ÑĞµÑ€Ğ²ĞµÑ€Ñ–Ğ²)

### 51.1.3 Ğ¯Ğº Ñ†Ğµ Ğ¿Ñ€Ğ°Ñ†ÑÑ”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WEBASSEMBLY PIPELINE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Ğ’Ğ˜Ğ¥Ğ†Ğ”ĞĞ˜Ğ™ ĞšĞĞ”                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  Rust   â”‚  â”‚   C++   â”‚  â”‚   Go    â”‚  â”‚AssemblySâ”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜               â”‚
â”‚       â”‚            â”‚            â”‚            â”‚                      â”‚
â”‚       â–¼            â–¼            â–¼            â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚              ĞšĞĞœĞŸĞ†Ğ›Ğ¯Ğ¢ĞĞ  â†’ .wasm                 â”‚               â”‚
â”‚  â”‚   (LLVM backend, Emscripten, TinyGo, etc.)      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                            â”‚                                        â”‚
â”‚                            â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚               .wasm ĞœĞĞ”Ğ£Ğ›Ğ¬                       â”‚               â”‚
â”‚  â”‚    Ğ‘Ñ–Ğ½Ğ°Ñ€Ğ½Ğ¸Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚, Ğ¿Ğ¾Ñ€Ñ‚Ğ°Ğ±ĞµĞ»ÑŒĞ½Ğ¸Ğ¹, ĞºĞ¾Ğ¼Ğ¿Ğ°ĞºÑ‚Ğ½Ğ¸Ğ¹    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                            â”‚                                        â”‚
â”‚                            â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚                  Ğ‘Ğ ĞĞ£Ğ—Ğ•Ğ                          â”‚               â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚               â”‚
â”‚  â”‚  â”‚         Wasm Runtime (V8, SpiderMonkey)  â”‚  â”‚               â”‚
â”‚  â”‚  â”‚                                          â”‚  â”‚               â”‚
â”‚  â”‚  â”‚  â€¢ Ğ’Ğ°Ğ»Ñ–Ğ´Ğ°Ñ†Ñ–Ñ Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ                      â”‚  â”‚               â”‚
â”‚  â”‚  â”‚  â€¢ ĞšĞ¾Ğ¼Ğ¿Ñ–Ğ»ÑÑ†Ñ–Ñ Ğ² Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ½Ğ¸Ğ¹ ĞºĞ¾Ğ´             â”‚  â”‚               â”‚
â”‚  â”‚  â”‚  â€¢ Ğ’Ğ¸ĞºĞ¾Ğ½Ğ°Ğ½Ğ½Ñ Ğ² sandbox                   â”‚  â”‚               â”‚
â”‚  â”‚  â”‚  â€¢ Ğ’Ğ·Ğ°Ñ”Ğ¼Ğ¾Ğ´Ñ–Ñ Ğ· JavaScript                â”‚  â”‚               â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 51.1.4 ĞŸĞ¾Ñ€Ñ–Ğ²Ğ½ÑĞ½Ğ½Ñ Ğ· JavaScript

| ĞÑĞ¿ĞµĞºÑ‚ | JavaScript | WebAssembly |
|--------|------------|-------------|
| **Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚** | Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¸Ğ¹ | Ğ‘Ñ–Ğ½Ğ°Ñ€Ğ½Ğ¸Ğ¹ |
| **Ğ¢Ğ¸Ğ¿Ñ–Ğ·Ğ°Ñ†Ñ–Ñ** | Ğ”Ğ¸Ğ½Ğ°Ğ¼Ñ–Ñ‡Ğ½Ğ° | Ğ¡Ñ‚Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ° (i32, i64, f32, f64) |
| **ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³** | ĞŸĞ¾Ğ²Ñ–Ğ»ÑŒĞ½Ğ¸Ğ¹ | Ğ¨Ğ²Ğ¸Ğ´ĞºĞ¸Ğ¹ (streaming) |
| **ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¸Ğ²Ğ½Ñ–ÑÑ‚ÑŒ** | JIT, Ğ²Ğ°Ñ€Ñ–Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ° | Ğ‘Ğ»Ğ¸Ğ·ÑŒĞºĞ° Ğ´Ğ¾ Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ñ—, Ğ¿ĞµÑ€ĞµĞ´Ğ±Ğ°Ñ‡ÑƒĞ²Ğ°Ğ½Ğ° |
| **Garbage Collection** | Ğ’Ğ±ÑƒĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ | ĞĞµĞ¼Ğ°Ñ” (Ñ€ÑƒÑ‡Ğ½Ğµ ĞºĞµÑ€ÑƒĞ²Ğ°Ğ½Ğ½Ñ) |
| **DOM Ğ´Ğ¾ÑÑ‚ÑƒĞ¿** | ĞŸÑ€ÑĞ¼Ğ¸Ğ¹ | Ğ§ĞµÑ€ĞµĞ· JavaScript |
| **Ğ Ğ¾Ğ·Ğ¼Ñ–Ñ€** | Ğ’ĞµĞ»Ğ¸ĞºĞ¸Ğ¹ (Ñ‚ĞµĞºÑÑ‚) | ĞšĞ¾Ğ¼Ğ¿Ğ°ĞºÑ‚Ğ½Ğ¸Ğ¹ (Ğ±Ñ–Ğ½Ğ°Ñ€Ğ½Ğ¸Ğ¹) |
| **Debugging** | Ğ”Ğ¾Ğ±Ñ€Ğµ | ĞŸĞ¾ĞºÑ€Ğ°Ñ‰ÑƒÑ”Ñ‚ÑŒÑÑ |

### 51.1.5 Ğ¡Ñ‚ĞµĞºĞ¾Ğ²Ğ° Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ° WebAssembly

WebAssembly â€” Ñ†Ğµ **ÑÑ‚ĞµĞºĞ¾Ğ²Ğ° Ğ²Ñ–Ñ€Ñ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ° Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ°**. Ğ†Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ñ–Ñ— Ğ¾Ğ¿ĞµÑ€ÑƒÑÑ‚ÑŒ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½ÑĞ¼Ğ¸ Ğ½Ğ° ÑÑ‚ĞµĞºÑƒ:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ¡Ğ¢Ğ•ĞšĞĞ’Ğ ĞœĞĞ”Ğ•Ğ›Ğ¬ WASM                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´: Ğ¾Ğ±Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ½Ñ (a + b) * c                                   â”‚
â”‚                                                                     â”‚
â”‚  ;; WebAssembly Text Format (WAT)                                  â”‚
â”‚  (func $calc (param $a i32) (param $b i32) (param $c i32)          â”‚
â”‚               (result i32)                                          â”‚
â”‚    local.get $a     ;; ÑÑ‚ĞµĞº: [a]                                   â”‚
â”‚    local.get $b     ;; ÑÑ‚ĞµĞº: [a, b]                                â”‚
â”‚    i32.add          ;; ÑÑ‚ĞµĞº: [a+b]                                 â”‚
â”‚    local.get $c     ;; ÑÑ‚ĞµĞº: [a+b, c]                              â”‚
â”‚    i32.mul          ;; ÑÑ‚ĞµĞº: [(a+b)*c]                             â”‚
â”‚  )                                                                  â”‚
â”‚                                                                     â”‚
â”‚  Ğ’Ñ–Ğ·ÑƒĞ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ ÑÑ‚ĞµĞºÑƒ:                                               â”‚
â”‚                                                                     â”‚
â”‚  local.get $a  â”‚     local.get $b  â”‚     i32.add     â”‚             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚             â”‚
â”‚       â”Œâ”€â”€â”€â”    â”‚          â”Œâ”€â”€â”€â”    â”‚         â”Œâ”€â”€â”€â”   â”‚             â”‚
â”‚       â”‚ a â”‚    â”‚          â”‚ b â”‚    â”‚         â”‚a+bâ”‚   â”‚             â”‚
â”‚       â””â”€â”€â”€â”˜    â”‚          â”œâ”€â”€â”€â”¤    â”‚         â””â”€â”€â”€â”˜   â”‚             â”‚
â”‚                â”‚          â”‚ a â”‚    â”‚                 â”‚             â”‚
â”‚                â”‚          â””â”€â”€â”€â”˜    â”‚                 â”‚             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ¢Ğ¸Ğ¿Ğ¸ Ğ´Ğ°Ğ½Ğ¸Ñ… WebAssembly:**
- `i32` â€” 32-Ğ±Ñ–Ñ‚Ğ½Ğµ Ñ†Ñ–Ğ»Ğµ
- `i64` â€” 64-Ğ±Ñ–Ñ‚Ğ½Ğµ Ñ†Ñ–Ğ»Ğµ  
- `f32` â€” 32-Ğ±Ñ–Ñ‚Ğ½Ğµ Ğ· Ğ¿Ğ»Ğ°Ğ²Ğ°ÑÑ‡Ğ¾Ñ Ñ‚Ğ¾Ñ‡ĞºĞ¾Ñ
- `f64` â€” 64-Ğ±Ñ–Ñ‚Ğ½Ğµ Ğ· Ğ¿Ğ»Ğ°Ğ²Ğ°ÑÑ‡Ğ¾Ñ Ñ‚Ğ¾Ñ‡ĞºĞ¾Ñ
- `v128` â€” 128-Ğ±Ñ–Ñ‚Ğ½Ğ¸Ğ¹ Ğ²ĞµĞºÑ‚Ğ¾Ñ€ (SIMD)
- `funcref`, `externref` â€” Ğ¿Ğ¾ÑĞ¸Ğ»Ğ°Ğ½Ğ½Ñ

---

## 51.2 ĞœĞĞ”Ğ•Ğ›Ğ¬ ĞŸĞĞœ'Ğ¯Ğ¢Ğ† Ğ¢Ğ Ğ‘Ğ•Ğ—ĞŸĞ•ĞšĞ˜

### 51.2.1 Ğ›Ñ–Ğ½Ñ–Ğ¹Ğ½Ğ° Ğ¿Ğ°Ğ¼'ÑÑ‚ÑŒ

WebAssembly Ğ¼Ğ°Ñ” **Ğ»Ñ–Ğ½Ñ–Ğ¹Ğ½Ñƒ Ğ¿Ğ°Ğ¼'ÑÑ‚ÑŒ** â€” Ğ¾Ğ´Ğ¸Ğ½ Ğ±ĞµĞ·Ğ¿ĞµÑ€ĞµÑ€Ğ²Ğ½Ğ¸Ğ¹ Ğ¼Ğ°ÑĞ¸Ğ² Ğ±Ğ°Ğ¹Ñ‚Ñ–Ğ²:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ›Ğ†ĞĞ†Ğ™ĞĞ ĞŸĞĞœ'Ğ¯Ğ¢Ğ¬ WASM                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  0x0000    0x1000    0x2000    0x3000    0x4000    ...      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚   â”‚
â”‚  â”‚  â”‚Stack â”‚   Heap   â”‚  Data   â”‚ Globals  â”‚      Free        â”‚â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  â€¢ Ğ Ğ¾Ğ·Ğ¼Ñ–Ñ€ ĞºÑ€Ğ°Ñ‚Ğ½Ğ¸Ğ¹ 64KB (ÑÑ‚Ğ¾Ñ€Ñ–Ğ½ĞºĞ¸)                                  â”‚
â”‚  â€¢ ĞœĞ¾Ğ¶Ğµ Ğ·Ñ€Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¸ (memory.grow)                                     â”‚
â”‚  â€¢ Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ñ‡ĞµÑ€ĞµĞ· load/store Ñ–Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ñ–Ñ—                              â”‚
â”‚  â€¢ JavaScript Ğ±Ğ°Ñ‡Ğ¸Ñ‚ÑŒ ÑĞº ArrayBuffer                                â”‚
â”‚                                                                     â”‚
â”‚  Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğ· JavaScript:                                              â”‚
â”‚  const memory = instance.exports.memory;                           â”‚
â”‚  const view = new Uint8Array(memory.buffer);                       â”‚
â”‚  view[100] = 42;  // ĞŸĞ¸ÑˆĞµĞ¼Ğ¾ Ğ² Ğ¿Ğ°Ğ¼'ÑÑ‚ÑŒ Wasm                        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 51.2.2 Sandbox Ñ‚Ğ° Ğ±ĞµĞ·Ğ¿ĞµĞºĞ°

WebAssembly Ğ²Ğ¸ĞºĞ¾Ğ½ÑƒÑ”Ñ‚ÑŒÑÑ Ğ² **Ñ–Ğ·Ğ¾Ğ»ÑŒĞ¾Ğ²Ğ°Ğ½Ğ¾Ğ¼Ñƒ sandbox**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WASM SANDBOX                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Ğ‘Ğ ĞĞ£Ğ—Ğ•Ğ                                    â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚              WASM SANDBOX                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   Wasm Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ ĞĞ• ĞœĞĞ–Ğ•:                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   âœ— Ğ§Ğ¸Ñ‚Ğ°Ñ‚Ğ¸/Ğ¿Ğ¸ÑĞ°Ñ‚Ğ¸ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²Ñƒ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   âœ— Ğ Ğ¾Ğ±Ğ¸Ñ‚Ğ¸ Ğ¼ĞµÑ€ĞµĞ¶ĞµĞ²Ñ– Ğ·Ğ°Ğ¿Ğ¸Ñ‚Ğ¸ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼Ñƒ                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   âœ— Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ°Ñ‚Ğ¸ÑÑŒ Ğ´Ğ¾ DOM Ğ½Ğ°Ğ¿Ñ€ÑĞ¼Ñƒ                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   âœ— Ğ’Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚Ğ¸ Ğ·Ğ° Ğ¼ĞµĞ¶Ñ– ÑĞ²Ğ¾Ñ”Ñ— Ğ»Ñ–Ğ½Ñ–Ğ¹Ğ½Ğ¾Ñ— Ğ¿Ğ°Ğ¼'ÑÑ‚Ñ–        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   âœ— Ğ’Ğ¸ĞºĞ»Ğ¸ĞºĞ°Ñ‚Ğ¸ Ğ´Ğ¾Ğ²Ñ–Ğ»ÑŒĞ½Ğ¸Ğ¹ ĞºĞ¾Ğ´                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   Wasm Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ ĞœĞĞ–Ğ•:                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   âœ“ Ğ’Ğ¸ĞºĞ¾Ğ½ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ¾Ğ±Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ½Ñ                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   âœ“ ĞŸÑ€Ğ°Ñ†ÑĞ²Ğ°Ñ‚Ğ¸ Ğ·Ñ– ÑĞ²Ğ¾Ñ”Ñ Ğ»Ñ–Ğ½Ñ–Ğ¹Ğ½Ğ¾Ñ Ğ¿Ğ°Ğ¼'ÑÑ‚Ñ‚Ñ          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   âœ“ Ğ’Ğ¸ĞºĞ»Ğ¸ĞºĞ°Ñ‚Ğ¸ Ñ–Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ²Ğ°Ğ½Ñ– Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ—                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   âœ“ Ğ•ĞºÑĞ¿Ğ¾Ñ€Ñ‚ÑƒĞ²Ğ°Ñ‚Ğ¸ Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ— Ğ´Ğ»Ñ JavaScript            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                        â”‚ imports/exports                    â”‚   â”‚
â”‚  â”‚                        â–¼                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚              JAVASCRIPT GLUE                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   ĞĞ°Ğ´Ğ°Ñ” Wasm Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ´Ğ¾:                            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â€¢ DOM (Ñ‡ĞµÑ€ĞµĞ· Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ—-Ğ¾Ğ±Ğ³Ğ¾Ñ€Ñ‚ĞºĞ¸)                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â€¢ Fetch API                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â€¢ Canvas                                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â€¢ Console                                         â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ“Ğ°Ñ€Ğ°Ğ½Ñ‚Ñ–Ñ— Ğ±ĞµĞ·Ğ¿ĞµĞºĞ¸ WebAssembly:**
1. **Ğ’Ğ°Ğ»Ñ–Ğ´Ğ°Ñ†Ñ–Ñ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ–** â€” Ğ½ĞµĞ²Ğ°Ğ»Ñ–Ğ´Ğ½Ğ¸Ğ¹ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ Ğ½Ğµ Ğ²Ğ¸ĞºĞ¾Ğ½Ğ°Ñ”Ñ‚ÑŒÑÑ
2. **ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ° Ñ‚Ğ¸Ğ¿Ñ–Ğ²** â€” ÑÑ‚Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ° Ñ‚Ğ¸Ğ¿Ñ–Ğ·Ğ°Ñ†Ñ–Ñ, Ğ¿ĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ° Ğ½Ğ° ĞµÑ‚Ğ°Ğ¿Ñ– Ğ²Ğ°Ğ»Ñ–Ğ´Ğ°Ñ†Ñ–Ñ—
3. **Ğ†Ğ·Ğ¾Ğ»ÑÑ†Ñ–Ñ Ğ¿Ğ°Ğ¼'ÑÑ‚Ñ–** â€” ĞºĞ¾Ğ¶ĞµĞ½ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ Ğ¼Ğ°Ñ” ÑĞ²Ğ¾Ñ Ğ¿Ğ°Ğ¼'ÑÑ‚ÑŒ
4. **Control flow integrity** â€” ÑÑ‚Ñ€Ğ¸Ğ±ĞºĞ¸ Ñ‚Ñ–Ğ»ÑŒĞºĞ¸ Ğ½Ğ° Ğ²Ğ°Ğ»Ñ–Ğ´Ğ½Ñ– Ñ†Ñ–Ğ»Ñ–

### 51.2.3 Ğ§Ğ¾Ğ¼Ñƒ Rust Ñ–Ğ´ĞµĞ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ´Ğ»Ñ WebAssembly

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RUST + WASM = Ğ†Ğ”Ğ•ĞĞ›Ğ¬ĞĞ ĞŸĞĞ Ğ                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. ĞĞ•ĞœĞĞ„ GARBAGE COLLECTOR                                        â”‚
â”‚     â€¢ Python, Go, Java â†’ Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ÑŒ Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ‚Ğ¸ GC Ğ² Wasm             â”‚
â”‚     â€¢ Rust â†’ ownership ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°, Ğ½ĞµĞ¼Ğ°Ñ” runtime GC                   â”‚
â”‚     â€¢ Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚: Ğ¼ĞµĞ½ÑˆĞ¸Ğ¹ Ñ€Ğ¾Ğ·Ğ¼Ñ–Ñ€ .wasm Ñ„Ğ°Ğ¹Ğ»Ñƒ                         â”‚
â”‚                                                                     â”‚
â”‚  2. ĞŸĞ•Ğ Ğ•Ğ”Ğ‘ĞĞ§Ğ£Ğ’ĞĞĞ˜Ğ™ MEMORY LAYOUT                                   â”‚
â”‚     â€¢ #[repr(C)] â†’ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ğ½Ğ°Ğ´ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ½ÑĞ¼ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€            â”‚
â”‚     â€¢ Ğ›ĞµĞ³ĞºĞ¾ Ğ´Ñ–Ğ»Ğ¸Ñ‚Ğ¸ Ğ¿Ğ°Ğ¼'ÑÑ‚ÑŒ Ğ· JavaScript                            â”‚
â”‚                                                                     â”‚
â”‚  3. ĞœĞĞ›Ğ˜Ğ™ RUNTIME                                                  â”‚
â”‚     â€¢ Rust â†’ Wasm: Ğ¼Ñ–Ğ½Ñ–Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ overhead                            â”‚
â”‚     â€¢ Go â†’ Wasm: Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ” ÑƒĞ²ĞµÑÑŒ Go runtime (~2MB+)                  â”‚
â”‚                                                                     â”‚
â”‚  4. ZERO-COST ABSTRACTIONS                                         â”‚
â”‚     â€¢ Ğ†Ñ‚ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ğ¸, traits â†’ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Wasm ĞºĞ¾Ğ´                     â”‚
â”‚     â€¢ ĞĞµĞ¼Ğ°Ñ” runtime overhead                                       â”‚
â”‚                                                                     â”‚
â”‚  5. Ğ’Ğ†Ğ”ĞœĞ†ĞĞĞ Ğ•ĞšĞĞ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ                                            â”‚
â”‚     â€¢ wasm-bindgen â€” Ğ³Ğ»Ğ¸Ğ±Ğ¾ĞºĞ° Ñ–Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ñ–Ñ Ğ· JS                       â”‚
â”‚     â€¢ wasm-pack â€” Ğ·Ñ€ÑƒÑ‡Ğ½Ğ° Ğ·Ğ±Ñ–Ñ€ĞºĞ°                                    â”‚
â”‚     â€¢ web-sys â€” Ğ¿Ğ¾Ğ²Ğ½Ñ– bindings Ğ´Ğ¾ Web APIs                         â”‚
â”‚                                                                     â”‚
â”‚  Ğ¢Ğ˜ĞŸĞĞ’Ğ˜Ğ™ Ğ ĞĞ—ĞœĞ†Ğ  .wasm:                                             â”‚
â”‚  â€¢ Rust: 50-200 KB (gzipped)                                       â”‚
â”‚  â€¢ Go: 2-5 MB (Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ” runtime)                                    â”‚
â”‚  â€¢ C++: 50-500 KB (Ğ·Ğ°Ğ»ĞµĞ¶Ğ¸Ñ‚ÑŒ Ğ²Ñ–Ğ´ std)                               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 51.3 Ğ†ĞĞ¡Ğ¢Ğ Ğ£ĞœĞ•ĞĞ¢ĞĞ Ğ†Ğ™ RUST â†’ WASM

### 51.3.1 wasm-pack

**wasm-pack** â€” Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¸Ğ¹ Ñ–Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ·Ğ±Ñ–Ñ€ĞºĞ¸ Rust Ğ¿Ñ€Ğ¾Ñ”ĞºÑ‚Ñ–Ğ² Ñƒ WebAssembly:

```bash
# Ğ’ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ
cargo install wasm-pack

# Ğ—Ğ±Ñ–Ñ€ĞºĞ° Ğ´Ğ»Ñ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ° (ESM Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ–)
wasm-pack build --target web

# Ğ—Ğ±Ñ–Ñ€ĞºĞ° Ğ´Ğ»Ñ bundler (webpack, vite)
wasm-pack build --target bundler

# Ğ—Ğ±Ñ–Ñ€ĞºĞ° Ğ´Ğ»Ñ Node.js
wasm-pack build --target nodejs

# Release Ğ·Ğ±Ñ–Ñ€ĞºĞ° Ğ· Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ñ–Ğ·Ğ°Ñ†Ñ–ÑĞ¼Ğ¸
wasm-pack build --target web --release
```

**Ğ©Ğ¾ Ğ³ĞµĞ½ĞµÑ€ÑƒÑ” wasm-pack:**

```
pkg/
â”œâ”€â”€ package.json           # npm package metadata
â”œâ”€â”€ my_crate.js           # JavaScript glue code
â”œâ”€â”€ my_crate_bg.wasm      # Ğ¡ĞºĞ¾Ğ¼Ğ¿Ñ–Ğ»ÑŒĞ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ Wasm Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ
â”œâ”€â”€ my_crate_bg.wasm.d.ts # TypeScript Ñ‚Ğ¸Ğ¿Ğ¸ Ğ´Ğ»Ñ Wasm
â””â”€â”€ my_crate.d.ts         # TypeScript Ñ‚Ğ¸Ğ¿Ğ¸ Ğ´Ğ»Ñ JS
```

### 51.3.2 wasm-bindgen

**wasm-bindgen** â€” Ğ±Ñ–Ğ±Ğ»Ñ–Ğ¾Ñ‚ĞµĞºĞ° Ñ‚Ğ° Ñ–Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ²Ğ·Ğ°Ñ”Ğ¼Ğ¾Ğ´Ñ–Ñ— Rust â†” JavaScript:

```rust
use wasm_bindgen::prelude::*;

// Ğ•ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ— Ğ´Ğ»Ñ Ğ²Ğ¸ĞºĞ»Ğ¸ĞºÑƒ Ğ· JavaScript
#[wasm_bindgen]
pub fn greet(name: &str) -> String {
    format!("Hello, {}!", name)
}

// Ğ†Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ— Ğ· JavaScript
#[wasm_bindgen]
extern "C" {
    fn alert(s: &str);
    
    #[wasm_bindgen(js_namespace = console)]
    fn log(s: &str);
}

// Ğ•ĞºÑĞ¿Ğ¾Ñ€Ñ‚ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸
#[wasm_bindgen]
pub struct Agent {
    id: u32,
    x: f64,
    y: f64,
}

#[wasm_bindgen]
impl Agent {
    #[wasm_bindgen(constructor)]
    pub fn new(id: u32, x: f64, y: f64) -> Agent {
        Agent { id, x, y }
    }
    
    pub fn get_x(&self) -> f64 {
        self.x
    }
    
    pub fn move_by(&mut self, dx: f64, dy: f64) {
        self.x += dx;
        self.y += dy;
    }
}
```

### 51.3.3 web-sys Ñ‚Ğ° js-sys

**web-sys** â€” Rust bindings Ğ´Ğ¾ Ğ²ÑÑ–Ñ… Web APIs:

```rust
use web_sys::{Document, Element, HtmlCanvasElement, Window};

fn get_document() -> Document {
    let window: Window = web_sys::window()
        .expect("no global window");
    window.document()
        .expect("no document on window")
}

fn get_canvas(id: &str) -> HtmlCanvasElement {
    let document = get_document();
    let canvas = document
        .get_element_by_id(id)
        .expect("canvas not found");
    canvas
        .dyn_into::<HtmlCanvasElement>()
        .expect("not a canvas element")
}
```

**js-sys** â€” Rust bindings Ğ´Ğ¾ JavaScript ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ¾Ñ— Ğ±Ñ–Ğ±Ğ»Ñ–Ğ¾Ñ‚ĞµĞºĞ¸:

```rust
use js_sys::{Array, Date, Math, Object};

fn example() {
    // JavaScript Date.now()
    let now = Date::now();
    
    // JavaScript Math.random()
    let random = Math::random();
    
    // JavaScript Array
    let arr = Array::new();
    arr.push(&42.into());
}
```

### 51.3.4 Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾Ñ”ĞºÑ‚Ñƒ

```
my-wasm-visualization/
â”œâ”€â”€ Cargo.toml              # Rust Ğ·Ğ°Ğ»ĞµĞ¶Ğ½Ğ¾ÑÑ‚Ñ–
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs             # ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¸Ğ¹ Rust ĞºĞ¾Ğ´
â”‚   â”œâ”€â”€ agent.rs           # Ğ›Ğ¾Ğ³Ñ–ĞºĞ° Ğ°Ğ³ĞµĞ½Ñ‚Ñ–Ğ²
â”‚   â””â”€â”€ renderer.rs        # Ğ ĞµĞ½Ğ´ĞµÑ€Ğ¸Ğ½Ğ³ Ğ½Ğ° Canvas
â”œâ”€â”€ www/                    # Ğ’ĞµĞ±-Ğ·Ğ°ÑÑ‚Ğ¾ÑÑƒĞ½Ğ¾Ğº
â”‚   â”œâ”€â”€ index.html         # HTML ÑÑ‚Ğ¾Ñ€Ñ–Ğ½ĞºĞ°
â”‚   â”œâ”€â”€ index.js           # JavaScript entry point
â”‚   â””â”€â”€ style.css          # Ğ¡Ñ‚Ğ¸Ğ»Ñ–
â””â”€â”€ pkg/                    # Ğ—Ğ³ĞµĞ½ĞµÑ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ wasm-pack
    â””â”€â”€ ...
```

**Cargo.toml:**

```toml
[package]
name = "swarm-visualization"
version = "0.1.0"
edition = "2021"

[lib]
crate-type = ["cdylib", "rlib"]

[dependencies]
wasm-bindgen = "0.2"
js-sys = "0.3"
serde = { version = "1.0", features = ["derive"] }
serde-wasm-bindgen = "0.6"

[dependencies.web-sys]
version = "0.3"
features = [
    "Document",
    "Element",
    "HtmlCanvasElement",
    "CanvasRenderingContext2d",
    "Window",
    "console",
]

[profile.release]
opt-level = "s"      # ĞĞ¿Ñ‚Ğ¸Ğ¼Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ½Ğ° Ñ€Ğ¾Ğ·Ğ¼Ñ–Ñ€
lto = true           # Link-time optimization
```

---

## 51.4 Ğ’Ğ—ĞĞ„ĞœĞĞ”Ğ†Ğ¯ RUST â†” JAVASCRIPT

### 51.4.1 ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ° Ñ‚Ğ¸Ğ¿Ñ–Ğ² Ğ´Ğ°Ğ½Ğ¸Ñ…

ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ° Ğ´Ğ°Ğ½Ğ¸Ñ… Ğ¼Ñ–Ğ¶ Rust Ñ– JavaScript Ğ¼Ğ°Ñ” Ğ¾ÑĞ¾Ğ±Ğ»Ğ¸Ğ²Ğ¾ÑÑ‚Ñ–:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ¢Ğ˜ĞŸĞ˜ Ğ”ĞĞĞ˜Ğ¥: RUST â†” JAVASCRIPT                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ĞŸĞ Ğ˜ĞœĞ†Ğ¢Ğ˜Ğ’Ğ˜ (ĞºĞ¾Ğ¿Ñ–ÑÑÑ‚ÑŒÑÑ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼Ñƒ):                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ Rust             â”‚ JavaScript           â”‚                       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
â”‚  â”‚ i32, u32         â”‚ number               â”‚                       â”‚
â”‚  â”‚ i64, u64         â”‚ BigInt               â”‚                       â”‚
â”‚  â”‚ f32, f64         â”‚ number               â”‚                       â”‚
â”‚  â”‚ bool             â”‚ boolean              â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                     â”‚
â”‚  Ğ¡ĞšĞ›ĞĞ”ĞĞ† (Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ÑŒ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ñ–Ñ—):                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ &str, String     â”‚ string (UTF-8 copy)  â”‚                       â”‚
â”‚  â”‚ Vec<u8>          â”‚ Uint8Array           â”‚                       â”‚
â”‚  â”‚ Vec<T>           â”‚ Array (Ñ‡ĞµÑ€ĞµĞ· serde)  â”‚                       â”‚
â”‚  â”‚ struct           â”‚ Object (Ñ‡ĞµÑ€ĞµĞ· serde) â”‚                       â”‚
â”‚  â”‚ JsValue          â”‚ Ğ±ÑƒĞ´ÑŒ-Ñ‰Ğ¾              â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                     â”‚
â”‚  âš ï¸ ĞšĞ¾Ğ¶Ğ½Ğ° ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ñ–Ñ â€” Ñ†Ğµ ĞºĞ¾Ğ¿Ñ–ÑĞ²Ğ°Ğ½Ğ½Ñ Ğ´Ğ°Ğ½Ğ¸Ñ…!                       â”‚
â”‚     Ğ”Ğ»Ñ Ğ²ĞµĞ»Ğ¸ĞºĞ¸Ñ… ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€ Ğ²Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒĞ¹Ñ‚Ğµ references.                â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 51.4.2 Ğ•ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ñ„ÑƒĞ½ĞºÑ†Ñ–Ğ¹ Ñ‚Ğ° ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€

**ĞŸĞ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ñ–:** Ğ¡Ñ‚Ğ²Ğ¾Ñ€Ğ¸Ğ¼Ğ¾ Rust Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ, Ñ‰Ğ¾ ĞµĞºÑĞ¿Ğ¾Ñ€Ñ‚ÑƒÑ” Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ— Ñ‚Ğ° ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ Ğ´Ğ»Ñ JavaScript.

```rust
use wasm_bindgen::prelude::*;
use serde::{Serialize, Deserialize};

/// ĞŸĞ¾Ğ·Ğ¸Ñ†Ñ–Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ° â€” ĞµĞºÑĞ¿Ğ¾Ñ€Ñ‚ÑƒÑ”Ğ¼Ğ¾ ÑĞº ĞºĞ»Ğ°Ñ JavaScript
#[wasm_bindgen]
#[derive(Clone, Copy)]
pub struct Position {
    pub x: f64,
    pub y: f64,
}

#[wasm_bindgen]
impl Position {
    /// ĞšĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ â€” new Position(x, y) Ğ² JavaScript
    #[wasm_bindgen(constructor)]
    pub fn new(x: f64, y: f64) -> Position {
        Position { x, y }
    }
    
    /// ĞĞ±Ñ‡Ğ¸ÑĞ»ÑÑ” Ğ²Ñ–Ğ´ÑÑ‚Ğ°Ğ½ÑŒ Ğ´Ğ¾ Ñ–Ğ½ÑˆĞ¾Ñ— Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ñ–Ñ—
    pub fn distance_to(&self, other: &Position) -> f64 {
        let dx = self.x - other.x;
        let dy = self.y - other.y;
        (dx * dx + dy * dy).sqrt()
    }
}

/// Ğ¡ĞºĞ»Ğ°Ğ´Ğ½Ğ° ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° â€” Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ”Ğ¼Ğ¾ Ñ‡ĞµÑ€ĞµĞ· JSON/serde
#[derive(Serialize, Deserialize)]
pub struct AgentState {
    pub id: u32,
    pub position: (f64, f64),
    pub battery: u8,
    pub active: bool,
}

/// Ğ¤ÑƒĞ½ĞºÑ†Ñ–Ñ, Ñ‰Ğ¾ Ğ¿Ñ€Ğ¸Ğ¹Ğ¼Ğ°Ñ”/Ğ¿Ğ¾Ğ²ĞµÑ€Ñ‚Ğ°Ñ” ÑĞºĞ»Ğ°Ğ´Ğ½Ñ– Ğ´Ğ°Ğ½Ñ– Ñ‡ĞµÑ€ĞµĞ· serde
#[wasm_bindgen]
pub fn process_agents(agents_json: &str) -> String {
    // Ğ”ĞµÑĞµÑ€Ñ–Ğ°Ğ»Ñ–Ğ·ÑƒÑ”Ğ¼Ğ¾ Ğ· JSON
    let mut agents: Vec<AgentState> = 
        serde_json::from_str(agents_json).unwrap_or_default();
    
    // ĞĞ±Ñ€Ğ¾Ğ±Ğ»ÑÑ”Ğ¼Ğ¾ (Ğ½Ğ°Ğ¿Ñ€Ğ¸ĞºĞ»Ğ°Ğ´, Ğ·Ğ¼ĞµĞ½ÑˆÑƒÑ”Ğ¼Ğ¾ Ğ±Ğ°Ñ‚Ğ°Ñ€ĞµÑ)
    for agent in &mut agents {
        agent.battery = agent.battery.saturating_sub(1);
    }
    
    // Ğ¡ĞµÑ€Ñ–Ğ°Ğ»Ñ–Ğ·ÑƒÑ”Ğ¼Ğ¾ Ğ½Ğ°Ğ·Ğ°Ğ´
    serde_json::to_string(&agents).unwrap_or_default()
}
```

### 51.4.3 Ğ†Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ JavaScript Ñ„ÑƒĞ½ĞºÑ†Ñ–Ğ¹

**ĞŸĞ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ñ–:** Ğ’Ğ¸ĞºĞ»Ğ¸Ñ‡ĞµĞ¼Ğ¾ JavaScript Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ— Ğ· Rust ĞºĞ¾Ğ´Ñƒ.

```rust
use wasm_bindgen::prelude::*;

// Ğ†Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğ¸Ñ… Ñ„ÑƒĞ½ĞºÑ†Ñ–Ğ¹
#[wasm_bindgen]
extern "C" {
    /// JavaScript alert()
    fn alert(s: &str);
    
    /// console.log()
    #[wasm_bindgen(js_namespace = console)]
    fn log(s: &str);
    
    /// console.warn()
    #[wasm_bindgen(js_namespace = console)]
    fn warn(s: &str);
    
    /// performance.now()
    #[wasm_bindgen(js_namespace = performance)]
    fn now() -> f64;
}

/// Ğ¤ÑƒĞ½ĞºÑ†Ñ–Ñ, Ñ‰Ğ¾ Ğ²Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒÑ” Ñ–Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ²Ğ°Ğ½Ñ– JS Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ—
#[wasm_bindgen]
pub fn demo_js_calls() {
    log("Hello from Rust via console.log!");
    
    let start = now();
    // ... ÑĞºĞ¸Ğ¹ÑÑŒ ĞºĞ¾Ğ´ ...
    let elapsed = now() - start;
    
    log(&format!("Operation took {} ms", elapsed));
}
```

---

## 51.5 CANVAS â€” 2D Ğ“Ğ ĞĞ¤Ğ†ĞšĞ

### 51.5.1 ĞÑĞ½Ğ¾Ğ²Ğ¸ Canvas API

**Canvas** â€” HTML5 API Ğ´Ğ»Ñ 2D Ğ³Ñ€Ğ°Ñ„Ñ–ĞºĞ¸. ĞÑĞ½Ğ¾Ğ²Ğ½Ñ– ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ñ–Ñ—:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CANVAS COORDINATE SYSTEM                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  (0, 0) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º X                   â”‚
â”‚    â”‚                                                                â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚    â”‚     â”‚                                 â”‚                       â”‚
â”‚    â”‚     â”‚         CANVAS                  â”‚                       â”‚
â”‚    â”‚     â”‚                                 â”‚                       â”‚
â”‚    â”‚     â”‚    â—(100, 150)                 â”‚                       â”‚
â”‚    â”‚     â”‚                                 â”‚                       â”‚
â”‚    â”‚     â”‚                                 â”‚                       â”‚
â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚    â”‚                                                                â”‚
â”‚    â–¼                                                                â”‚
â”‚    Y                                                                â”‚
â”‚                                                                     â”‚
â”‚  ĞŸÑ€Ğ¸Ğ¼Ñ–Ñ‚Ğ¸Ğ²Ğ¸ Canvas:                                                 â”‚
â”‚  â€¢ fillRect(x, y, width, height) â€” Ğ·Ğ°Ñ„Ğ°Ñ€Ğ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ Ğ¿Ñ€ÑĞ¼Ğ¾ĞºÑƒÑ‚Ğ½Ğ¸Ğº        â”‚
â”‚  â€¢ strokeRect(x, y, w, h) â€” ĞºĞ¾Ğ½Ñ‚ÑƒÑ€ Ğ¿Ñ€ÑĞ¼Ğ¾ĞºÑƒÑ‚Ğ½Ğ¸ĞºĞ°                    â”‚
â”‚  â€¢ arc(x, y, radius, start, end) â€” Ğ´ÑƒĞ³Ğ°/ĞºĞ¾Ğ»Ğ¾                       â”‚
â”‚  â€¢ beginPath(), moveTo(), lineTo(), stroke() â€” Ğ»Ñ–Ğ½Ñ–Ñ—               â”‚
â”‚  â€¢ fillText(text, x, y) â€” Ñ‚ĞµĞºÑÑ‚                                    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 51.5.2 Canvas Ğ· Rust Ñ‡ĞµÑ€ĞµĞ· web-sys

**ĞŸĞ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ñ–:** Ğ¡Ñ‚Ğ²Ğ¾Ñ€Ğ¸Ğ¼Ğ¾ Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ— Ğ´Ğ»Ñ Ğ¼Ğ°Ğ»ÑĞ²Ğ°Ğ½Ğ½Ñ Ğ½Ğ° Canvas Ğ· Rust.

```rust
use wasm_bindgen::prelude::*;
use web_sys::{CanvasRenderingContext2d, HtmlCanvasElement};

/// ĞÑ‚Ñ€Ğ¸Ğ¼ÑƒÑ” Canvas ĞµĞ»ĞµĞ¼ĞµĞ½Ñ‚ Ğ·Ğ° ID
fn get_canvas(canvas_id: &str) -> Result<HtmlCanvasElement, JsValue> {
    let document = web_sys::window()
        .ok_or("no window")?
        .document()
        .ok_or("no document")?;
    
    let canvas = document
        .get_element_by_id(canvas_id)
        .ok_or("canvas not found")?
        .dyn_into::<HtmlCanvasElement>()?;
    
    Ok(canvas)
}

/// ĞÑ‚Ñ€Ğ¸Ğ¼ÑƒÑ” 2D ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ¼Ğ°Ğ»ÑĞ²Ğ°Ğ½Ğ½Ñ
fn get_context(canvas: &HtmlCanvasElement) -> Result<CanvasRenderingContext2d, JsValue> {
    canvas
        .get_context("2d")?
        .ok_or("no 2d context")?
        .dyn_into::<CanvasRenderingContext2d>()
}

/// ĞÑ‡Ğ¸Ñ‰Ğ°Ñ” Ğ²ĞµÑÑŒ canvas
#[wasm_bindgen]
pub fn clear_canvas(canvas_id: &str) -> Result<(), JsValue> {
    let canvas = get_canvas(canvas_id)?;
    let ctx = get_context(&canvas)?;
    
    let width = canvas.width() as f64;
    let height = canvas.height() as f64;
    
    ctx.clear_rect(0.0, 0.0, width, height);
    Ok(())
}

/// ĞœĞ°Ğ»ÑÑ” ĞºĞ¾Ğ»Ğ¾ (Ğ°Ğ³ĞµĞ½Ñ‚Ğ°)
#[wasm_bindgen]
pub fn draw_circle(
    canvas_id: &str,
    x: f64,
    y: f64,
    radius: f64,
    color: &str,
) -> Result<(), JsValue> {
    let canvas = get_canvas(canvas_id)?;
    let ctx = get_context(&canvas)?;
    
    ctx.begin_path();
    ctx.arc(x, y, radius, 0.0, std::f64::consts::PI * 2.0)?;
    ctx.set_fill_style(&JsValue::from_str(color));
    ctx.fill();
    
    Ok(())
}
```

### 51.5.3 ĞœĞ°Ğ»ÑĞ²Ğ°Ğ½Ğ½Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ° Ğ· Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ĞºĞ¾Ğ¼

**ĞŸĞ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ñ–:** ĞĞ°Ğ¼Ğ°Ğ»ÑÑ”Ğ¼Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ğ° ÑĞº Ñ‚Ñ€Ğ¸ĞºÑƒÑ‚Ğ½Ğ¸Ğº, Ñ‰Ğ¾ Ğ²ĞºĞ°Ğ·ÑƒÑ” Ğ½Ğ°Ğ¿Ñ€ÑĞ¼Ğ¾Ğº Ñ€ÑƒÑ…Ñƒ.

```rust
use std::f64::consts::PI;

/// ĞœĞ°Ğ»ÑÑ” Ğ°Ğ³ĞµĞ½Ñ‚Ğ° ÑĞº Ñ‚Ñ€Ğ¸ĞºÑƒÑ‚Ğ½Ğ¸Ğº Ğ· Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ĞºĞ¾Ğ¼
#[wasm_bindgen]
pub fn draw_agent(
    canvas_id: &str,
    x: f64,
    y: f64,
    heading: f64,      // ĞšÑƒÑ‚ Ğ² Ñ€Ğ°Ğ´Ñ–Ğ°Ğ½Ğ°Ñ…
    size: f64,
    color: &str,
) -> Result<(), JsValue> {
    let canvas = get_canvas(canvas_id)?;
    let ctx = get_context(&canvas)?;
    
    // Ğ—Ğ±ĞµÑ€Ñ–Ğ³Ğ°Ñ”Ğ¼Ğ¾ ÑÑ‚Ğ°Ğ½ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ñƒ
    ctx.save();
    
    // ĞŸĞµÑ€ĞµĞ¼Ñ–Ñ‰ÑƒÑ”Ğ¼Ğ¾ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ğ¸ Ğ´Ğ¾ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ñ–Ñ— Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
    ctx.translate(x, y)?;
    
    // ĞŸĞ¾Ğ²ĞµÑ€Ñ‚Ğ°Ñ”Ğ¼Ğ¾ Ğ½Ğ° ĞºÑƒÑ‚ heading
    ctx.rotate(heading)?;
    
    // ĞœĞ°Ğ»ÑÑ”Ğ¼Ğ¾ Ñ‚Ñ€Ğ¸ĞºÑƒÑ‚Ğ½Ğ¸Ğº (Ğ½Ñ–Ñ Ğ²ĞºĞ°Ğ·ÑƒÑ” Ğ²Ğ¿Ñ€Ğ°Ğ²Ğ¾)
    ctx.begin_path();
    ctx.move_to(size, 0.0);                    // ĞÑ–Ñ
    ctx.line_to(-size * 0.7, -size * 0.5);    // Ğ›Ñ–Ğ²Ğµ ĞºÑ€Ğ¸Ğ»Ğ¾
    ctx.line_to(-size * 0.7, size * 0.5);     // ĞŸÑ€Ğ°Ğ²Ğµ ĞºÑ€Ğ¸Ğ»Ğ¾
    ctx.close_path();
    
    ctx.set_fill_style(&JsValue::from_str(color));
    ctx.fill();
    
    // Ğ’Ñ–Ğ´Ğ½Ğ¾Ğ²Ğ»ÑÑ”Ğ¼Ğ¾ ÑÑ‚Ğ°Ğ½
    ctx.restore();
    
    Ok(())
}
```

**Ğ Ğ¾Ğ·Ğ³Ğ»ÑĞ½ĞµĞ¼Ğ¾ Ğ»Ğ¾Ğ³Ñ–ĞºÑƒ Ğ¼Ğ°Ğ»ÑĞ²Ğ°Ğ½Ğ½Ñ:**

1. **`ctx.save()`** â€” Ğ·Ğ±ĞµÑ€Ñ–Ğ³Ğ°Ñ” Ğ¿Ğ¾Ñ‚Ğ¾Ñ‡Ğ½Ñƒ Ñ‚Ñ€Ğ°Ğ½ÑÑ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ñ–Ñ
2. **`ctx.translate(x, y)`** â€” Ğ¿ĞµÑ€ĞµĞ½Ğ¾ÑĞ¸Ñ‚ÑŒ Ğ¿Ğ¾Ñ‡Ğ°Ñ‚Ğ¾Ğº ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚ Ğ´Ğ¾ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ñ–Ñ— Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
3. **`ctx.rotate(heading)`** â€” Ğ¿Ğ¾Ğ²ĞµÑ€Ñ‚Ğ°Ñ” ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚
4. **ĞœĞ°Ğ»ÑÑ”Ğ¼Ğ¾ Ñ‚Ñ€Ğ¸ĞºÑƒÑ‚Ğ½Ğ¸Ğº** Ğ²Ñ–Ğ´Ğ½Ğ¾ÑĞ½Ğ¾ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ñ‡Ğ°Ñ‚ĞºÑƒ
5. **`ctx.restore()`** â€” Ğ²Ñ–Ğ´Ğ½Ğ¾Ğ²Ğ»ÑÑ” Ğ¿Ğ¾Ğ¿ĞµÑ€ĞµĞ´Ğ½Ñ–Ğ¹ ÑÑ‚Ğ°Ğ½

---

## 51.6 ĞĞĞ†ĞœĞĞ¦Ğ†Ğ¯ Ğ¢Ğ GAME LOOP

### 51.6.1 requestAnimationFrame

Ğ”Ğ»Ñ Ğ¿Ğ»Ğ°Ğ²Ğ½Ğ¾Ñ— Ğ°Ğ½Ñ–Ğ¼Ğ°Ñ†Ñ–Ñ— Ğ²Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒÑ”Ğ¼Ğ¾ **requestAnimationFrame** â€” Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€ Ğ²Ğ¸ĞºĞ»Ğ¸ĞºĞ°Ñ” Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ Ğ¿ĞµÑ€ĞµĞ´ ĞºĞ¾Ğ¶Ğ½Ğ¸Ğ¼ Ğ¿ĞµÑ€ĞµĞ¼Ğ°Ğ»ÑŒĞ¾Ğ²ÑƒĞ²Ğ°Ğ½Ğ½ÑĞ¼ (Ğ·Ğ°Ğ·Ğ²Ğ¸Ñ‡Ğ°Ğ¹ 60 FPS):

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ANIMATION LOOP                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                              â”‚  â”‚
â”‚  â”‚  function gameLoop(timestamp) {                              â”‚  â”‚
â”‚  â”‚      // 1. ĞĞ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ ÑÑ‚Ğ°Ğ½ (update)                            â”‚  â”‚
â”‚  â”‚      simulation.update(deltaTime);                          â”‚  â”‚
â”‚  â”‚                                                              â”‚  â”‚
â”‚  â”‚      // 2. ĞĞ°Ğ¼Ğ°Ğ»ÑĞ²Ğ°Ñ‚Ğ¸ (render)                              â”‚  â”‚
â”‚  â”‚      simulation.render();                                    â”‚  â”‚
â”‚  â”‚                                                              â”‚  â”‚
â”‚  â”‚      // 3. Ğ—Ğ°Ğ¿Ğ»Ğ°Ğ½ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ½Ğ°ÑÑ‚ÑƒĞ¿Ğ½Ğ¸Ğ¹ ĞºĞ°Ğ´Ñ€                       â”‚  â”‚
â”‚  â”‚      requestAnimationFrame(gameLoop);                       â”‚  â”‚
â”‚  â”‚  }                                                           â”‚  â”‚
â”‚  â”‚                                                              â”‚  â”‚
â”‚  â”‚  // Ğ¡Ñ‚Ğ°Ñ€Ñ‚                                                    â”‚  â”‚
â”‚  â”‚  requestAnimationFrame(gameLoop);                           â”‚  â”‚
â”‚  â”‚                                                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  Timeline:                                                         â”‚
â”‚                                                                     â”‚
â”‚  â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â–º                  â”‚
â”‚    â”‚ Frame1 â”‚ Frame2 â”‚ Frame3 â”‚ Frame4 â”‚                           â”‚
â”‚    â”‚ 16.7ms â”‚ 16.7ms â”‚ 16.7ms â”‚ 16.7ms â”‚  (Ğ¿Ñ€Ğ¸ 60 FPS)            â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 51.6.2 Game Loop Ğ· Rust

**ĞŸĞ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ñ–:** Ğ ĞµĞ°Ğ»Ñ–Ğ·ÑƒÑ”Ğ¼Ğ¾ Ğ°Ğ½Ñ–Ğ¼Ğ°Ñ†Ñ–Ğ¹Ğ½Ğ¸Ğ¹ Ñ†Ğ¸ĞºĞ» Ğ´Ğ»Ñ ÑĞ¸Ğ¼ÑƒĞ»ÑÑ†Ñ–Ñ— Ñ€Ğ¾Ñ.

```rust
use wasm_bindgen::prelude::*;
use wasm_bindgen::JsCast;
use std::cell::RefCell;
use std::rc::Rc;

/// Ğ¡Ñ‚Ğ°Ğ½ ÑĞ¸Ğ¼ÑƒĞ»ÑÑ†Ñ–Ñ—
pub struct Simulation {
    agents: Vec<AgentState>,
    canvas_id: String,
    running: bool,
}

impl Simulation {
    pub fn new(canvas_id: &str, agent_count: usize) -> Self {
        let mut agents = Vec::with_capacity(agent_count);
        
        // Ğ†Ğ½Ñ–Ñ†Ñ–Ğ°Ğ»Ñ–Ğ·ÑƒÑ”Ğ¼Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ñ–Ğ² Ñƒ Ğ²Ğ¸Ğ¿Ğ°Ğ´ĞºĞ¾Ğ²Ğ¸Ñ… Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ñ–ÑÑ…
        for i in 0..agent_count {
            agents.push(AgentState {
                id: i as u32,
                x: js_sys::Math::random() * 800.0,
                y: js_sys::Math::random() * 600.0,
                vx: (js_sys::Math::random() - 0.5) * 4.0,
                vy: (js_sys::Math::random() - 0.5) * 4.0,
            });
        }
        
        Simulation {
            agents,
            canvas_id: canvas_id.to_string(),
            running: true,
        }
    }
    
    /// ĞĞ½Ğ¾Ğ²Ğ»ÑÑ” ÑÑ‚Ğ°Ğ½ ÑĞ¸Ğ¼ÑƒĞ»ÑÑ†Ñ–Ñ—
    pub fn update(&mut self) {
        for agent in &mut self.agents {
            // Ğ ÑƒÑ…Ğ°Ñ”Ğ¼Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
            agent.x += agent.vx;
            agent.y += agent.vy;
            
            // Ğ’Ñ–Ğ´Ğ±Ğ¸Ğ²Ğ°Ñ”Ğ¼Ğ¾ Ğ²Ñ–Ğ´ ÑÑ‚Ñ–Ğ½
            if agent.x < 0.0 || agent.x > 800.0 {
                agent.vx = -agent.vx;
            }
            if agent.y < 0.0 || agent.y > 600.0 {
                agent.vy = -agent.vy;
            }
        }
    }
    
    /// ĞœĞ°Ğ»ÑÑ” Ğ¿Ğ¾Ñ‚Ğ¾Ñ‡Ğ½Ğ¸Ğ¹ ÑÑ‚Ğ°Ğ½
    pub fn render(&self) -> Result<(), JsValue> {
        // ĞÑ‡Ğ¸Ñ‰Ğ°Ñ”Ğ¼Ğ¾ canvas
        clear_canvas(&self.canvas_id)?;
        
        // ĞœĞ°Ğ»ÑÑ”Ğ¼Ğ¾ ĞºĞ¾Ğ¶Ğ½Ğ¾Ğ³Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
        for agent in &self.agents {
            let heading = agent.vy.atan2(agent.vx);
            draw_agent(&self.canvas_id, agent.x, agent.y, heading, 10.0, "#3498db")?;
        }
        
        Ok(())
    }
}

/// Ğ¡Ñ‚Ğ°Ğ½ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
struct AgentState {
    id: u32,
    x: f64,
    y: f64,
    vx: f64,
    vy: f64,
}

/// Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°Ñ” Ğ°Ğ½Ñ–Ğ¼Ğ°Ñ†Ñ–Ğ¹Ğ½Ğ¸Ğ¹ Ñ†Ğ¸ĞºĞ»
#[wasm_bindgen]
pub fn start_simulation(canvas_id: &str, agent_count: usize) -> Result<(), JsValue> {
    // Ğ¡Ñ‚Ğ²Ğ¾Ñ€ÑÑ”Ğ¼Ğ¾ ÑĞ¸Ğ¼ÑƒĞ»ÑÑ†Ñ–Ñ Ğ² Rc<RefCell<>> Ğ´Ğ»Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ñƒ Ğ· closure
    let simulation = Rc::new(RefCell::new(Simulation::new(canvas_id, agent_count)));
    
    // Ğ¡Ñ‚Ğ²Ğ¾Ñ€ÑÑ”Ğ¼Ğ¾ closure Ğ´Ğ»Ñ animation frame
    let f = Rc::new(RefCell::new(None::<Closure<dyn FnMut()>>));
    let g = f.clone();
    
    let sim = simulation.clone();
    
    *g.borrow_mut() = Some(Closure::new(move || {
        // ĞĞ½Ğ¾Ğ²Ğ»ÑÑ”Ğ¼Ğ¾ Ñ‚Ğ° Ğ¼Ğ°Ğ»ÑÑ”Ğ¼Ğ¾
        {
            let mut sim = sim.borrow_mut();
            if sim.running {
                sim.update();
                let _ = sim.render();
            }
        }
        
        // Ğ—Ğ°Ğ¿Ğ¸Ñ‚ÑƒÑ”Ğ¼Ğ¾ Ğ½Ğ°ÑÑ‚ÑƒĞ¿Ğ½Ğ¸Ğ¹ ĞºĞ°Ğ´Ñ€
        request_animation_frame(f.borrow().as_ref().unwrap());
    }));
    
    // Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°Ñ”Ğ¼Ğ¾ Ğ¿ĞµÑ€ÑˆĞ¸Ğ¹ ĞºĞ°Ğ´Ñ€
    request_animation_frame(g.borrow().as_ref().unwrap());
    
    Ok(())
}

/// ĞĞ±Ğ³Ğ¾Ñ€Ñ‚ĞºĞ° Ğ´Ğ»Ñ requestAnimationFrame
fn request_animation_frame(f: &Closure<dyn FnMut()>) {
    web_sys::window()
        .unwrap()
        .request_animation_frame(f.as_ref().unchecked_ref())
        .unwrap();
}
```

---

## 51.7 Ğ†ĞĞ¢Ğ•Ğ ĞĞšĞ¢Ğ˜Ğ’ĞĞ†Ğ¡Ğ¢Ğ¬

### 51.7.1 ĞĞ±Ñ€Ğ¾Ğ±ĞºĞ° Ğ¿Ğ¾Ğ´Ñ–Ğ¹ Ğ¼Ğ¸ÑˆÑ–

**ĞŸĞ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ñ–:** Ğ”Ğ¾Ğ´Ğ°Ğ¼Ğ¾ Ğ¾Ğ±Ñ€Ğ¾Ğ±ĞºÑƒ ĞºĞ»Ñ–ĞºÑ–Ğ² Ğ¼Ğ¸ÑˆÑ– Ğ´Ğ»Ñ Ğ²Ğ¸Ğ±Ğ¾Ñ€Ñƒ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°.

```rust
use web_sys::{MouseEvent, HtmlCanvasElement};

/// Ğ”Ğ¾Ğ´Ğ°Ñ” Ğ¾Ğ±Ñ€Ğ¾Ğ±Ğ½Ğ¸Ğº ĞºĞ»Ñ–ĞºÑƒ Ğ½Ğ° canvas
#[wasm_bindgen]
pub fn setup_click_handler(canvas_id: &str) -> Result<(), JsValue> {
    let canvas = get_canvas(canvas_id)?;
    
    let closure = Closure::<dyn FnMut(MouseEvent)>::new(move |event: MouseEvent| {
        // ĞÑ‚Ñ€Ğ¸Ğ¼ÑƒÑ”Ğ¼Ğ¾ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ğ¸ ĞºĞ»Ñ–ĞºÑƒ Ğ²Ñ–Ğ´Ğ½Ğ¾ÑĞ½Ğ¾ canvas
        let x = event.offset_x() as f64;
        let y = event.offset_y() as f64;
        
        // Ğ›Ğ¾Ğ³ÑƒÑ”Ğ¼Ğ¾ Ğ´Ğ»Ñ Ğ´ĞµĞ±Ğ°Ğ³Ñƒ
        web_sys::console::log_1(
            &format!("Click at ({}, {})", x, y).into()
        );
        
        // Ğ¢ÑƒÑ‚ Ğ¼Ğ¾Ğ¶Ğ½Ğ° Ğ¿ĞµÑ€ĞµĞ²Ñ–Ñ€Ğ¸Ñ‚Ğ¸, Ñ‡Ğ¸ ĞºĞ»Ñ–ĞºĞ½ÑƒĞ»Ğ¸ Ğ½Ğ° Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
        // Ñ– Ğ²Ğ¸Ğ´Ñ–Ğ»Ğ¸Ñ‚Ğ¸ Ğ¹Ğ¾Ğ³Ğ¾
    });
    
    canvas.add_event_listener_with_callback(
        "click",
        closure.as_ref().unchecked_ref()
    )?;
    
    // Ğ’Ğ°Ğ¶Ğ»Ğ¸Ğ²Ğ¾: Ğ½Ğµ Ğ´Ñ€Ğ¾Ğ¿Ğ°Ñ‚Ğ¸ closure!
    closure.forget();
    
    Ok(())
}
```

### 51.7.2 ĞĞ±Ñ€Ğ¾Ğ±ĞºĞ° ĞºĞ»Ğ°Ğ²Ñ–Ğ°Ñ‚ÑƒÑ€Ğ¸

```rust
use web_sys::KeyboardEvent;

/// Ğ”Ğ¾Ğ´Ğ°Ñ” Ğ¾Ğ±Ñ€Ğ¾Ğ±Ğ½Ğ¸Ğº ĞºĞ»Ğ°Ğ²Ñ–Ğ°Ñ‚ÑƒÑ€Ğ¸
#[wasm_bindgen]
pub fn setup_keyboard_handler() -> Result<(), JsValue> {
    let window = web_sys::window().ok_or("no window")?;
    
    let closure = Closure::<dyn FnMut(KeyboardEvent)>::new(move |event: KeyboardEvent| {
        match event.key().as_str() {
            " " => {
                // ĞŸÑ€Ğ¾Ğ±Ñ–Ğ» â€” Ğ¿Ğ°ÑƒĞ·Ğ°/Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ²Ğ¶ĞµĞ½Ğ½Ñ
                web_sys::console::log_1(&"Toggle pause".into());
            }
            "r" => {
                // R â€” Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº
                web_sys::console::log_1(&"Reset".into());
            }
            _ => {}
        }
    });
    
    window.add_event_listener_with_callback(
        "keydown",
        closure.as_ref().unchecked_ref()
    )?;
    
    closure.forget();
    
    Ok(())
}
```

---

## 51.8 ĞĞŸĞ¢Ğ˜ĞœĞ†Ğ—ĞĞ¦Ğ†Ğ¯ ĞŸĞ ĞĞ”Ğ£ĞšĞ¢Ğ˜Ğ’ĞĞĞ¡Ğ¢Ğ†

### 51.8.1 ĞŸÑ€Ğ¾Ñ„Ñ–Ğ»ÑŒ Ğ·Ğ±Ñ–Ñ€ĞºĞ¸

```toml
# Cargo.toml

[profile.release]
# ĞĞ¿Ñ‚Ğ¸Ğ¼Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ½Ğ° Ñ€Ğ¾Ğ·Ğ¼Ñ–Ñ€
opt-level = "s"    # Ğ°Ğ±Ğ¾ "z" Ğ´Ğ»Ñ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ ÑÑ‚Ğ¸ÑĞ½ĞµĞ½Ğ½Ñ

# Link-time optimization
lto = true

# ĞĞ´Ğ¸Ğ½ codegen unit Ğ´Ğ»Ñ ĞºÑ€Ğ°Ñ‰Ğ¾Ñ— Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ñ–Ğ·Ğ°Ñ†Ñ–Ñ—
codegen-units = 1
```

### 51.8.2 wasm-opt

Ğ”Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ²Ğ° Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ¿Ñ–ÑĞ»Ñ Ğ·Ğ±Ñ–Ñ€ĞºĞ¸:

```bash
# Ğ’ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ binaryen
npm install -g binaryen

# ĞĞ¿Ñ‚Ğ¸Ğ¼Ñ–Ğ·Ğ°Ñ†Ñ–Ñ
wasm-opt -Os -o output.wasm input.wasm
```

### 51.8.3 Ğ¢Ğ¸Ğ¿Ğ¾Ğ²Ğ¸Ğ¹ Ñ€Ğ¾Ğ·Ğ¼Ñ–Ñ€

| ĞšĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ | Ğ Ğ¾Ğ·Ğ¼Ñ–Ñ€ .wasm |
|--------------|--------------|
| Debug | 2-5 MB |
| Release | 200-500 KB |
| Release + LTO + opt-level="s" | 50-150 KB |
| + gzip | 20-50 KB |

---

## 51.9 Ğ›ĞĞ‘ĞĞ ĞĞ¢ĞĞ ĞĞ Ğ ĞĞ‘ĞĞ¢Ğ

### ĞœĞµÑ‚Ğ° Ñ€Ğ¾Ğ±Ğ¾Ñ‚Ğ¸

Ğ¡Ñ‚Ğ²Ğ¾Ñ€Ğ¸Ñ‚Ğ¸ Ğ²ĞµĞ±-Ğ²Ñ–Ğ·ÑƒĞ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ñ€Ğ¾Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ñ–Ğ² Ğ· WebAssembly.

### Ğ—Ğ°Ğ²Ğ´Ğ°Ğ½Ğ½Ñ 1: Hello Wasm (3 Ğ±Ğ°Ğ»Ğ¸)

Ğ¡Ñ‚Ğ²Ğ¾Ñ€Ñ–Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ”ĞºÑ‚:
- Rust Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ `greet(name: &str) -> String`
- HTML ÑÑ‚Ğ¾Ñ€Ñ–Ğ½ĞºĞ°, Ñ‰Ğ¾ Ğ²Ğ¸ĞºĞ»Ğ¸ĞºĞ°Ñ” Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ
- Ğ’Ğ¸Ğ²Ñ–Ğ´ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñƒ Ğ² DOM

### Ğ—Ğ°Ğ²Ğ´Ğ°Ğ½Ğ½Ñ 2: Canvas Ğ°Ğ³ĞµĞ½Ñ‚Ğ¸ (4 Ğ±Ğ°Ğ»Ğ¸)

Ğ ĞµĞ°Ğ»Ñ–Ğ·ÑƒĞ¹Ñ‚Ğµ:
- 10 Ğ°Ğ³ĞµĞ½Ñ‚Ñ–Ğ²-ĞºÑ€ÑƒĞ³Ñ–Ğ²
- Ğ ÑƒÑ… Ñ‚Ğ° Ğ²Ñ–Ğ´Ğ±Ğ¸Ñ‚Ñ‚Ñ Ğ²Ñ–Ğ´ ÑÑ‚Ñ–Ğ½
- ĞĞ½Ñ–Ğ¼Ğ°Ñ†Ñ–Ñ Ñ‡ĞµÑ€ĞµĞ· requestAnimationFrame

### Ğ—Ğ°Ğ²Ğ´Ğ°Ğ½Ğ½Ñ 3: Ğ†Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ–ÑÑ‚ÑŒ (3 Ğ±Ğ°Ğ»Ğ¸)

Ğ”Ğ¾Ğ´Ğ°Ğ¹Ñ‚Ğµ:
- ĞšĞ»Ñ–Ğº Ğ´Ğ»Ñ Ğ´Ğ¾Ğ´Ğ°Ğ²Ğ°Ğ½Ğ½Ñ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
- ĞŸÑ€Ğ¾Ğ±Ñ–Ğ» Ğ´Ğ»Ñ Ğ¿Ğ°ÑƒĞ·Ğ¸
- Ğ’Ñ–Ğ´Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ½Ñ ĞºÑ–Ğ»ÑŒĞºĞ¾ÑÑ‚Ñ– Ğ°Ğ³ĞµĞ½Ñ‚Ñ–Ğ²

---

## 51.10 Ğ Ğ•Ğ—Ğ®ĞœĞ•

### ĞšĞ»ÑÑ‡Ğ¾Ğ²Ñ– ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ñ–Ñ—

**WebAssembly** â€” Ğ±Ñ–Ğ½Ğ°Ñ€Ğ½Ğ¸Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ´Ğ»Ñ Ğ²Ğ¸ÑĞ¾ĞºĞ¾Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ´Ñƒ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ñ–.

**wasm-bindgen** â€” Ğ¼Ñ–ÑÑ‚ Ğ¼Ñ–Ğ¶ Rust Ñ– JavaScript.

**Canvas API** â€” Ğ´Ğ»Ñ 2D Ğ²Ñ–Ğ·ÑƒĞ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ— Ñ€Ğ¾Ñ.

**requestAnimationFrame** â€” Ğ´Ğ»Ñ Ğ¿Ğ»Ğ°Ğ²Ğ½Ğ¾Ñ— Ğ°Ğ½Ñ–Ğ¼Ğ°Ñ†Ñ–Ñ— 60 FPS.

### Rust â†’ Wasm pipeline

```
1. Rust ĞºĞ¾Ğ´ + #[wasm_bindgen]
         â”‚
         â–¼
2. wasm-pack build --target web
         â”‚
         â–¼
3. pkg/ (*.wasm + *.js)
         â”‚
         â–¼
4. import init from './pkg/...'
   await init()
```

---

## ğŸ”— Ğ—Ğ’'Ğ¯Ğ—ĞĞš Ğ— ĞĞĞ¡Ğ¢Ğ£ĞŸĞĞ˜Ğœ Ğ ĞĞ—Ğ”Ğ†Ğ›ĞĞœ

Ğ’Ğ¸ Ñ‚ĞµĞ¿ĞµÑ€ Ğ¼Ğ°Ñ”Ñ‚Ğµ Ğ²ÑÑ– Ñ–Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¸:
- **ĞĞ³ĞµĞ½Ñ‚Ğ¸** â€” BDI, Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ¸ ÑÑ‚Ğ°Ğ½Ñ–Ğ²
- **ĞÑ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°** â€” ECS Ğ´Ğ»Ñ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±ÑƒĞ²Ğ°Ğ½Ğ½Ñ
- **ĞšĞ¾Ğ¼ÑƒĞ½Ñ–ĞºĞ°Ñ†Ñ–Ñ** â€” Ğ¼ĞµÑ€ĞµĞ¶ĞµĞ²Ñ– Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ¸
- **Ğ’Ñ–Ğ·ÑƒĞ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ** â€” WebAssembly Ñƒ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ñ–

Ğ§Ğ°Ñ **Ğ·Ñ–Ğ±Ñ€Ğ°Ñ‚Ğ¸ Ğ²ÑĞµ Ñ€Ğ°Ğ·Ğ¾Ğ¼** Ñƒ Ñ„Ñ–Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ Ğ¿Ñ€Ğ¾Ñ”ĞºÑ‚Ñ–.

Ğ£ **Ğ Ğ¾Ğ·Ğ´Ñ–Ğ»Ñ– 52: Ğ¤Ñ–Ğ½Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ñ”ĞºÑ‚** Ğ²Ğ¸:
- ĞĞ±'Ñ”Ğ´Ğ½Ğ°Ñ”Ñ‚Ğµ Ğ²ÑÑ– Ğ·Ğ½Ğ°Ğ½Ğ½Ñ ĞºÑƒÑ€ÑÑƒ
- ĞŸĞ¾Ğ±ÑƒĞ´ÑƒÑ”Ñ‚Ğµ Ğ¿Ğ¾Ğ²Ğ½Ğ¾Ñ†Ñ–Ğ½Ğ½Ñƒ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ñ€Ğ¾Ñ Ğ‘ĞŸĞ›Ğ
- Ğ¡Ñ‚Ğ²Ğ¾Ñ€Ğ¸Ñ‚Ğµ production-ready ĞºĞ¾Ğ´ Ğ· Ñ‚ĞµÑÑ‚Ğ°Ğ¼Ğ¸ Ñ‚Ğ° Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ñ–Ñ”Ñ

---

> **ĞĞ°ÑÑ‚ÑƒĞ¿Ğ½Ğ¸Ğ¹ Ñ€Ğ¾Ğ·Ğ´Ñ–Ğ»:** [Ğ Ğ¾Ğ·Ğ´Ñ–Ğ» 52: Ğ¤Ñ–Ğ½Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ñ”ĞºÑ‚](./52_Final_Project.md)
