# –ü—ñ–¥—Å—Ç—É–ø–Ω—ñ –∑–∞–¥–∞—á—ñ –∑ –æ–±—Ä–æ–±–∫–æ—é –ø–æ–º–∏–ª–æ–∫

---

## üìã –ê–Ω–æ—Ç–∞—Ü—ñ—è

–¶–µ–π —Ä–æ–∑–¥—ñ–ª —Ä–æ–∑–∫—Ä–∏–≤–∞—î –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ñ –∞—Å–ø–µ–∫—Ç–∏ –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫, —è–∫—ñ –º–æ–∂—É—Ç—å –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–∞–¥—ñ–π–Ω—É –ø—Ä–æ–≥—Ä–∞–º—É –Ω–∞ –∫—Ä–∏—Ö–∫—É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é, —â–æ —Ä—É–π–Ω—É—î—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–æ–º—É –≤—Ö–æ–¥—ñ. –í–∏ –¥—ñ–∑–Ω–∞—î—Ç–µ—Å—å, —á–æ–º—É `unwrap()` ‚Äî —Ü–µ –±–æ–º–±–∞ —É–ø–æ–≤—ñ–ª—å–Ω–µ–Ω–æ—ó –¥—ñ—ó, —è–∫ –≤—Ç—Ä–∞—Ç–∏—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø–æ–º–∏–ª–∫—É –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó, —Ç–∞ —á–æ–º—É –ø–∞–Ω—ñ–∫–∞ –≤ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä—ñ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø–æ–¥–≤—ñ–π–Ω–æ—ó –ø–∞–Ω—ñ–∫–∏ —ñ –∞–≤–∞—Ä—ñ–π–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –±–µ–∑ –∂–æ–¥–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –£ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —Ä–æ—é –ë–ü–õ–ê —Ü—ñ –∑–Ω–∞–Ω–Ω—è –∫—Ä–∏—Ç–∏—á–Ω—ñ: –Ω–µ–æ–±—Ä–æ–±–ª–µ–Ω–∞ –ø–æ–º–∏–ª–∫–∞ –∑–≤'—è–∑–∫—É, –ø—Ä–æ—ñ–≥–Ω–æ—Ä–æ–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–º–∞–Ω–¥–∏ –∞–±–æ –ø–∞–Ω—ñ–∫–∞ –≤ –æ–±—Ä–æ–±–Ω–∏–∫—É —Å–µ–Ω—Å–æ—Ä–∞ –º–æ–∂—É—Ç—å –º–∏—Ç—Ç—î–≤–æ –≤–∏–≤–µ—Å—Ç–∏ –¥—Ä–æ–Ω –∑ –ª–∞–¥—É –ø–æ—Å–µ—Ä–µ–¥ –º—ñ—Å—ñ—ó.

---

## üéØ –¶—ñ–ª—ñ –Ω–∞–≤—á–∞–Ω–Ω—è

–ü—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ü—å–æ–≥–æ —Ä–æ–∑–¥—ñ–ª—É –≤–∏ –∑–º–æ–∂–µ—Ç–µ:

1. **–ü–æ—è—Å–Ω–∏—Ç–∏** —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ –ø–∞–Ω—ñ–∫–∞–º–∏ —Ç–∞ –ø–æ–º–∏–ª–∫–∞–º–∏ Result
2. **–†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞—Ç–∏** –Ω–µ–±–µ–∑–ø–µ—á–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è unwrap() —Ç–∞ expect()
3. **–£–Ω–∏–∫–∞—Ç–∏** –≤—Ç—Ä–∞—Ç–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó –ø–æ–º–∏–ª–æ–∫
4. **–ü—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏** –æ–ø–µ—Ä–∞—Ç–æ—Ä ? —Ç–∞ From trait
5. **–†–æ–∑—É–º—ñ—Ç–∏** –ø—Ä–æ–±–ª–µ–º–∏ –∑ –ø–æ–º–∏–ª–∫–∞–º–∏ –≤ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞—Ö
6. **–û–±–∏—Ä–∞—Ç–∏** –º—ñ–∂ panic!, Result —Ç–∞ Option –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å–∏—Ç—É–∞—Ü—ñ–π
7. **–°—Ç–≤–æ—Ä—é–≤–∞—Ç–∏** —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏

---

## üìö –ö–ª—é—á–æ–≤—ñ —Ç–µ—Ä–º—ñ–Ω–∏

| –¢–µ—Ä–º—ñ–Ω | –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|--------|------------|
| **panic** | –ù–µ–≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞–Ω–∞ –ø–æ–º–∏–ª–∫–∞, —â–æ –∑–∞–≤–µ—Ä—à—É—î –ø–æ—Ç—ñ–∫ –∞–±–æ –ø—Ä–æ–≥—Ä–∞–º—É |
| **Result<T, E>** | –¢–∏–ø –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫: Ok(T) –∞–±–æ Err(E) |
| **Option<T>** | –¢–∏–ø –¥–ª—è –≤—ñ–¥—Å—É—Ç–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω—å: Some(T) –∞–±–æ None |
| **unwrap()** | –ú–µ—Ç–æ–¥, —â–æ –ø–æ–≤–µ—Ä—Ç–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è –∞–±–æ –ø–∞–Ω—ñ–∫—É—î |
| **? –æ–ø–µ—Ä–∞—Ç–æ—Ä** | –°–∏–Ω—Ç–∞–∫—Å–∏—á–Ω–∏–π —Ü—É–∫–æ—Ä –¥–ª—è —Ä–∞–Ω–Ω—å–æ–≥–æ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ |
| **From trait** | –¢—Ä–µ–π—Ç –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó –º—ñ–∂ —Ç–∏–ø–∞–º–∏ –ø–æ–º–∏–ª–æ–∫ |
| **anyhow/thiserror** | –ü–æ–ø—É–ª—è—Ä–Ω—ñ –∫—Ä–µ–π—Ç–∏ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –ø–æ–º–∏–ª–∫–∞–º–∏ |

---

## üí° –ú–æ—Ç–∏–≤–∞—Ü—ñ–π–Ω–∏–π –∫–µ–π—Å: –î—Ä–æ–Ω, —â–æ –≤–ø–∞–≤ —á–µ—Ä–µ–∑ unwrap()

–ö–æ–º–∞–Ω–¥–∞ —Ä–æ–∑—Ä–æ–±–ª—è–ª–∞ –∞–≤—Ç–æ–Ω–æ–º–Ω–∏–π –¥—Ä–æ–Ω –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏. –ö–æ–¥ –≤–∏–≥–ª—è–¥–∞–≤ –Ω–∞–¥—ñ–π–Ω–∏–º ‚Äî —É—Å—ñ –∫—Ä–∏—Ç–∏—á–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –ø–æ–≤–µ—Ä—Ç–∞–ª–∏ Result, –ø–æ–º–∏–ª–∫–∏ –æ–±—Ä–æ–±–ª—è–ª–∏—Å—å. –ê–ª–µ –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ –∑–∞–ª–∏—à–∏–≤—Å—è –Ω–µ–≤–∏–Ω–Ω–∏–π `unwrap()`:

```rust
fn get_battery_percentage(&self) -> u8 {
    let reading = self.battery_sensor.read().unwrap();  // "–°–µ–Ω—Å–æ—Ä –∑–∞–≤–∂–¥–∏ –ø—Ä–∞—Ü—é—î"
    (reading.voltage / self.max_voltage * 100.0) as u8
}
```

–†–æ–∑—Ä–æ–±–Ω–∏–∫–∏ –≤–≤–∞–∂–∞–ª–∏, —â–æ —Å–µ–Ω—Å–æ—Ä –±–∞—Ç–∞—Ä–µ—ó –∑–∞–≤–∂–¥–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π ‚Äî –≤—ñ–Ω –∂–µ –≤–±—É–¥–æ–≤–∞–Ω–∏–π —É –¥—Ä–æ–Ω! –ú—ñ—Å—è—Ü—ñ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–µ –≤–∏—è–≤–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º.

–ê–ª–µ –æ–¥–Ω–æ–≥–æ –¥–Ω—è, –ø—ñ–¥ —á–∞—Å –¥–æ—Å—Ç–∞–≤–∫–∏, –µ–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω—ñ—Ç–Ω–∞ –ø–µ—Ä–µ—à–∫–æ–¥–∞ –≤—ñ–¥ –ø—Ä–æ–º–∏—Å–ª–æ–≤–æ–≥–æ –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è –Ω–∞ –º–∏—Ç—å –ø–æ—Ä—É—à–∏–ª–∞ –∑–≤'—è–∑–æ–∫ –∑ —Å–µ–Ω—Å–æ—Ä–æ–º. –ú–µ—Ç–æ–¥ `read()` –ø–æ–≤–µ—Ä–Ω—É–≤ `Err`. –í–∏–∫–ª–∏–∫ `unwrap()` —Å–ø—Ä–∏—á–∏–Ω–∏–≤ –ø–∞–Ω—ñ–∫—É. –û—Å–Ω–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–∏–≤—Å—è.

–î—Ä–æ–Ω –≤—Ç—Ä–∞—Ç–∏–≤ –∫–æ–Ω—Ç—Ä–æ–ª—å —ñ –≤–ø–∞–≤. –ù–∞ —â–∞—Å—Ç—è, –Ω–µ –Ω–∞ –ª—é–¥–µ–π. –ê–ª–µ –≤–∞–Ω—Ç–∞–∂ –∑–Ω–∏—â–µ–Ω–æ, –¥—Ä–æ–Ω –ø–æ—à–∫–æ–¥–∂–µ–Ω–æ, —Ä–µ–ø—É—Ç–∞—Ü—ñ—è –∫–æ–º–ø–∞–Ω—ñ—ó –ø—ñ–¥—ñ—Ä–≤–∞–Ω–∞.

–ü—Ä–∏—á–∏–Ω–∞: –æ–¥–∏–Ω `unwrap()` —É –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ñ–π, –∑–¥–∞–≤–∞–ª–æ—Å—è –±, —Ñ—É–Ω–∫—Ü—ñ—ó. –†–æ–∑—Ä–æ–±–Ω–∏–∫–∏ –Ω–∞–≤—ñ—Ç—å –Ω–µ —É—è–≤–ª—è–ª–∏, —â–æ —Å–µ–Ω—Å–æ—Ä –º–æ–∂–µ –≤—ñ–¥–º–æ–≤–∏—Ç–∏. –ê–ª–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —Å–≤—ñ—Ç—ñ –≤—ñ–¥–º–æ–≤–ª—è—î –≤—Å–µ.

---

## –¢–ï–û–†–Ü–Ø: –î–í–ê –í–ò–î–ò –ü–û–ú–ò–õ–û–ö –£ RUST

### –í—ñ–¥–Ω–æ–≤–ª—é–≤–∞–Ω—ñ –ø–æ–º–∏–ª–∫–∏ (Result)

–ë—ñ–ª—å—à—ñ—Å—Ç—å –ø–æ–º–∏–ª–æ–∫ —É –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—ñ ‚Äî —Ü–µ —Å–∏—Ç—É–∞—Ü—ñ—ó, –∑ —è–∫–∏—Ö –º–æ–∂–Ω–∞ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏—Å—å. –§–∞–π–ª –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ ‚Äî –º–æ–∂–Ω–∞ –∑–∞–ø–∏—Ç–∞—Ç–∏ —ñ–Ω—à–∏–π —à–ª—è—Ö. –ú–µ—Ä–µ–∂–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ ‚Äî –º–æ–∂–Ω–∞ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ —Å–ø—Ä–æ–±—É. –ù–µ–≤–∞–ª—ñ–¥–Ω–∏–π –≤–≤—ñ–¥ ‚Äî –º–æ–∂–Ω–∞ –ø–æ–ø—Ä–æ—Å–∏—Ç–∏ –≤–≤–µ—Å—Ç–∏ –∑–Ω–æ–≤—É.

Rust –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —Ç–∞–∫—ñ –ø–æ–º–∏–ª–∫–∏ —á–µ—Ä–µ–∑ —Ç–∏–ø `Result<T, E>`:

```rust
enum Result<T, E> {
    Ok(T),   // –£—Å–ø—ñ—Ö, –º—ñ—Å—Ç–∏—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—É T
    Err(E),  // –ü–æ–º–∏–ª–∫–∞, –º—ñ—Å—Ç–∏—Ç—å –ø–æ–º–∏–ª–∫—É —Ç–∏–ø—É E
}
```

–§—É–Ω–∫—Ü—ñ—è, —â–æ –º–æ–∂–µ –ø—Ä–æ–≤–∞–ª–∏—Ç–∏—Å—å, –ø–æ–≤–µ—Ä—Ç–∞—î Result. –í–∏–∫–ª–∏–∫ –∑–æ–±–æ–≤'—è–∑–∞–Ω–∏–π –æ–±—Ä–æ–±–∏—Ç–∏ –æ–±–∏–¥–≤–∞ –≤–∞—Ä—ñ–∞–Ω—Ç–∏:

```rust
fn read_config(path: &str) -> Result<Config, ConfigError> {
    let content = std::fs::read_to_string(path)?;
    let config: Config = serde_json::from_str(&content)?;
    Ok(config)
}

// –í–∏–∫–ª–∏–∫
match read_config("settings.json") {
    Ok(config) => use_config(config),
    Err(e) => {
        eprintln!("–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é: {}", e);
        use_default_config()
    }
}
```

### –ù–µ–≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞–Ω—ñ –ø–æ–º–∏–ª–∫–∏ (panic)

–î–µ—è–∫—ñ —Å–∏—Ç—É–∞—Ü—ñ—ó –Ω–∞—Å—Ç—ñ–ª—å–∫–∏ —Å–µ—Ä–π–æ–∑–Ω—ñ, —â–æ –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–µ–º–æ–∂–ª–∏–≤–æ –∞–±–æ –Ω–µ–±–µ–∑–ø–µ—á–Ω–æ:
- –Ü–Ω–¥–µ–∫—Å –∑–∞ –º–µ–∂–∞–º–∏ –º–∞—Å–∏–≤—É
- –ü–æ—Ä—É—à–µ–Ω–Ω—è —ñ–Ω–≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ (internal bug)
- –ù–µ–º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–¥—ñ–ª–∏—Ç–∏ –ø–∞–º'—è—Ç—å

–î–ª—è —Ç–∞–∫–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤ Rust –º–∞—î –ø–∞–Ω—ñ–∫—É:

```rust
panic!("–ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞: –Ω–µ–º–æ–∂–ª–∏–≤–æ –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞—Ç–∏");
```

–ü–∞–Ω—ñ–∫–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ä–æ–∑–∫—Ä—É—á—É—î —Å—Ç–µ–∫ (unwinding), –≤–∏–∫–ª–∏–∫–∞—é—á–∏ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∏, —ñ –∑–∞–≤–µ—Ä—à—É—î –ø–æ—Ç—ñ–∫. –Ø–∫—â–æ –ø–∞–Ω—ñ–∫—É—î main-–ø–æ—Ç—ñ–∫ ‚Äî –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è –≤—Å—è –ø—Ä–æ–≥—Ä–∞–º–∞.

### –§—ñ–ª–æ—Å–æ—Ñ—ñ—è Rust: Result –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

Rust –∑–∞–æ—Ö–æ—á—É—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Result –¥–ª—è –≤—Å—å–æ–≥–æ, —â–æ –º–æ–∂–µ –ø—Ä–æ–≤–∞–ª–∏—Ç–∏—Å—å. –ü–∞–Ω—ñ–∫–∞ ‚Äî –¥–ª—è —Å–ø—Ä–∞–≤–¥—ñ –≤–∏–Ω—è—Ç–∫–æ–≤–∏—Ö —Å–∏—Ç—É–∞—Ü—ñ–π, —è–∫—ñ —Å–≤—ñ–¥—á–∞—Ç—å –ø—Ä–æ –±–∞–≥ —É –ø—Ä–æ–≥—Ä–∞–º—ñ, –∞ –Ω–µ –ø—Ä–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ –æ–±—Å—Ç–∞–≤–∏–Ω–∏.

–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ —ñ–Ω—à–∏–º–∏ –º–æ–≤–∞–º–∏:
- **Java/C#**: –≤–∏–∫–ª—é—á–µ–Ω–Ω—è (exceptions) –¥–ª—è –≤—Å—å–æ–≥–æ
- **Go**: –∫–æ–¥–∏ –ø–æ–º–∏–ª–æ–∫ + panic –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω–æ–≥–æ
- **C**: –∫–æ–¥–∏ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è (–ª–µ–≥–∫–æ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏!)
- **Rust**: Result + panic, –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î –æ–±—Ä–æ–±–∫—É

---

## –¢–ï–û–†–Ü–Ø: UNWRAP() ‚Äî –ë–û–ú–ë–ê –£–ü–û–í–Ü–õ–¨–ù–ï–ù–û–á –î–Ü–á

### –©–æ —Ä–æ–±–∏—Ç—å unwrap()

–ú–µ—Ç–æ–¥–∏ `unwrap()` —Ç–∞ `expect()` "—Ä–æ–∑–≥–æ—Ä—Ç–∞—é—Ç—å" Result –∞–±–æ Option:

```rust
let value: i32 = some_result.unwrap();  // –ü–∞–Ω—ñ–∫–∞ —è–∫—â–æ Err
let value: i32 = some_option.unwrap();  // –ü–∞–Ω—ñ–∫–∞ —è–∫—â–æ None
```

–Ø–∫—â–æ Result –º—ñ—Å—Ç–∏—Ç—å Ok –∞–±–æ Option –º—ñ—Å—Ç–∏—Ç—å Some ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è. –Ø–∫—â–æ Err –∞–±–æ None ‚Äî –ø—Ä–æ–≥—Ä–∞–º–∞ –ø–∞–Ω—ñ–∫—É—î.

### –ß–æ–º—É —Ü–µ –Ω–µ–±–µ–∑–ø–µ—á–Ω–æ

`unwrap()` –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞–Ω—É –ø–æ–º–∏–ª–∫—É –Ω–∞ –Ω–µ–≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞–Ω—É. –í–∏ –∫–∞–∂–µ—Ç–µ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä—É: "–Ø –∑–Ω–∞—é, —â–æ —Ç—É—Ç –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–º–∏–ª–∫–∏". –ê–ª–µ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–º–∏–ª—è—Ç–∏—Å—å.

```rust
// "–§–∞–π–ª –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∑–∞–≤–∂–¥–∏ —ñ—Å–Ω—É—î"
let config = std::fs::read_to_string("config.toml").unwrap();

// "–ú–∏ –∑–∞–≤–∂–¥–∏ –ø–µ—Ä–µ–¥–∞—î–º–æ –≤–∞–ª—ñ–¥–Ω–∏–π JSON"
let data: Value = serde_json::from_str(&input).unwrap();

// "Mutex –Ω—ñ–∫–æ–ª–∏ –Ω–µ –æ—Ç—Ä—É—î–Ω–∏–π"
let guard = mutex.lock().unwrap();
```

–ö–æ–∂–µ–Ω –∑ —Ü–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤ –º–æ–∂–µ –ø—Ä–æ–≤–∞–ª–∏—Ç–∏—Å—å:
- –§–∞–π–ª –≤–∏–¥–∞–ª–µ–Ω–æ, –ø–µ—Ä–µ–º—ñ—â–µ–Ω–æ, –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø—É
- –í–≤—ñ–¥ –ø–æ—à–∫–æ–¥–∂–µ–Ω–æ, –ø—Ä–∏–π—à–æ–≤ –∑ –Ω–µ–¥–æ–≤—ñ—Ä–µ–Ω–æ–≥–æ –¥–∂–µ—Ä–µ–ª–∞
- –Ü–Ω—à–∏–π –ø–æ—Ç—ñ–∫ –ø–∞–Ω—ñ–∫–Ω—É–≤, —Ç—Ä–∏–º–∞—é—á–∏ mutex

### –ö–æ–ª–∏ unwrap() –ø—Ä–∏–π–Ω—è—Ç–Ω–∏–π

–Ñ –æ–±–º–µ–∂–µ–Ω—ñ –≤–∏–ø–∞–¥–∫–∏, –∫–æ–ª–∏ unwrap() –≤–∏–ø—Ä–∞–≤–¥–∞–Ω–∏–π:

**–£ —Ç–µ—Å—Ç–∞—Ö**: —Ç–µ—Å—Ç –º–∞—î –ø—Ä–æ–≤–∞–ª–∏—Ç–∏—Å—å, —è–∫—â–æ —â–æ—Å—å –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫:

```rust
#[test]
fn test_parsing() {
    let result = parse("valid input").unwrap();  // OK —É —Ç–µ—Å—Ç—ñ
    assert_eq!(result, expected);
}
```

**–ö–æ–ª–∏ –ø–æ–º–∏–ª–∫–∞ —Å–ø—Ä–∞–≤–¥—ñ –Ω–µ–º–æ–∂–ª–∏–≤–∞** (—ñ —Ü–µ –¥–æ–≤–µ–¥–µ–Ω–æ –ª–æ–≥—ñ–∫–æ—é –∫–æ–¥—É):

```rust
let num: i32 = "42".parse().unwrap();  // –õ—ñ—Ç–µ—Ä–∞–ª, –∑–∞–≤–∂–¥–∏ –≤–∞–ª—ñ–¥–Ω–∏–π
let regex = Regex::new(r"^\d+$").unwrap();  // –ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–∏–π –ø–∞—Ç–µ—Ä–Ω
```

**–£ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞—Ö** (–∞–ª–µ –∑–∞–º—ñ–Ω—ñ—Ç—å –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º!):

```rust
// TODO: proper error handling
let data = fetch_data().unwrap();
```

### expect() ‚Äî –∫—Ä–∞—â–µ –∑–∞ unwrap()

–ú–µ—Ç–æ–¥ `expect()` —Ä–æ–±–∏—Ç—å —Ç–µ —Å–∞–º–µ, –∞–ª–µ –∑ –≤–ª–∞—Å–Ω–∏–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º:

```rust
let config = std::fs::read_to_string("config.toml")
    .expect("config.toml must exist in the working directory");
```

–¶–µ –¥–æ–∫—É–º–µ–Ω—Ç—É—î –≤–∞—à–µ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è. –ö–æ–ª–∏ –ø–∞–Ω—ñ–∫–∞ –≤—Å–µ –∂ —Å—Ç–∞–Ω–µ—Ç—å—Å—è, –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø–æ—è—Å–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç.

–ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:
- `unwrap()`: "called `Result::unwrap()` on an `Err` value: Os { code: 2, ... }"
- `expect()`: "config.toml must exist in the working directory: Os { code: 2, ... }"

–î—Ä—É–≥–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–Ω–∞—á–Ω–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ñ—à–µ –¥–ª—è –¥–µ–±–∞–≥—É.

---

## –¢–ï–û–†–Ü–Ø: –Ü–ì–ù–û–†–£–í–ê–ù–ù–Ø RESULT ‚Äî –¢–ò–•–ê –ö–ê–¢–ê–°–¢–†–û–§–ê

### Rust –ø–æ–ø–µ—Ä–µ–¥–∂–∞—î, –∞–ª–µ –Ω–µ –∑–∞–±–æ—Ä–æ–Ω—è—î

–Ø–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è –ø–æ–≤–µ—Ä—Ç–∞—î Result, –∞ –≤–∏ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –π–æ–≥–æ, –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –≤–∏–¥–∞—Å—Ç—å –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è:

```rust
fn save_data(data: &Data) -> Result<(), SaveError> {
    // ...
}

fn process() {
    let data = prepare_data();
    save_data(&data);  // WARNING: unused `Result` that must be used
    // –ö–æ–¥ –ø—Ä–æ–¥–æ–≤–∂—É—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏—Å—å, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ save_data –ø—Ä–æ–≤–∞–ª–∏–≤—Å—è!
}
```

–ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –ª–µ–≥–∫–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –∞–±–æ –ø—Ä–æ—ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏. –ö–æ–¥ –∫–æ–º–ø—ñ–ª—é—î—Ç—å—Å—è —ñ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è. –ê–ª–µ –ø–æ–º–∏–ª–∫–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∏—Ö–æ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è ‚Äî –¥–∞–Ω—ñ –≤—Ç—Ä–∞—á–∞—é—Ç—å—Å—è –±–µ–∑ –∂–æ–¥–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.

### –Ø–≤–Ω–µ —ñ–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—è

–Ø–∫—â–æ –≤–∏ —Å–≤—ñ–¥–æ–º–æ —Ö–æ—á–µ—Ç–µ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—â–æ —Ä—ñ–¥–∫–æ –≤–∏–ø—Ä–∞–≤–¥–∞–Ω–æ), —Ä–æ–±—ñ—Ç—å —Ü–µ —è–≤–Ω–æ:

```rust
let _ = save_data(&data);  // –Ø–≤–Ω–æ –≤—ñ–¥–∫–∏–¥–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

–ê–±–æ —â–µ –∫—Ä–∞—â–µ ‚Äî –∑–∞–ª–æ–≥—É–π—Ç–µ:

```rust
if let Err(e) = save_data(&data) {
    log::warn!("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–±–µ—Ä–µ–≥—Ç–∏ –¥–∞–Ω—ñ: {}", e);
}
```

### –ê—Ç—Ä–∏–±—É—Ç must_use

–¢–∏–ø–∏ Result —Ç–∞ Option –º–∞—é—Ç—å –∞—Ç—Ä–∏–±—É—Ç `#[must_use]`, —Ç–æ–º—É –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –ø–æ–ø–µ—Ä–µ–¥–∂–∞—î –ø—Ä–æ —ñ–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—è. –í–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ –π–æ–≥–æ –¥–æ –≤–ª–∞—Å–Ω–∏—Ö —Ç–∏–ø—ñ–≤:

```rust
#[must_use = "—Ü—è –∫–æ–º–∞–Ω–¥–∞ –º–∞—î –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–∞"]
pub struct Command {
    // ...
}
```

### –ù–µ–±–µ–∑–ø–µ–∫–∞ —É –ª–∞–Ω—Ü—é–∂–∫–∞—Ö

–û—Å–æ–±–ª–∏–≤–æ –ø—ñ–¥—Å—Ç—É–ø–Ω–æ —ñ–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—è —É –ª–∞–Ω—Ü—é–∂–∫–∞—Ö –º–µ—Ç–æ–¥—ñ–≤:

```rust
vec.iter()
    .map(|x| x.parse::<i32>())  // –ü–æ–≤–µ—Ä—Ç–∞—î Iterator<Item = Result<i32, _>>
    .for_each(|result| {
        // result ‚Äî —Ü–µ Result, –Ω–µ i32!
        // –Ø–∫—â–æ –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ result, –ø–æ–º–∏–ª–∫–∏ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
    });
```

–ö—Ä–∞—â–µ:

```rust
vec.iter()
    .map(|x| x.parse::<i32>())
    .collect::<Result<Vec<_>, _>>()?;  // –ü–æ–≤–µ—Ä—Ç–∞—î –ø–µ—Ä—à—É –ø–æ–º–∏–ª–∫—É
```

---

## –¢–ï–û–†–Ü–Ø: –û–ü–ï–†–ê–¢–û–† ? –¢–ê –ü–†–ò–•–û–í–ê–ù–Ü –ö–û–ù–í–ï–†–¢–ê–¶–Ü–á

### –Ø–∫ –ø—Ä–∞—Ü—é—î –æ–ø–µ—Ä–∞—Ç–æ—Ä ?

–û–ø–µ—Ä–∞—Ç–æ—Ä `?` ‚Äî —Ü–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω–∏–π —Ü—É–∫–æ—Ä –¥–ª—è —Ä–∞–Ω–Ω—å–æ–≥–æ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏:

```rust
fn read_file(path: &str) -> Result<String, io::Error> {
    let content = std::fs::read_to_string(path)?;
    Ok(content)
}
```

–ï–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–æ:

```rust
fn read_file(path: &str) -> Result<String, io::Error> {
    let content = match std::fs::read_to_string(path) {
        Ok(c) => c,
        Err(e) => return Err(e),
    };
    Ok(content)
}
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è —á–µ—Ä–µ–∑ From

–û–ø–µ—Ä–∞—Ç–æ—Ä `?` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç—É—î —Ç–∏–ø–∏ –ø–æ–º–∏–ª–æ–∫, —è–∫—â–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Ç—Ä–µ–π—Ç `From`:

```rust
fn read_config(path: &str) -> Result<Config, Box<dyn Error>> {
    let content = std::fs::read_to_string(path)?;  // io::Error
    let config: Config = serde_json::from_str(&content)?;  // serde_json::Error
    Ok(config)
}
```

–û–±–∏–¥–≤—ñ –ø–æ–º–∏–ª–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç—É—é—Ç—å—Å—è –≤ `Box<dyn Error>`. –ó—Ä—É—á–Ω–æ!

### –ü–∞—Å—Ç–∫–∞: –≤—Ç—Ä–∞—Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É

–ê–ª–µ —Ü—è –∑—Ä—É—á–Ω—ñ—Å—Ç—å –º–∞—î —Ü—ñ–Ω—É. –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É:

```
Error: No such file or directory (os error 2)
```

–Ø–∫–∏–π —Ñ–∞–π–ª? –£ —è–∫—ñ–π —Ñ—É–Ω–∫—Ü—ñ—ó? –í—Å—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—Ç—Ä–∞—á–µ–Ω–∞.

–ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ:

```rust
// –ü–æ–≥–∞–Ω–æ: –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—Ç—Ä–∞—á–µ–Ω–æ
fn read_user_config() -> Result<Config, Box<dyn Error>> {
    let content = std::fs::read_to_string("~/.myapp/config.toml")?;
    Ok(serde_json::from_str(&content)?)
}

// –ö—Ä–∞—â–µ: –¥–æ–¥–∞—î–º–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç
fn read_user_config() -> Result<Config, ConfigError> {
    let path = "~/.myapp/config.toml";
    let content = std::fs::read_to_string(path)
        .map_err(|e| ConfigError::ReadFailed { path: path.into(), source: e })?;
    serde_json::from_str(&content)
        .map_err(|e| ConfigError::ParseFailed { path: path.into(), source: e })
}
```

### anyhow –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É

–ö—Ä–µ–π—Ç `anyhow` —Å–ø—Ä–æ—â—É—î –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É:

```rust
use anyhow::{Context, Result};

fn read_user_config() -> Result<Config> {
    let path = "~/.myapp/config.toml";
    let content = std::fs::read_to_string(path)
        .with_context(|| format!("–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ {}", path))?;
    let config: Config = serde_json::from_str(&content)
        .with_context(|| format!("–ù–µ–≤–∞–ª—ñ–¥–Ω–∏–π JSON —É {}", path))?;
    Ok(config)
}
```

–¢–µ–ø–µ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±—É–¥–µ:

```
Error: –ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ ~/.myapp/config.toml

Caused by:
    No such file or directory (os error 2)
```

---

## –¢–ï–û–†–Ü–Ø: PANIC! VS RESULT ‚Äî –ö–û–õ–ò –©–û –í–ò–ö–û–†–ò–°–¢–û–í–£–í–ê–¢–ò

### –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ panic! –∫–æ–ª–∏:

**–ë–∞–≥ —É –ø—Ä–æ–≥—Ä–∞–º—ñ** (–ø–æ—Ä—É—à–µ–Ω–Ω—è —ñ–Ω–≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤):

```rust
fn get_element(index: usize) -> &Element {
    // –Ø–∫—â–æ index >= len, —Ü–µ –±–∞–≥ —É –Ω–∞—à–æ–º—É –∫–æ–¥—ñ, –Ω–µ –≤ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –¥–∞–Ω–∏—Ö
    assert!(index < self.elements.len(), "Index out of bounds: bug in caller");
    &self.elements[index]
}
```

**–ù–µ–º–æ–∂–ª–∏–≤–æ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏** (–∫—Ä–∏—Ç–∏—á–Ω–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è):

```rust
fn main() {
    let config = Config::load().expect("Cannot start without config");
    // –Ø–∫—â–æ –Ω–µ–º–∞—î –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, –ø—Ä–æ–≥—Ä–∞–º–∞ –Ω–µ –º–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏
}
```

**–£ —Ç–µ—Å—Ç–∞—Ö**:

```rust
#[test]
fn test_something() {
    let result = do_something().unwrap();  // –¢–µ—Å—Ç –º–∞—î –ø—Ä–æ–≤–∞–ª–∏—Ç–∏—Å—å
}
```

### –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Result –∫–æ–ª–∏:

**–ü–æ–º–∏–ª–∫–∞ –æ—á—ñ–∫—É–≤–∞–Ω–∞** (–∑–æ–≤–Ω—ñ—à–Ω—ñ–π –≤–≤—ñ–¥, I/O, –º–µ—Ä–µ–∂–∞):

```rust
fn read_user_input() -> Result<Command, ParseError> {
    // –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –≤–≤–µ—Å—Ç–∏ –Ω–µ–≤–∞–ª—ñ–¥–Ω—ñ –¥–∞–Ω—ñ ‚Äî —Ü–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
}

fn connect_to_server() -> Result<Connection, NetworkError> {
    // –ú–µ—Ä–µ–∂–∞ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ ‚Äî —Ü–µ –æ—á—ñ–∫—É–≤–∞–Ω–æ
}
```

**–í–∏–∫–ª–∏–∫ –º–æ–∂–µ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏—Å—å**:

```rust
fn try_backup_server() -> Result<Data, Error> {
    // –Ø–∫—â–æ –æ—Å–Ω–æ–≤–Ω–∏–π —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, —Å–ø—Ä–æ–±—É—î–º–æ —Ä–µ–∑–µ—Ä–≤–Ω–∏–π
}

fn fetch_with_retry(url: &str) -> Result<Response, Error> {
    for _ in 0..3 {
        match fetch(url) {
            Ok(response) => return Ok(response),
            Err(e) => log::warn!("Retry: {}", e),
        }
    }
    Err(Error::MaxRetriesExceeded)
}
```

**API –¥–ª—è —ñ–Ω—à–∏—Ö** (–±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏):

```rust
// –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –Ω–µ –ø–æ–≤–∏–Ω–Ω–∞ –ø–∞–Ω—ñ–∫—É–≤–∞—Ç–∏ ‚Äî —Ü–µ —Ä—ñ—à–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
pub fn parse(input: &str) -> Result<Ast, ParseError> {
    // ...
}
```

### –°—ñ—Ä–∞ –∑–æ–Ω–∞

–î–µ—è–∫—ñ –≤–∏–ø–∞–¥–∫–∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ñ:

```rust
// –î—ñ–ª–µ–Ω–Ω—è –Ω–∞ –Ω—É–ª—å ‚Äî –±–∞–≥ —á–∏ –æ—á—ñ–∫—É–≤–∞–Ω–∞ –ø–æ–º–∏–ª–∫–∞?
fn divide(a: i32, b: i32) -> ??? {
    // –Ø–∫—â–æ —Ü–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä ‚Äî Result (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –≤–≤–µ—Å—Ç–∏ 0)
    // –Ø–∫—â–æ —Ü–µ –≤–Ω—É—Ç—Ä—ñ—à–Ω—è —Ñ—É–Ω–∫—Ü—ñ—è –∑ —ñ–Ω–≤–∞—Ä—ñ–∞–Ω—Ç–æ–º b != 0 ‚Äî –º–æ–∂–Ω–∞ panic
}
```

–ó–∞–≥–∞–ª—å–Ω–µ –ø—Ä–∞–≤–∏–ª–æ: —è–∫—â–æ –ø–æ–º–∏–ª–∫–∞ –º–æ–∂–µ –≤–∏–Ω–∏–∫–Ω—É—Ç–∏ —á–µ—Ä–µ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ –æ–±—Å—Ç–∞–≤–∏–Ω–∏ (–≤–≤—ñ–¥, I/O, –º–µ—Ä–µ–∂–∞) ‚Äî Result. –Ø–∫—â–æ —Ü–µ –ø–æ—Ä—É—à–µ–Ω–Ω—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —ñ–Ω–≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ ‚Äî panic.

---

## –¢–ï–û–†–Ü–Ø: –ü–û–ú–ò–õ–ö–ò –í –î–ï–°–¢–†–£–ö–¢–û–†–ê–• (DROP)

### –ü—Ä–æ–±–ª–µ–º–∞: drop() –Ω–µ –º–æ–∂–µ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –ø–æ–º–∏–ª–∫—É

–¢—Ä–µ–π—Ç Drop –º–∞—î —Ñ—ñ–∫—Å–æ–≤–∞–Ω—É —Å–∏–≥–Ω–∞—Ç—É—Ä—É:

```rust
trait Drop {
    fn drop(&mut self);  // –ù–µ –ø–æ–≤–µ—Ä—Ç–∞—î Result!
}
```

–©–æ —Ä–æ–±–∏—Ç–∏, —è–∫—â–æ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –º–∞—î –≤–∏–∫–æ–Ω–∞—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—é, —â–æ –º–æ–∂–µ –ø—Ä–æ–≤–∞–ª–∏—Ç–∏—Å—å?

```rust
struct TempFile {
    path: PathBuf,
}

impl Drop for TempFile {
    fn drop(&mut self) {
        // –í–∏–¥–∞–ª–µ–Ω–Ω—è —Ñ–∞–π–ª—É –º–æ–∂–µ –ø—Ä–æ–≤–∞–ª–∏—Ç–∏—Å—å!
        std::fs::remove_file(&self.path);  // –Ü–≥–Ω–æ—Ä—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç?
    }
}
```

### –í–∞—Ä—ñ–∞–Ω—Ç–∏ –≤–∏—Ä—ñ—à–µ–Ω–Ω—è

**–Ü–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É** (–Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–µ, –∞–ª–µ –Ω–µ–±–µ–∑–ø–µ—á–Ω–µ):

```rust
impl Drop for TempFile {
    fn drop(&mut self) {
        let _ = std::fs::remove_file(&self.path);
    }
}
```

**–õ–æ–≥—É–≤–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É**:

```rust
impl Drop for TempFile {
    fn drop(&mut self) {
        if let Err(e) = std::fs::remove_file(&self.path) {
            log::error!("–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–¥–∞–ª–∏—Ç–∏ —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª {:?}: {}", self.path, e);
        }
    }
}
```

**–ù–∞–¥–∞—Ç–∏ —è–≤–Ω–∏–π –º–µ—Ç–æ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è**:

```rust
impl TempFile {
    pub fn delete(self) -> Result<(), io::Error> {
        std::fs::remove_file(&self.path)?;
        std::mem::forget(self);  // –ù–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ drop
        Ok(())
    }
}

impl Drop for TempFile {
    fn drop(&mut self) {
        // Fallback, —è–∫—â–æ delete() –Ω–µ –≤–∏–∫–ª–∏–∫–∞–Ω–æ
        let _ = std::fs::remove_file(&self.path);
    }
}
```

### –ü–∞–Ω—ñ–∫–∞ –≤ drop() ‚Äî –ø–æ–¥–≤—ñ–π–Ω–∞ –ø–∞–Ω—ñ–∫–∞

–Ø–∫—â–æ `drop()` –ø–∞–Ω—ñ–∫—É—î –ø—ñ–¥ —á–∞—Å —Ä–æ–∑–∫—Ä—É—á—É–≤–∞–Ω–Ω—è —Å—Ç–µ–∫—É –≤—ñ–¥ —ñ–Ω—à–æ—ó –ø–∞–Ω—ñ–∫–∏ ‚Äî –ø—Ä–æ–≥—Ä–∞–º–∞ –Ω–µ–≥–∞–π–Ω–æ –∞–≤–∞—Ä—ñ–π–Ω–æ –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è (abort):

```rust
impl Drop for BadDrop {
    fn drop(&mut self) {
        panic!("–ü–∞–Ω—ñ–∫–∞ –≤ drop!");
    }
}

fn main() {
    let _bad = BadDrop;
    panic!("–ü–µ—Ä—à–∞ –ø–∞–Ω—ñ–∫–∞");  // –í–∏–∫–ª–∏–∫–∞—î drop() –¥–ª—è _bad, —â–æ –ø–∞–Ω—ñ–∫—É—î –∑–Ω–æ–≤—É
    // ABORT! –ü–æ–¥–≤—ñ–π–Ω–∞ –ø–∞–Ω—ñ–∫–∞
}
```

–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: "thread panicked while panicking. aborting."

–ñ–æ–¥–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –ø—Ä–∏—á–∏–Ω—É ‚Äî –¥—É–∂–µ –≤–∞–∂–∫–æ –¥–µ–±–∞–∂–∏—Ç–∏.

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è

**–ù—ñ–∫–æ–ª–∏ –Ω–µ –ø–∞–Ω—ñ–∫—É–π—Ç–µ –≤ drop()**. –Ø–∫—â–æ –æ–ø–µ—Ä–∞—Ü—ñ—è –º–æ–∂–µ –ø—Ä–æ–≤–∞–ª–∏—Ç–∏—Å—å ‚Äî –ª–æ–≥—É–π—Ç–µ –ø–æ–º–∏–ª–∫—É –∞–±–æ —ñ–≥–Ω–æ—Ä—É–π—Ç–µ. –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–∫–∏ ‚Äî –Ω–∞–¥–∞–π—Ç–µ —è–≤–Ω–∏–π –º–µ—Ç–æ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è.

---

## –¢–ï–û–†–Ü–Ø: –í–õ–ê–°–ù–Ü –¢–ò–ü–ò –ü–û–ú–ò–õ–û–ö

### –ù–∞–≤—ñ—â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –≤–ª–∞—Å–Ω—ñ —Ç–∏–ø–∏

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `Box<dyn Error>` –∞–±–æ `String` –¥–ª—è –ø–æ–º–∏–ª–æ–∫ –∑—Ä—É—á–Ω–µ, –∞–ª–µ –º–∞—î –Ω–µ–¥–æ–ª—ñ–∫–∏:
- –ù–µ –º–æ–∂–Ω–∞ –º–∞—Ç—á–∏—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Ç–∏–ø –ø–æ–º–∏–ª–∫–∏
- –í—Ç—Ä–∞—á–∞—î—Ç—å—Å—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è (–≤—Å–µ —Å—Ç–∞—î "—è–∫–∏–π—Å—å Error")
- –ù–µ–º–æ–∂–ª–∏–≤–æ –¥–æ–¥–∞—Ç–∏ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–∞–Ω—ñ

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è enum –ø–æ–º–∏–ª–æ–∫

```rust
#[derive(Debug)]
pub enum DroneError {
    SensorFailed { sensor_id: u32, reason: String },
    BatteryLow { level: u8, required: u8 },
    NavigationError { message: String },
    CommunicationLost { last_contact: Instant },
}

impl std::fmt::Display for DroneError {
    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
        match self {
            DroneError::SensorFailed { sensor_id, reason } => {
                write!(f, "–°–µ–Ω—Å–æ—Ä {} –≤—ñ–¥–º–æ–≤–∏–≤: {}", sensor_id, reason)
            }
            DroneError::BatteryLow { level, required } => {
                write!(f, "–ù–∏–∑—å–∫–∏–π –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ—ó: {}% (–ø–æ—Ç—Ä—ñ–±–Ω–æ {}%)", level, required)
            }
            // ...
        }
    }
}

impl std::error::Error for DroneError {}
```

### thiserror ‚Äî —Å–ø—Ä–æ—â–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫

–ö—Ä–µ–π—Ç `thiserror` –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É—î boilerplate:

```rust
use thiserror::Error;

#[derive(Debug, Error)]
pub enum DroneError {
    #[error("–°–µ–Ω—Å–æ—Ä {sensor_id} –≤—ñ–¥–º–æ–≤–∏–≤: {reason}")]
    SensorFailed { sensor_id: u32, reason: String },
    
    #[error("–ù–∏–∑—å–∫–∏–π –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ—ó: {level}% (–ø–æ—Ç—Ä—ñ–±–Ω–æ {required}%)")]
    BatteryLow { level: u8, required: u8 },
    
    #[error("–ü–æ–º–∏–ª–∫–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó: {0}")]
    NavigationError(String),
    
    #[error("–í—Ç—Ä–∞—á–µ–Ω–æ –∑–≤'—è–∑–æ–∫")]
    CommunicationLost { 
        #[source]  // –¶–µ –¥–∂–µ—Ä–µ–ª–æ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è –ª–∞–Ω—Ü—é–∂–∫–∞
        source: std::io::Error 
    },
}
```

### anyhow vs thiserror

**thiserror** ‚Äî –¥–ª—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫. –°—Ç–≤–æ—Ä—é—î —Ç–∏–ø—ñ–∑–æ–≤–∞–Ω—ñ –ø–æ–º–∏–ª–∫–∏, —è–∫—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å –º–∞—Ç—á–∏—Ç–∏.

**anyhow** ‚Äî –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤. –°–ø—Ä–æ—â—É—î —Ä–æ–±–æ—Ç—É –∑ —Ä—ñ–∑–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –ø–æ–º–∏–ª–æ–∫, –¥–æ–¥–∞—î –∫–æ–Ω—Ç–µ–∫—Å—Ç.

```rust
// –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ (thiserror)
pub fn parse_command(input: &str) -> Result<Command, ParseError> {
    // ParseError ‚Äî –≤–ª–∞—Å–Ω–∏–π —Ç–∏–ø, –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –º–∞—Ç—á–∏—Ç–∏
}

// –ó–∞—Å—Ç–æ—Å—É–Ω–æ–∫ (anyhow)
fn main() -> anyhow::Result<()> {
    let config = load_config().context("–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó")?;
    let connection = connect(&config).context("–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞")?;
    // –ù–µ –≤–∞–∂–ª–∏–≤–æ, —è–∫–∏–π —Å–∞–º–µ —Ç–∏–ø –ø–æ–º–∏–ª–∫–∏ ‚Äî –≥–æ–ª–æ–≤–Ω–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç
    Ok(())
}
```

---

## –¢–ï–û–†–Ü–Ø: –õ–ê–ù–¶–Æ–ñ–ö–ò –ü–û–ú–ò–õ–û–ö –¢–ê BACKTRACE

### –ü—Ä–æ–±–ª–µ–º–∞: –¥–µ –≤–∏–Ω–∏–∫–ª–∞ –ø–æ–º–∏–ª–∫–∞?

–ö–æ–ª–∏ –ø–æ–º–∏–ª–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –∫—ñ–ª—å–∫–∞ —Ä—ñ–≤–Ω—ñ–≤ –∫–æ–¥—É, –≤–∞–∂–∫–æ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ –ø–µ—Ä–≤–∏–Ω–Ω—É –ø—Ä–∏—á–∏–Ω—É:

```
Error: –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–µ—Ä—à–∏—Ç–∏ –º—ñ—Å—ñ—é
```

–¶–µ –Ω–µ –¥–æ–ø–æ–º–∞–≥–∞—î. –©–æ —Å–∞–º–µ –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫? –î–µ?

### –õ–∞–Ω—Ü—é–∂–∫–∏ –ø–æ–º–∏–ª–æ–∫ (error chain)

–ö–æ–∂–Ω–∞ –ø–æ–º–∏–ª–∫–∞ –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ "–¥–∂–µ—Ä–µ–ª–æ" (source) ‚Äî –ø–æ–ø–µ—Ä–µ–¥–Ω—é –ø–æ–º–∏–ª–∫—É –≤ –ª–∞–Ω—Ü—é–∂–∫—É:

```rust
#[derive(Debug, Error)]
pub enum MissionError {
    #[error("–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏")]
    GpsFailed {
        #[source]
        source: GpsError,
    },
}

#[derive(Debug, Error)]  
pub enum GpsError {
    #[error("–ù–µ–º–∞—î —Å–∏–≥–Ω–∞–ª—É —Å—É–ø—É—Ç–Ω–∏–∫—ñ–≤")]
    NoSignal,
    
    #[error("–ü–æ–º–∏–ª–∫–∞ –∑–≤'—è–∑–∫—É –∑ GPS –º–æ–¥—É–ª–µ–º")]
    CommunicationError {
        #[source]
        source: std::io::Error,
    },
}
```

–¢–µ–ø–µ—Ä –≤–∏–≤–æ–¥–∏–º–æ –≤–µ—Å—å –ª–∞–Ω—Ü—é–∂–æ–∫:

```rust
fn print_error_chain(error: &dyn std::error::Error) {
    eprintln!("Error: {}", error);
    let mut source = error.source();
    while let Some(s) = source {
        eprintln!("Caused by: {}", s);
        source = s.source();
    }
}
```

–í–∏–≤—ñ–¥:
```
Error: –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–µ—Ä—à–∏—Ç–∏ –º—ñ—Å—ñ—é
Caused by: –ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏
Caused by: –ü–æ–º–∏–ª–∫–∞ –∑–≤'—è–∑–∫—É –∑ GPS –º–æ–¥—É–ª–µ–º
Caused by: Connection reset by peer (os error 104)
```

### Backtrace

Backtrace –ø–æ–∫–∞–∑—É—î —Å—Ç–µ–∫ –≤–∏–∫–ª–∏–∫—ñ–≤ —É –º–æ–º–µ–Ω—Ç —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏:

```rust
use std::backtrace::Backtrace;

#[derive(Debug)]
pub struct DetailedError {
    message: String,
    backtrace: Backtrace,
}

impl DetailedError {
    pub fn new(message: impl Into<String>) -> Self {
        Self {
            message: message.into(),
            backtrace: Backtrace::capture(),
        }
    }
}
```

anyhow –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞—Ö–æ–ø–ª—é—î backtrace (—è–∫—â–æ –≤–≤—ñ–º–∫–Ω–µ–Ω–æ —á–µ—Ä–µ–∑ `RUST_BACKTRACE=1`).

---

## –¢–ï–û–†–Ü–Ø: OPTION VS RESULT

### –ö–æ–ª–∏ Option

`Option<T>` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î "–º–æ–∂–µ –±—É—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è, –∞ –º–æ–∂–µ –Ω–µ –±—É—Ç–∏". –¶–µ –Ω–µ –ø–æ–º–∏–ª–∫–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å:

```rust
fn find_user(id: u64) -> Option<User> {
    // –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ —ñ—Å–Ω—É–≤–∞—Ç–∏, –∞ –º–æ–∂–µ –Ω—ñ ‚Äî —Ü–µ –Ω–µ –ø–æ–º–∏–ª–∫–∞
}

fn first_element<T>(slice: &[T]) -> Option<&T> {
    // –ü—É—Å—Ç–∏–π —Å–ª–∞–π—Å ‚Äî –Ω–µ –ø–æ–º–∏–ª–∫–∞, –ø—Ä–æ—Å—Ç–æ –Ω–µ–º–∞ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
}
```

### –ö–æ–ª–∏ Result

`Result<T, E>` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î "–æ–ø–µ—Ä–∞—Ü—ñ—è –º–æ–∂–µ —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç–∏—Å—å –∞–±–æ –ø—Ä–æ–≤–∞–ª–∏—Ç–∏—Å—å –∑ –ø–æ–º–∏–ª–∫–æ—é":

```rust
fn load_user(id: u64) -> Result<User, DatabaseError> {
    // –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ ‚Äî —Ü–µ –ø–æ–º–∏–ª–∫–∞ (–∑'—î–¥–Ω–∞–Ω–Ω—è, –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É...)
}

fn parse_number(s: &str) -> Result<i32, ParseIntError> {
    // –ù–µ–≤–∞–ª—ñ–¥–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç ‚Äî —Ü–µ –ø–æ–º–∏–ª–∫–∞ –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—é –ø—Ä–∏—á–∏–Ω–æ—é
}
```

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –º—ñ–∂ –Ω–∏–º–∏

**Option ‚Üí Result**:

```rust
let opt: Option<i32> = Some(42);
let res: Result<i32, &str> = opt.ok_or("Value not found");
let res: Result<i32, Error> = opt.ok_or_else(|| Error::NotFound);
```

**Result ‚Üí Option** (–≤—Ç—Ä–∞—Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –ø–æ–º–∏–ª–∫—É!):

```rust
let res: Result<i32, Error> = Ok(42);
let opt: Option<i32> = res.ok();  // –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–∫–∏–¥–∞—î—Ç—å—Å—è!
```

### –ü–∞—Å—Ç–∫–∞: ok() –≤—Ç—Ä–∞—á–∞—î –ø–æ–º–∏–ª–∫—É

```rust
fn dangerous() {
    let result = parse_config();
    let config = result.ok();  // –Ø–∫—â–æ Err ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î None, –ø–æ–º–∏–ª–∫–∞ –≤—Ç—Ä–∞—á–µ–Ω–∞!
    
    if let Some(c) = config {
        use_config(c);
    } else {
        // –ß–æ–º—É config –≤—ñ–¥—Å—É—Ç–Ω—ñ–π? –§–∞–π–ª –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ? –ù–µ–≤–∞–ª—ñ–¥–Ω–∏–π JSON?
        // –ú–∏ –Ω–µ –∑–Ω–∞—î–º–æ!
    }
}
```

---

## –ü–†–ê–ö–¢–ò–ß–ù–Ü –†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–á

### –ü—Ä–∞–≤–∏–ª–æ 1: –£–Ω–∏–∫–∞–π—Ç–µ unwrap() —É –ø—Ä–æ–¥–∞–∫—à–µ–Ω-–∫–æ–¥—ñ

```rust
// –ü–æ–≥–∞–Ω–æ
let config = load_config().unwrap();

// –î–æ–±—Ä–µ
let config = load_config().context("Loading config")?;

// –ê–±–æ
let config = match load_config() {
    Ok(c) => c,
    Err(e) => {
        log::error!("Config error: {}", e);
        Config::default()
    }
};
```

### –ü—Ä–∞–≤–∏–ª–æ 2: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ expect() –∑ –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º

```rust
// –ü–æ–≥–∞–Ω–æ
let regex = Regex::new(PATTERN).unwrap();

// –î–æ–±—Ä–µ
let regex = Regex::new(PATTERN)
    .expect("PATTERN is a valid regex ‚Äî this is a compile-time constant");
```

### –ü—Ä–∞–≤–∏–ª–æ 3: –î–æ–¥–∞–≤–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ –ø–æ–º–∏–ª–æ–∫

```rust
// –ü–æ–≥–∞–Ω–æ: –Ω–µ–∑—Ä–æ–∑—É–º—ñ–ª–æ —è–∫–∏–π —Ñ–∞–π–ª
let content = std::fs::read_to_string(path)?;

// –î–æ–±—Ä–µ: –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ
let content = std::fs::read_to_string(path)
    .with_context(|| format!("–ß–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—É {}", path.display()))?;
```

### –ü—Ä–∞–≤–∏–ª–æ 4: –ù–µ —ñ–≥–Ω–æ—Ä—É–π—Ç–µ Result

```rust
// –ü–æ–≥–∞–Ω–æ: —Ç–∏—Ö–æ —ñ–≥–Ω–æ—Ä—É—î–º–æ –ø–æ–º–∏–ª–∫—É
save_data(&data);

// –î–æ–±—Ä–µ: –ª–æ–≥—É—î–º–æ
if let Err(e) = save_data(&data) {
    log::warn!("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–±–µ—Ä–µ–≥—Ç–∏: {}", e);
}

// –ê–±–æ –ø—Ä–æ–±—Ä–∞—Å—É—î–º–æ
save_data(&data)?;
```

### –ü—Ä–∞–≤–∏–ª–æ 5: –°—Ç–≤–æ—Ä—é–π—Ç–µ –≤–ª–∞—Å–Ω—ñ —Ç–∏–ø–∏ –ø–æ–º–∏–ª–æ–∫ –¥–ª—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫

```rust
// –ü–æ–≥–∞–Ω–æ –¥–ª—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
pub fn process() -> Result<(), Box<dyn Error>> { }

// –î–æ–±—Ä–µ: –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –º–∞—Ç—á–∏—Ç–∏
pub fn process() -> Result<(), ProcessError> { }
```

### –ü—Ä–∞–≤–∏–ª–æ 6: –ù—ñ–∫–æ–ª–∏ –Ω–µ –ø–∞–Ω—ñ–∫—É–π—Ç–µ –≤ drop()

```rust
impl Drop for Resource {
    fn drop(&mut self) {
        // –ü–æ–≥–∞–Ω–æ
        // self.close().unwrap();
        
        // –î–æ–±—Ä–µ
        if let Err(e) = self.close() {
            log::error!("–ü–æ–º–∏–ª–∫–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è —Ä–µ—Å—É—Ä—Å—É: {}", e);
        }
    }
}
```

---

## –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –¥–æ —Ä–æ—é –ë–ü–õ–ê

### –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ —Å–µ–Ω—Å–æ—Ä—ñ–≤

```rust
use thiserror::Error;

#[derive(Debug, Error)]
pub enum SensorError {
    #[error("–°–µ–Ω—Å–æ—Ä {name} –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î")]
    NotResponding { name: String },
    
    #[error("–ù–µ–≤–∞–ª—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –≤—ñ–¥ —Å–µ–Ω—Å–æ—Ä–∞ {name}: {details}")]
    InvalidData { name: String, details: String },
    
    #[error("–°–µ–Ω—Å–æ—Ä {name} –≤–∏–º–∫–Ω–µ–Ω–æ")]
    Disabled { name: String },
}

pub struct BatterySensor {
    name: String,
}

impl BatterySensor {
    pub fn read(&self) -> Result<f32, SensorError> {
        // –†–µ–∞–ª—å–Ω–µ —á–∏—Ç–∞–Ω–Ω—è —Å–µ–Ω—Å–æ—Ä–∞
        let raw_value = self.read_raw().map_err(|_| SensorError::NotResponding {
            name: self.name.clone(),
        })?;
        
        // –í–∞–ª—ñ–¥–∞—Ü—ñ—è
        if raw_value < 0.0 || raw_value > 100.0 {
            return Err(SensorError::InvalidData {
                name: self.name.clone(),
                details: format!("–ó–Ω–∞—á–µ–Ω–Ω—è {} –ø–æ–∑–∞ –¥—ñ–∞–ø–∞–∑–æ–Ω–æ–º 0-100", raw_value),
            });
        }
        
        Ok(raw_value)
    }
    
    /// –ë–µ–∑–ø–µ—á–Ω–µ —á–∏—Ç–∞–Ω–Ω—è –∑ fallback
    pub fn read_or_default(&self, default: f32) -> f32 {
        match self.read() {
            Ok(value) => value,
            Err(e) => {
                log::warn!("–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è –±–∞—Ç–∞—Ä–µ—ó, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ default: {}", e);
                default
            }
        }
    }
}
```

### Graceful degradation –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö

```rust
pub struct Drone {
    primary_gps: GpsSensor,
    backup_gps: Option<GpsSensor>,
    last_known_position: Position,
}

impl Drone {
    pub fn get_position(&self) -> Position {
        // –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Å–Ω–æ–≤–Ω–∏–π GPS
        if let Ok(pos) = self.primary_gps.read() {
            return pos;
        }
        
        // –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —Ä–µ–∑–µ—Ä–≤–Ω–∏–π
        if let Some(backup) = &self.backup_gps {
            if let Ok(pos) = backup.read() {
                log::warn!("–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ä–µ–∑–µ—Ä–≤–Ω–∏–π GPS");
                return pos;
            }
        }
        
        // Fallback –¥–æ –æ—Å—Ç–∞–Ω–Ω—å–æ—ó –≤—ñ–¥–æ–º–æ—ó –ø–æ–∑–∏—Ü—ñ—ó
        log::error!("GPS –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –æ—Å—Ç–∞–Ω–Ω—é –ø–æ–∑–∏—Ü—ñ—é");
        self.last_known_position
    }
}
```

### –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫

```rust
use anyhow::{Context, Result};

pub fn execute_mission(mission: Mission) -> Result<MissionReport> {
    let drone = initialize_drone()
        .context("–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –¥—Ä–æ–Ω–∞")?;
    
    drone.arm()
        .context("–ê–∫—Ç–∏–≤–∞—Ü—ñ—è –¥–≤–∏–≥—É–Ω—ñ–≤")?;
    
    drone.takeoff(mission.start_altitude)
        .context("–ó–ª—ñ—Ç")?;
    
    for waypoint in mission.waypoints {
        drone.fly_to(waypoint)
            .with_context(|| format!("–ü–æ–ª—ñ—Ç –¥–æ {:?}", waypoint))?;
        
        if let Some(action) = waypoint.action {
            drone.execute_action(action)
                .with_context(|| format!("–í–∏–∫–æ–Ω–∞–Ω–Ω—è –¥—ñ—ó {:?}", action))?;
        }
    }
    
    drone.land()
        .context("–ü–æ—Å–∞–¥–∫–∞")?;
    
    Ok(drone.generate_report())
}

fn main() {
    match execute_mission(load_mission()) {
        Ok(report) => {
            println!("–ú—ñ—Å—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø—ñ—à–Ω–æ");
            save_report(report);
        }
        Err(e) => {
            eprintln!("–ú—ñ—Å—ñ—è –ø—Ä–æ–≤–∞–ª–µ–Ω–∞!");
            eprintln!("{:?}", e);  // –í–∏–≤–æ–¥–∏—Ç—å –≤–µ—Å—å –ª–∞–Ω—Ü—é–∂–æ–∫ –∑ backtrace
            initiate_emergency_landing();
        }
    }
}
```

---

## –†–µ–∑—é–º–µ

–£ —Ü—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ –º–∏ —Ä–æ–∑–≥–ª—è–Ω—É–ª–∏ –ø—ñ–¥—Å—Ç—É–ø–Ω—ñ –∞—Å–ø–µ–∫—Ç–∏ –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫.

**unwrap() —Ç–∞ expect()** –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—Ç—å –≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞–Ω—ñ –ø–æ–º–∏–ª–∫–∏ –Ω–∞ –ø–∞–Ω—ñ–∫–∏. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —ó—Ö –ª–∏—à–µ –∫–æ–ª–∏ –ø–æ–º–∏–ª–∫–∞ —Å–ø—Ä–∞–≤–¥—ñ –Ω–µ–º–æ–∂–ª–∏–≤–∞ –∞–±–æ –≤ —Ç–µ—Å—Ç–∞—Ö. expect() –∫—Ä–∞—â–µ –∑–∞ unwrap() ‚Äî –≤—ñ–Ω –¥–æ–∫—É–º–µ–Ω—Ç—É—î –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è.

**–Ü–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—è Result** –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Ç–∏—Ö–∏—Ö –∑–±–æ—ó–≤. Rust –ø–æ–ø–µ—Ä–µ–¥–∂–∞—î, –∞–ª–µ –¥–æ–∑–≤–æ–ª—è—î. –ó–∞–≤–∂–¥–∏ –æ–±—Ä–æ–±–ª—è–π—Ç–µ –∞–±–æ —è–≤–Ω–æ –ª–æ–≥—É–π—Ç–µ –ø–æ–º–∏–ª–∫–∏.

**–û–ø–µ—Ä–∞—Ç–æ—Ä ?** –∑—Ä—É—á–Ω–∏–π, –∞–ª–µ –º–æ–∂–µ –≤—Ç—Ä–∞—á–∞—Ç–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `with_context()` –∑ anyhow –∞–±–æ `map_err()` –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

**panic! vs Result**: panic –¥–ª—è –±–∞–≥—ñ–≤ —Ç–∞ –Ω–µ–≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞–Ω–∏—Ö —Å–∏—Ç—É–∞—Ü—ñ–π, Result –¥–ª—è –æ—á—ñ–∫—É–≤–∞–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫. –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –º–∞–π–∂–µ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø–æ–≤–∏–Ω–Ω—ñ –ø–∞–Ω—ñ–∫—É–≤–∞—Ç–∏.

**–ü–æ–º–∏–ª–∫–∏ –≤ drop()**: drop() –Ω–µ –º–æ–∂–µ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ Result. –õ–æ–≥—É–π—Ç–µ –ø–æ–º–∏–ª–∫–∏, –Ω–∞–¥–∞–π—Ç–µ —è–≤–Ω–∏–π –º–µ—Ç–æ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è. –ù—ñ–∫–æ–ª–∏ –Ω–µ –ø–∞–Ω—ñ–∫—É–π—Ç–µ –≤ drop() ‚Äî —Ü–µ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ abort.

**–í–ª–∞—Å–Ω—ñ —Ç–∏–ø–∏ –ø–æ–º–∏–ª–æ–∫**: thiserror –¥–ª—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫ (—Ç–∏–ø—ñ–∑–æ–≤–∞–Ω—ñ –ø–æ–º–∏–ª–∫–∏), anyhow –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤ (–∑—Ä—É—á–Ω—ñ—Å—Ç—å —Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç).

**–õ–∞–Ω—Ü—é–∂–∫–∏ –ø–æ–º–∏–ª–æ–∫**: –∑–±–µ—Ä—ñ–≥–∞–π—Ç–µ source –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –ª–∞–Ω—Ü—é–∂–∫–∞ –ø—Ä–∏—á–∏–Ω. –¶–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –¥–µ–±–∞–≥—É.

---

## üîó –ó–≤'—è–∑–æ–∫ –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –º–∞—Ç–µ—Ä—ñ–∞–ª–æ–º

–û–ø–∞–Ω—É–≤–∞–≤—à–∏ –ø—ñ–¥—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫, –≤–∏ –≥–æ—Ç–æ–≤—ñ –¥–æ –≤–∏–≤—á–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º—É. –¢–∞–º –≤–∞—Å —á–µ–∫–∞—é—Ç—å deadlock, –ª–æ–≥—ñ—á–Ω—ñ –≥–æ–Ω–∫–∏ (–≤—ñ–¥ —è–∫–∏—Ö Rust –Ω–µ –∑–∞—Ö–∏—â–∞—î!), —Ç–∞ –ø—ñ–¥—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥—É ‚Äî –∫–æ–ª–∏ blocking –æ–ø–µ—Ä–∞—Ü—ñ—è –≤ async –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –º–æ–∂–µ –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –≤–µ—Å—å runtime.
