# –ü—ñ–¥—Å—Ç—É–ø–Ω—ñ –∑–∞–¥–∞—á—ñ –∑ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—î—é

---

## üìã –ê–Ω–æ—Ç–∞—Ü—ñ—è

–¶–µ–π —Ä–æ–∑–¥—ñ–ª —Ä–æ–∑–∫—Ä–∏–≤–∞—î –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ñ –∞—Å–ø–µ–∫—Ç–∏ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö, —è–∫—ñ –º–æ–∂—É—Ç—å –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Ç–∏—Ö–æ—ó –≤—Ç—Ä–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, –Ω–µ—Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ –º—ñ–∂ —Å–∏—Å—Ç–µ–º–∞–º–∏ —Ç–∞ –∑–∞–≥–∞–¥–∫–æ–≤–∏—Ö –ø–æ–º–∏–ª–æ–∫ "–Ω–∞ —Ä—ñ–≤–Ω–æ–º—É –º—ñ—Å—Ü—ñ". –í–∏ –¥—ñ–∑–Ω–∞—î—Ç–µ—Å—å, —á–æ–º—É 64-–±—ñ—Ç–Ω–µ —Ü—ñ–ª–µ —á–∏—Å–ª–æ –º–æ–∂–µ "–∑—ñ–ø—Å—É–≤–∞—Ç–∏—Å—å" –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á—ñ —á–µ—Ä–µ–∑ JSON, —á–æ–º—É NaN —Ç–∞ Infinity –Ω–µ–º–æ–∂–ª–∏–≤–æ —Å–µ—Ä—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π JSON, —Ç–∞ —è–∫ –ø–æ–ª–µ, —â–æ —ñ—Å–Ω—É—î –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ, –º–æ–∂–µ –∑–Ω–∏–∫–Ω—É—Ç–∏ –ø—ñ—Å–ª—è round-trip —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó. –£ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —Ä–æ—é –ë–ü–õ–ê –∫–æ—Ä–µ–∫—Ç–Ω–∞ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∫—Ä–∏—Ç–∏—á–Ω–∞: —Ç–µ–ª–µ–º–µ—Ç—Ä—ñ—è, –∫–æ–º–∞–Ω–¥–∏, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ ‚Äî –≤—Å–µ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –º—ñ–∂ —Å–∏—Å—Ç–µ–º–∞–º–∏, —ñ –ø–æ–º–∏–ª–∫–∞ –º–æ–∂–µ –æ–∑–Ω–∞—á–∞—Ç–∏ –≤—Ç—Ä–∞—Ç—É —Ç–æ—á–Ω–æ—Å—Ç—ñ –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –∞–±–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—é –∫–æ–º–∞–Ω–¥.

---

## üéØ –¶—ñ–ª—ñ –Ω–∞–≤—á–∞–Ω–Ω—è

–ü—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ü—å–æ–≥–æ —Ä–æ–∑–¥—ñ–ª—É –≤–∏ –∑–º–æ–∂–µ—Ç–µ:

1. **–ü–æ—è—Å–Ω–∏—Ç–∏** –æ–±–º–µ–∂–µ–Ω–Ω—è JSON –¥–ª—è —á–∏—Å–ª–æ–≤–∏—Ö —Ç–∏–ø—ñ–≤
2. **–£–Ω–∏–∫–∞—Ç–∏** –≤—Ç—Ä–∞—Ç–∏ —Ç–æ—á–Ω–æ—Å—Ç—ñ –ø—Ä–∏ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –≤–µ–ª–∏–∫–∏—Ö —á–∏—Å–µ–ª
3. **–û–±—Ä–æ–±–ª—è—Ç–∏** —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è float (NaN, Infinity)
4. **–ü—Ä–∞–≤–∏–ª—å–Ω–æ —Å–µ—Ä—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏** enum-–∏ —Ç–∞ Option
5. **–†–æ–∑—É–º—ñ—Ç–∏** —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ (JSON, TOML, bincode)
6. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏** serde –∞—Ç—Ä–∏–±—É—Ç–∏ –¥–ª—è –∫–∞—Å—Ç–æ–º—ñ–∑–∞—Ü—ñ—ó
7. **–ü—Ä–æ–µ–∫—Ç—É–≤–∞—Ç–∏** —Å—Ö–µ–º–∏ –¥–∞–Ω–∏—Ö –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –≤–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è

---

## üìö –ö–ª—é—á–æ–≤—ñ —Ç–µ—Ä–º—ñ–Ω–∏

| –¢–µ—Ä–º—ñ–Ω | –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|--------|------------|
| **—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è** | –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–∞–Ω–∏—Ö —É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –±–∞–π—Ç—ñ–≤ –∞–±–æ —Ç–µ–∫—Å—Ç |
| **–¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è** | –ó–≤–æ—Ä–æ—Ç–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è ‚Äî –∑ –±–∞–π—Ç—ñ–≤/—Ç–µ–∫—Å—Ç—É —É —Å—Ç—Ä—É–∫—Ç—É—Ä—É |
| **serde** | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ Rust –¥–ª—è —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó/–¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó |
| **JSON** | JavaScript Object Notation ‚Äî —Ç–µ–∫—Å—Ç–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç –æ–±–º—ñ–Ω—É –¥–∞–Ω–∏–º–∏ |
| **round-trip** | –¶–∏–∫–ª —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è ‚Üí –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è, —ñ–¥–µ–∞–ª—å–Ω–æ –±–µ–∑ –≤—Ç—Ä–∞—Ç |
| **schema evolution** | –ó–º—ñ–Ω–∞ —Ñ–æ—Ä–º–∞—Ç—É –¥–∞–Ω–∏—Ö –∑—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ |

---

## üí° –ú–æ—Ç–∏–≤–∞—Ü—ñ–π–Ω–∏–π –∫–µ–π—Å: –ó–Ω–∏–∫–ª—ñ –º—ñ–ª—å–π–æ–Ω–∏

–§—ñ–Ω—Ç–µ—Ö-—Å—Ç–∞—Ä—Ç–∞–ø —Ä–æ–∑—Ä–æ–±–ª—è–≤ —Å–∏—Å—Ç–µ–º—É –æ–±—Ä–æ–±–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π. Backend –Ω–∞ Rust –æ–±–º—ñ–Ω—é–≤–∞–≤—Å—è –¥–∞–Ω–∏–º–∏ –∑ frontend –Ω–∞ JavaScript —á–µ—Ä–µ–∑ JSON API. –í—Å–µ –ø—Ä–∞—Ü—é–≤–∞–ª–æ —ñ–¥–µ–∞–ª—å–Ω–æ ‚Äî –¥–æ–∫–∏ —Å—É–º–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –Ω–µ –ø–µ—Ä–µ–≤–∏—â–∏–ª–∞ –ø–µ–≤–Ω–∏–π –ø–æ—Ä—ñ–≥.

–ö–ª—ñ—î–Ω—Ç –≤—ñ–¥–ø—Ä–∞–≤–∏–≤ –ø–µ—Ä–µ–∫–∞–∑ –Ω–∞ 9,007,199,254,740,993 —Ü–µ–Ω—Ç—ñ–≤ (–ø—Ä–∏–±–ª–∏–∑–Ω–æ 90 —Ç—Ä–∏–ª—å–π–æ–Ω—ñ–≤ –¥–æ–ª–∞—Ä—ñ–≤ ‚Äî —Ç–µ—Å—Ç–æ–≤–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è —É sandbox-—Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ). Backend –æ—Ç—Ä–∏–º–∞–≤ —ñ –æ–±—Ä–æ–±–∏–≤ –∑–∞–ø–∏—Ç. –ê–ª–µ –∫–æ–ª–∏ –∫–ª—ñ—î–Ω—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∏–≤ —Å—Ç–∞—Ç—É—Å, —Å—É–º–∞ –±—É–ª–∞ 9,007,199,254,740,992 ‚Äî –Ω–∞ –æ–¥–∏–Ω —Ü–µ–Ω—Ç –º–µ–Ω—à–µ!

–ü—Ä–∏—á–∏–Ω–∞: JavaScript Number ‚Äî —Ü–µ 64-–±—ñ—Ç–Ω–∏–π float (IEEE 754 double). –í—ñ–Ω –º–æ–∂–µ —Ç–æ—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ —Ü—ñ–ª—ñ —á–∏—Å–ª–∞ –ª–∏—à–µ –¥–æ 2^53 - 1 = 9,007,199,254,740,991. –ß–∏—Å–ª–æ 9,007,199,254,740,993 –æ–∫—Ä—É–≥–ª—è—î—Ç—å—Å—è –¥–æ –Ω–∞–π–±–ª–∏–∂—á–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è.

```javascript
// JavaScript
console.log(9007199254740993);  // 9007199254740992
console.log(9007199254740993 === 9007199254740992);  // true!
```

JSON —É—Å–ø–∞–¥–∫—É–≤–∞–≤ —Ü–µ –æ–±–º–µ–∂–µ–Ω–Ω—è, –±–æ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –Ω–µ –≤–∏–∑–Ω–∞—á–∞—î —Ç–æ—á–Ω—ñ—Å—Ç—å —á–∏—Å–µ–ª. Rust-—Å–µ—Ä–≤–µ—Ä –≤—ñ–¥–ø—Ä–∞–≤–ª—è–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–µ —á–∏—Å–ª–æ, –∞–ª–µ JavaScript-–∫–ª—ñ—î–Ω—Ç (—ñ –±–∞–≥–∞—Ç–æ JSON-–ø–∞—Ä—Å–µ—Ä—ñ–≤) —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–≤–∞–≤ –π–æ–≥–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

–†—ñ—à–µ–Ω–Ω—è: —Å–µ—Ä—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤–µ–ª–∏–∫—ñ —á–∏—Å–ª–∞ —è–∫ —Ä—è–¥–∫–∏:

```json
{
  "amount": "9007199254740993",
  "currency": "cents"
}
```

–¶–µ–π —ñ–Ω—Ü–∏–¥–µ–Ω—Ç –Ω–µ –ø—Ä–∏–∑–≤—ñ–≤ –¥–æ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –≤—Ç—Ä–∞—Ç (—Ç–µ—Å—Ç–æ–≤–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ), –∞–ª–µ –≤–∏—è–≤–∏–≤ –∫—Ä–∏—Ç–∏—á–Ω—É –ø—Ä–æ–±–ª–µ–º—É: –¥–∞–Ω—ñ, —â–æ –∑–¥–∞—é—Ç—å—Å—è –∫–æ—Ä–µ–∫—Ç–Ω–∏–º–∏ –Ω–∞ –æ–¥–Ω—ñ–π —Å—Ç–æ—Ä–æ–Ω—ñ, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø–æ—à–∫–æ–¥–∂–µ–Ω–∏–º–∏ –Ω–∞ —ñ–Ω—à—ñ–π.

---

## –¢–ï–û–†–Ü–Ø: JSON –Ü –ß–ò–°–õ–ê ‚Äî –ù–ï–ë–ï–ó–ü–ï–ß–ù–ò–ô –°–û–Æ–ó

### –ü—Ä–æ–±–ª–µ–º–∞: JSON –Ω–µ –≤–∏–∑–Ω–∞—á–∞—î —Ç–æ—á–Ω—ñ—Å—Ç—å

–°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è JSON (RFC 8259) –≥–æ–≤–æ—Ä–∏—Ç—å –ø—Ä–æ —á–∏—Å–ª–∞:

> "This specification allows implementations to set limits on the range and precision of numbers accepted."

–¢–æ–±—Ç–æ –∫–æ–∂–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–æ–∂–µ –º–∞—Ç–∏ –≤–ª–∞—Å–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è. –ù–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ –±—ñ–ª—å—à—ñ—Å—Ç—å –ø–∞—Ä—Å–µ—Ä—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å IEEE 754 double (64-–±—ñ—Ç–Ω–∏–π float), —â–æ –¥–∞—î:

- **–ë–µ–∑–ø–µ—á–Ω–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω —Ü—ñ–ª–∏—Ö**: -(2^53 - 1) –¥–æ (2^53 - 1), —Ç–æ–±—Ç–æ ¬±9,007,199,254,740,991
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è**: –ø—Ä–∏–±–ª–∏–∑–Ω–æ ¬±1.8 √ó 10^308
- **–¢–æ—á–Ω—ñ—Å—Ç—å**: –ø—Ä–∏–±–ª–∏–∑–Ω–æ 15-17 –∑–Ω–∞—á—É—â–∏—Ö –¥–µ—Å—è—Ç–∫–æ–≤–∏—Ö —Ü–∏—Ñ—Ä

### –©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∑ i64 —Ç–∞ u64

Rust —Ç–∏–ø–∏ `i64` —Ç–∞ `u64` –º–∞—é—Ç—å –∑–Ω–∞—á–Ω–æ –±—ñ–ª—å—à–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω:

- **i64**: -9,223,372,036,854,775,808 –¥–æ 9,223,372,036,854,775,807
- **u64**: 0 –¥–æ 18,446,744,073,709,551,615

–ö–æ–ª–∏ –≤–∏ —Å–µ—Ä—ñ–∞–ª—ñ–∑—É—î—Ç–µ `u64::MAX` —É JSON —ñ JavaScript –π–æ–≥–æ —á–∏—Ç–∞—î:

```rust
use serde::{Serialize, Deserialize};

#[derive(Serialize, Deserialize)]
struct Data {
    id: u64,
}

let data = Data { id: u64::MAX };  // 18446744073709551615
let json = serde_json::to_string(&data).unwrap();
// json = {"id":18446744073709551615}
```

```javascript
// JavaScript
const data = JSON.parse('{"id":18446744073709551615}');
console.log(data.id);  // 18446744073709552000 ‚Äî –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!
```

–û—Å—Ç–∞–Ω–Ω—ñ —Ü–∏—Ñ—Ä–∏ –≤—Ç—Ä–∞—á–µ–Ω–æ. JavaScript "–±–∞—á–∏—Ç—å" —ñ–Ω—à–µ —á–∏—Å–ª–æ.

### –ö–æ–ª–∏ —Ü–µ –Ω–µ–±–µ–∑–ø–µ—á–Ω–æ

**–Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏**: UUID, snowflake IDs, database primary keys —á–∞—Å—Ç–æ —î –≤–µ–ª–∏–∫–∏–º–∏ —á–∏—Å–ª–∞–º–∏.

```rust
struct User {
    id: u64,  // Snowflake ID –º–æ–∂–µ –±—É—Ç–∏ > 2^53
}
```

**–§—ñ–Ω–∞–Ω—Å–æ–≤—ñ —Å—É–º–∏**: –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ –Ω–∞–π–º–µ–Ω—à–∏–º–∏ –æ–¥–∏–Ω–∏—Ü—è–º–∏ (—Ü–µ–Ω—Ç–∏, –∫–æ–ø—ñ–π–∫–∏).

**Timestamp —É –º—ñ–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∞—Ö**: Unix timestamp —É –º—ñ–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∞—Ö –≤–∂–µ –ø–µ—Ä–µ–≤–∏—â—É—î –±–µ–∑–ø–µ—á–Ω–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω.

```rust
let micros = std::time::SystemTime::now()
    .duration_since(std::time::UNIX_EPOCH)
    .unwrap()
    .as_micros() as u64;
// micros ‚âà 1,705,000,000,000,000 ‚Äî –ø–æ–∫–∏ –±–µ–∑–ø–µ—á–Ω–æ, –∞–ª–µ —Ä–æ—Å—Ç–µ
```

### –†—ñ—à–µ–Ω–Ω—è: —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —è–∫ —Ä—è–¥–æ–∫

```rust
use serde::{Serialize, Deserialize};
use serde_with::{serde_as, DisplayFromStr};

#[serde_as]
#[derive(Serialize, Deserialize)]
struct Data {
    #[serde_as(as = "DisplayFromStr")]
    id: u64,
}

// –ê–±–æ –≤—Ä—É—á–Ω—É
#[derive(Serialize, Deserialize)]
struct DataManual {
    #[serde(with = "string_u64")]
    id: u64,
}

mod string_u64 {
    use serde::{self, Deserialize, Deserializer, Serializer};
    
    pub fn serialize<S>(value: &u64, serializer: S) -> Result<S::Ok, S::Error>
    where
        S: Serializer,
    {
        serializer.serialize_str(&value.to_string())
    }
    
    pub fn deserialize<'de, D>(deserializer: D) -> Result<u64, D::Error>
    where
        D: Deserializer<'de>,
    {
        let s = String::deserialize(deserializer)?;
        s.parse().map_err(serde::de::Error::custom)
    }
}
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: `{"id":"18446744073709551615"}` ‚Äî —Ä—è–¥–æ–∫, –Ω–µ —á–∏—Å–ª–æ.

### –†—ñ—à–µ–Ω–Ω—è: –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è i128/u128

–Ø–∫—â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–∞ –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ —ñ JSON –Ω–µ –ø–æ–∫–∏–¥–∞—î Rust-–µ–∫–æ—Å–∏—Å—Ç–µ–º—É:

```rust
#[derive(Serialize, Deserialize)]
struct HighPrecision {
    #[serde(with = "string_u128")]
    value: u128,
}
```

–ê–ª–µ –ø–∞–º'—è—Ç–∞–π—Ç–µ: serde_json –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î u128/i128 —è–∫ —á–∏—Å–ª–∞ JSON.

---

## –¢–ï–û–†–Ü–Ø: NAN –¢–ê INFINITY ‚Äî –ó–ê–ë–û–†–û–ù–ï–ù–Ü –ó–ù–ê–ß–ï–ù–ù–Ø

### JSON –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ float –∑–Ω–∞—á–µ–Ω–Ω—è

IEEE 754 float –º–∞—î —Ç—Ä–∏ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:
- **NaN** (Not a Number): —Ä–µ–∑—É–ª—å—Ç–∞—Ç 0.0/0.0, sqrt(-1)
- **Infinity**: —Ä–µ–∑—É–ª—å—Ç–∞—Ç 1.0/0.0
- **-Infinity**: —Ä–µ–∑—É–ª—å—Ç–∞—Ç -1.0/0.0

JSON –Ω–µ –º–∞—î —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É –¥–ª—è —Ü–∏—Ö –∑–Ω–∞—á–µ–Ω—å. –°–ø—Ä–æ–±–∞ —Å–µ—Ä—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —ó—Ö –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø–æ–º–∏–ª–∫–∏:

```rust
use serde_json;

let data = f64::NAN;
let result = serde_json::to_string(&data);
// result = Err(Error("NaN is not a valid JSON value"))

let data = f64::INFINITY;
let result = serde_json::to_string(&data);
// result = Err(Error("Infinity is not a valid JSON value"))
```

### –ö–æ–ª–∏ —Ü–µ —Å—Ç–∞—î –ø—Ä–æ–±–ª–µ–º–æ—é

**–û–±—á–∏—Å–ª–µ–Ω–Ω—è –∑ –Ω–µ–≤–∞–ª—ñ–¥–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏**:

```rust
#[derive(Serialize)]
struct SensorReading {
    temperature: f64,
    pressure: f64,
}

fn calculate_derived(temp: f64, pressure: f64) -> f64 {
    if pressure == 0.0 {
        return f64::INFINITY;  // –ê–±–æ NAN
    }
    temp / pressure
}

let reading = SensorReading {
    temperature: 25.0,
    pressure: calculate_derived(100.0, 0.0),  // Infinity!
};

serde_json::to_string(&reading).unwrap();  // –ü–ê–ù–Ü–ö–ê!
```

**–°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è**:

```rust
fn average(values: &[f64]) -> f64 {
    if values.is_empty() {
        return f64::NAN;  // –°–µ—Ä–µ–¥–Ω—î –ø—É—Å—Ç–æ—ó –º–Ω–æ–∂–∏–Ω–∏ ‚Äî –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–µ
    }
    values.iter().sum::<f64>() / values.len() as f64
}
```

### –†—ñ—à–µ–Ω–Ω—è 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—î—é

```rust
fn safe_serialize<T: Serialize>(value: &T) -> Result<String, Error> {
    // –°–ø–æ—á–∞—Ç–∫—É —Å–µ—Ä—ñ–∞–ª—ñ–∑—É—î–º–æ –≤ Value –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
    let json_value = serde_json::to_value(value)?;
    check_for_special_floats(&json_value)?;
    serde_json::to_string(&json_value)
}

fn check_for_special_floats(value: &serde_json::Value) -> Result<(), Error> {
    match value {
        serde_json::Value::Number(n) => {
            if let Some(f) = n.as_f64() {
                if f.is_nan() || f.is_infinite() {
                    return Err(Error::SpecialFloat);
                }
            }
            Ok(())
        }
        serde_json::Value::Array(arr) => {
            for item in arr {
                check_for_special_floats(item)?;
            }
            Ok(())
        }
        serde_json::Value::Object(obj) => {
            for (_, v) in obj {
                check_for_special_floats(v)?;
            }
            Ok(())
        }
        _ => Ok(()),
    }
}
```

### –†—ñ—à–µ–Ω–Ω—è 2: –ö–∞—Å—Ç–æ–º–Ω–∞ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∑ –∑–∞–º—ñ–Ω–æ—é

```rust
use serde::{Serialize, Serializer};

fn serialize_safe_f64<S>(value: &f64, serializer: S) -> Result<S::Ok, S::Error>
where
    S: Serializer,
{
    if value.is_nan() {
        serializer.serialize_none()  // null –∑–∞–º—ñ—Å—Ç—å NaN
    } else if value.is_infinite() {
        if *value > 0.0 {
            serializer.serialize_f64(f64::MAX)
        } else {
            serializer.serialize_f64(f64::MIN)
        }
    } else {
        serializer.serialize_f64(*value)
    }
}

#[derive(Serialize)]
struct Reading {
    #[serde(serialize_with = "serialize_safe_f64")]
    value: f64,
}
```

### –†—ñ—à–µ–Ω–Ω—è 3: –û–±–≥–æ—Ä—Ç–∫–∞ Option

```rust
#[derive(Serialize, Deserialize)]
struct Reading {
    value: Option<f64>,  // None —è–∫—â–æ NaN –∞–±–æ –Ω–µ–≤–∞–ª—ñ–¥–Ω–µ
}

impl Reading {
    fn new(v: f64) -> Self {
        Self {
            value: if v.is_finite() { Some(v) } else { None }
        }
    }
}
```

### –†—ñ—à–µ–Ω–Ω—è 4: –ë—ñ–Ω–∞—Ä–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏

–§–æ—Ä–º–∞—Ç–∏ —è–∫ bincode, MessagePack, CBOR –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ float –∑–Ω–∞—á–µ–Ω–Ω—è:

```rust
use bincode;

let data = f64::NAN;
let bytes = bincode::serialize(&data).unwrap();  // OK!
let restored: f64 = bincode::deserialize(&bytes).unwrap();
assert!(restored.is_nan());
```

---

## –¢–ï–û–†–Ü–Ø: ENUM –°–ï–†–Ü–ê–õ–Ü–ó–ê–¶–Ü–Ø ‚Äî –ù–ï–°–ü–û–î–Ü–í–ê–ù–Ü –§–û–†–ú–ê–¢–ò

### –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: externally tagged

```rust
#[derive(Serialize, Deserialize)]
enum Status {
    Active,
    Inactive,
    Pending { since: String },
}

let status = Status::Pending { since: "2024-01-01".into() };
let json = serde_json::to_string(&status).unwrap();
// {"Pending":{"since":"2024-01-01"}}
```

–§–æ—Ä–º–∞—Ç: –æ–±'—î–∫—Ç –∑ –æ–¥–Ω–∏–º –ø–æ–ª–µ–º, –¥–µ –∫–ª—é—á ‚Äî –Ω–∞–∑–≤–∞ –≤–∞—Ä—ñ–∞–Ω—Ç—É.

### –ü—Ä–æ–±–ª–µ–º–∞: –Ω–µ—Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ —ñ–Ω—à–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

–ë–∞–≥–∞—Ç–æ API –æ—á—ñ–∫—É—é—Ç—å —ñ–Ω—à–∏–π —Ñ–æ—Ä–º–∞—Ç:

```json
// –©–æ –æ—á—ñ–∫—É—î API
{ "status": "pending", "since": "2024-01-01" }

// –©–æ –≥–µ–Ω–µ—Ä—É—î serde –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
{ "Pending": { "since": "2024-01-01" } }
```

### –í–∞—Ä—ñ–∞–Ω—Ç–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è enum

**Internally tagged**:
```rust
#[derive(Serialize, Deserialize)]
#[serde(tag = "type")]
enum Event {
    Click { x: i32, y: i32 },
    KeyPress { key: String },
}

// {"type":"Click","x":10,"y":20}
```

**Adjacently tagged**:
```rust
#[derive(Serialize, Deserialize)]
#[serde(tag = "type", content = "data")]
enum Event {
    Click { x: i32, y: i32 },
    KeyPress { key: String },
}

// {"type":"Click","data":{"x":10,"y":20}}
```

**Untagged**:
```rust
#[derive(Serialize, Deserialize)]
#[serde(untagged)]
enum StringOrInt {
    String(String),
    Int(i32),
}

// "hello" –∞–±–æ 42
```

### –ü–∞—Å—Ç–∫–∞: untagged enum —ñ –ø–æ—Ä—è–¥–æ–∫ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤

```rust
#[derive(Serialize, Deserialize)]
#[serde(untagged)]
enum Value {
    Int(i32),
    Float(f64),  // Float –∑–∞–≤–∂–¥–∏ –º–∞—Ç—á–∏—Ç—å—Å—è!
}

let json = "42";
let v: Value = serde_json::from_str(json).unwrap();
// v = Float(42.0), –Ω–µ Int(42)!
```

–ü—Ä–∏ –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó untagged enum serde –ø—Ä–æ–±—É—î –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É. `f64` –º–æ–∂–µ –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –±—É–¥—å-—è–∫–µ —á–∏—Å–ª–æ JSON, —Ç–æ–º—É `Int` –Ω—ñ–∫–æ–ª–∏ –Ω–µ —Å–ø—Ä–∞—Ü—é—î.

–†—ñ—à–µ–Ω–Ω—è: –∑–º—ñ–Ω—ñ—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ tagged enum.

---

## –¢–ï–û–†–Ü–Ø: OPTION –Ü NULL ‚Äî –¢–û–ù–ö–û–©–Ü

### None —Å–µ—Ä—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è —è–∫ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø–æ–ª—è

```rust
#[derive(Serialize)]
struct User {
    name: String,
    email: Option<String>,
}

let user = User {
    name: "Alice".into(),
    email: None,
};
let json = serde_json::to_string(&user).unwrap();
// {"name":"Alice"}  ‚Äî –ø–æ–ª–µ email –í–Ü–î–°–£–¢–ù–Ñ
```

### –©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ null, –ø–æ—Ç—Ä—ñ–±–µ–Ω –∞—Ç—Ä–∏–±—É—Ç

```rust
#[derive(Serialize)]
struct User {
    name: String,
    #[serde(skip_serializing_if = "Option::is_none")]
    email: Option<String>,  // –í—ñ–¥—Å—É—Ç–Ω—î —è–∫—â–æ None
}

// –ê–±–æ –¥–ª—è —è–≤–Ω–æ–≥–æ null:
#[derive(Serialize)]
struct UserWithNull {
    name: String,
    email: Option<String>,  // –ë–µ–∑ skip ‚Äî –±—É–¥–µ null
}
// {"name":"Alice","email":null}
```

### –ü–∞—Å—Ç–∫–∞: –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –≤—ñ–¥—Å—É—Ç–Ω—å–æ–≥–æ –ø–æ–ª—è

```rust
#[derive(Deserialize)]
struct Config {
    timeout: Option<u32>,
}

// –¶–µ –ø—Ä–∞—Ü—é—î:
let c: Config = serde_json::from_str(r#"{"timeout": null}"#).unwrap();
// c.timeout = None

// –Ü —Ü–µ –ø—Ä–∞—Ü—é—î:
let c: Config = serde_json::from_str(r#"{}"#).unwrap();
// c.timeout = None
```

–ê–ª–µ —è–∫—â–æ –ø–æ–ª–µ –ù–ï Option:

```rust
#[derive(Deserialize)]
struct Config {
    timeout: u32,
}

let c: Config = serde_json::from_str(r#"{}"#).unwrap();
// –ü–û–ú–ò–õ–ö–ê: missing field `timeout`
```

### –ó–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

```rust
#[derive(Deserialize)]
struct Config {
    #[serde(default)]
    timeout: u32,  // 0 —è–∫—â–æ –≤—ñ–¥—Å—É—Ç–Ω—î
    
    #[serde(default = "default_retries")]
    retries: u32,  // 3 —è–∫—â–æ –≤—ñ–¥—Å—É—Ç–Ω—î
}

fn default_retries() -> u32 {
    3
}
```

---

## –¢–ï–û–†–Ü–Ø: –ü–û–†–Ø–î–û–ö –ü–û–õ–Ü–í –Ü –î–ï–¢–ï–†–ú–Ü–ù–Ü–ó–ú

### HashMap –Ω–µ –≥–∞—Ä–∞–Ω—Ç—É—î –ø–æ—Ä—è–¥–æ–∫

```rust
use std::collections::HashMap;

let mut map = HashMap::new();
map.insert("z", 1);
map.insert("a", 2);
map.insert("m", 3);

let json = serde_json::to_string(&map).unwrap();
// –ü–æ—Ä—è–¥–æ–∫ –∫–ª—é—á—ñ–≤ –ù–ï–í–ò–ó–ù–ê–ß–ï–ù–ò–ô —ñ –º–æ–∂–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏—Å—å!
```

### –ß–æ–º—É —Ü–µ –ø—Ä–æ–±–ª–µ–º–∞

**–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è**: —Ç–µ—Å—Ç–∏, —â–æ –ø–æ—Ä—ñ–≤–Ω—é—é—Ç—å JSON-—Ä—è–¥–∫–∏, –±—É–¥—É—Ç—å –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–∏–º–∏.

**–ö–µ—à—É–≤–∞–Ω–Ω—è**: —Ö–µ—à JSON-—Ä—è–¥–∫–∞ –±—É–¥–µ —Ä—ñ–∑–Ω–∏–º –¥–ª—è –æ–¥–Ω–∞–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö.

**Diff —Ç–∞ version control**: –∑–º—ñ–Ω–∏ –ø–æ—Ä—è–¥–∫—É —Å—Ç–≤–æ—Ä—é—é—Ç—å "—Ñ–∞–Ω—Ç–æ–º–Ω—ñ" diff-–∏.

**–ü—ñ–¥–ø–∏—Å–∏ —Ç–∞ —Ö–µ—à—ñ**: –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏–π –ø—ñ–¥–ø–∏—Å JSON –±—É–¥–µ —Ä—ñ–∑–Ω–∏–º.

### –†—ñ—à–µ–Ω–Ω—è: BTreeMap –∞–±–æ indexmap

```rust
use std::collections::BTreeMap;

let mut map = BTreeMap::new();
map.insert("z", 1);
map.insert("a", 2);
map.insert("m", 3);

let json = serde_json::to_string(&map).unwrap();
// {"a":2,"m":3,"z":1}  ‚Äî –∑–∞–≤–∂–¥–∏ –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–æ –∑–∞ –∫–ª—é—á–µ–º
```

```rust
use indexmap::IndexMap;

let mut map = IndexMap::new();
map.insert("z", 1);
map.insert("a", 2);

let json = serde_json::to_string(&map).unwrap();
// {"z":1,"a":2}  ‚Äî –ø–æ—Ä—è–¥–æ–∫ –≤—Å—Ç–∞–≤–∫–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–æ
```

### –ü–æ—Ä—è–¥–æ–∫ –ø–æ–ª—ñ–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏

–ü–æ–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ —Å–µ—Ä—ñ–∞–ª—ñ–∑—É—é—Ç—å—Å—è –≤ –ø–æ—Ä—è–¥–∫—É –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è:

```rust
#[derive(Serialize)]
struct Data {
    zebra: i32,  // –ü–µ—Ä—à–µ
    alpha: i32,  // –î—Ä—É–≥–µ
}

let d = Data { zebra: 1, alpha: 2 };
let json = serde_json::to_string(&d).unwrap();
// {"zebra":1,"alpha":2}  ‚Äî –ø–æ—Ä—è–¥–æ–∫ —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π
```

---

## –¢–ï–û–†–Ü–Ø: –ë–Ü–ù–ê–†–ù–Ü –î–ê–ù–Ü –¢–ê BASE64

### JSON –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î –±—ñ–Ω–∞—Ä–Ω—ñ –¥–∞–Ω—ñ

JSON ‚Äî —Ç–µ–∫—Å—Ç–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç. –ë—ñ–Ω–∞—Ä–Ω—ñ –¥–∞–Ω—ñ (–±–∞–π—Ç–∏, –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, —Ñ–∞–π–ª–∏) –ø–æ—Ç—Ä—ñ–±–Ω–æ –∫–æ–¥—É–≤–∞—Ç–∏.

```rust
#[derive(Serialize, Deserialize)]
struct Document {
    name: String,
    #[serde(with = "base64_serde")]
    content: Vec<u8>,
}

mod base64_serde {
    use base64::{Engine, engine::general_purpose::STANDARD};
    use serde::{Deserialize, Deserializer, Serialize, Serializer};
    
    pub fn serialize<S>(bytes: &[u8], serializer: S) -> Result<S::Ok, S::Error>
    where
        S: Serializer,
    {
        let encoded = STANDARD.encode(bytes);
        encoded.serialize(serializer)
    }
    
    pub fn deserialize<'de, D>(deserializer: D) -> Result<Vec<u8>, D::Error>
    where
        D: Deserializer<'de>,
    {
        let s = String::deserialize(deserializer)?;
        STANDARD.decode(&s).map_err(serde::de::Error::custom)
    }
}
```

### Overhead base64

Base64 –∑–±—ñ–ª—å—à—É—î —Ä–æ–∑–º—ñ—Ä –Ω–∞ ~33%. 3 –±–∞–π—Ç–∏ ‚Üí 4 —Å–∏–º–≤–æ–ª–∏.

–î–ª—è –≤–µ–ª–∏–∫–∏—Ö –æ–±—Å—è–≥—ñ–≤ –¥–∞–Ω–∏—Ö —Ä–æ–∑–≥–ª—è–Ω—å—Ç–µ:
- –û–∫—Ä–µ–º—É –ø–µ—Ä–µ–¥–∞—á—É –±—ñ–Ω–∞—Ä–Ω–∏—Ö –¥–∞–Ω–∏—Ö (multipart, presigned URLs)
- –ë—ñ–Ω–∞—Ä–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏ (bincode, MessagePack, Protocol Buffers)

---

## –¢–ï–û–†–Ü–Ø: –í–ï–†–°–Ü–û–ù–£–í–ê–ù–ù–Ø –°–•–ï–ú–ò

### –ü—Ä–æ–±–ª–µ–º–∞: —Å—Ö–µ–º–∞ –∑–º—ñ–Ω—é—î—Ç—å—Å—è

–í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –µ–≤–æ–ª—é—Ü—ñ–æ–Ω—É—î. –°—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–∞–Ω–∏—Ö –∑–º—ñ–Ω—é—é—Ç—å—Å—è. –ê–ª–µ —Å—Ç–∞—Ä—ñ –¥–∞–Ω—ñ (–≤ –±–∞–∑—ñ, –≤ –∫–µ—à—ñ, –≤ –ª–æ–≥–∞—Ö) –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è —É —Å—Ç–∞—Ä–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ.

```rust
// –í–µ—Ä—Å—ñ—è 1
struct UserV1 {
    name: String,
}

// –í–µ—Ä—Å—ñ—è 2: –¥–æ–¥–∞–ª–∏ email
struct UserV2 {
    name: String,
    email: String,  // –ù–æ–≤–µ –ø–æ–ª–µ!
}
```

–Ø–∫—â–æ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Å—Ç–∞—Ä—ñ –¥–∞–Ω—ñ —É –Ω–æ–≤—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```rust
let old_json = r#"{"name":"Alice"}"#;
let user: UserV2 = serde_json::from_str(old_json).unwrap();
// –ü–û–ú–ò–õ–ö–ê: missing field `email`
```

### –†—ñ—à–µ–Ω–Ω—è: –∑–≤–æ—Ä–æ—Ç–Ω—è —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å —á–µ—Ä–µ–∑ Option —Ç–∞ default

```rust
#[derive(Deserialize)]
struct User {
    name: String,
    
    #[serde(default)]
    email: Option<String>,  // None –¥–ª—è —Å—Ç–∞—Ä–∏—Ö –¥–∞–Ω–∏—Ö
    
    #[serde(default = "default_version")]
    schema_version: u32,
}

fn default_version() -> u32 {
    1  // –°—Ç–∞—Ä—ñ –¥–∞–Ω—ñ –±–µ–∑ –≤–µ—Ä—Å—ñ—ó –≤–≤–∞–∂–∞—é—Ç—å—Å—è v1
}
```

### –†—ñ—à–µ–Ω–Ω—è: —è–≤–Ω–µ –≤–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è

```rust
#[derive(Deserialize)]
#[serde(tag = "version")]
enum VersionedUser {
    #[serde(rename = "1")]
    V1 { name: String },
    
    #[serde(rename = "2")]
    V2 { name: String, email: String },
}

impl VersionedUser {
    fn to_latest(self) -> UserV2 {
        match self {
            VersionedUser::V1 { name } => UserV2 {
                name,
                email: String::new(),
            },
            VersionedUser::V2 { name, email } => UserV2 { name, email },
        }
    }
}
```

### –†—ñ—à–µ–Ω–Ω—è: deny_unknown_fields –¥–ª—è —Å—Ç—Ä–æ–≥–æ—Å—Ç—ñ

```rust
#[derive(Deserialize)]
#[serde(deny_unknown_fields)]
struct StrictConfig {
    timeout: u32,
    retries: u32,
}

let json = r#"{"timeout":10,"retries":3,"unknown":"field"}"#;
let config: StrictConfig = serde_json::from_str(json).unwrap();
// –ü–û–ú–ò–õ–ö–ê: unknown field `unknown`
```

–¶–µ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∏—è–≤–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –≤ –Ω–∞–∑–≤–∞—Ö –ø–æ–ª—ñ–≤ —Ç–∞ –Ω–µ—Å—É–º—ñ—Å–Ω—ñ –≤–µ—Ä—Å—ñ—ó.

---

## –¢–ï–û–†–Ü–Ø: –§–û–†–ú–ê–¢–ò –¢–ê –á–• –û–°–û–ë–õ–ò–í–û–°–¢–Ü

### JSON

**–ü–ª—é—Å–∏**: –ª—é–¥–∏–Ω–æ—á–∏—Ç–∞–±–µ–ª—å–Ω–∏–π, —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π, —à–∏—Ä–æ–∫–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞.
**–ú—ñ–Ω—É—Å–∏**: verbose, –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î NaN/Infinity, –ø—Ä–æ–±–ª–µ–º–∏ –∑ –≤–µ–ª–∏–∫–∏–º–∏ —á–∏—Å–ª–∞–º–∏, –Ω–µ–º–∞—î –±—ñ–Ω–∞—Ä–Ω–∏—Ö –¥–∞–Ω–∏—Ö.

```rust
use serde_json;
let json = serde_json::to_string(&data)?;
```

### TOML

**–ü–ª—é—Å–∏**: –ª—é–¥–∏–Ω–æ—á–∏—Ç–∞–±–µ–ª—å–Ω–∏–π, —á—É–¥–æ–≤–∏–π –¥–ª—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π, –ø—ñ–¥—Ç—Ä–∏–º—É—î –¥–∞—Ç–∏.
**–ú—ñ–Ω—É—Å–∏**: –Ω–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö –≤–∫–ª–∞–¥–µ–Ω–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä, –º–µ–Ω—à —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π.

```rust
use toml;
let toml_str = toml::to_string(&config)?;
```

### bincode

**–ü–ª—é—Å–∏**: –∫–æ–º–ø–∞–∫—Ç–Ω–∏–π, —à–≤–∏–¥–∫–∏–π, –ø—ñ–¥—Ç—Ä–∏–º—É—î –≤—Å—ñ Rust-—Ç–∏–ø–∏.
**–ú—ñ–Ω—É—Å–∏**: –Ω–µ –ª—é–¥–∏–Ω–æ—á–∏—Ç–∞–±–µ–ª—å–Ω–∏–π, Rust-—Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–π, –Ω–µ —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç.

```rust
use bincode;
let bytes = bincode::serialize(&data)?;
```

### MessagePack

**–ü–ª—é—Å–∏**: –∫–æ–º–ø–∞–∫—Ç–Ω–∏–π, —à–≤–∏–¥–∫–∏–π, –∫—Ä–æ—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–Ω–∏–π, –ø—ñ–¥—Ç—Ä–∏–º—É—î –±—ñ–Ω–∞—Ä–Ω—ñ –¥–∞–Ω—ñ.
**–ú—ñ–Ω—É—Å–∏**: –Ω–µ –ª—é–¥–∏–Ω–æ—á–∏—Ç–∞–±–µ–ª—å–Ω–∏–π.

```rust
use rmp_serde;
let bytes = rmp_serde::to_vec(&data)?;
```

### –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

| –§–æ—Ä–º–∞—Ç | –†–æ–∑–º—ñ—Ä | –®–≤–∏–¥–∫—ñ—Å—Ç—å | –ß–∏—Ç–∞–±–µ–ª—å–Ω—ñ—Å—Ç—å | –ö—Ä–æ—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º |
|--------|--------|-----------|---------------|---------------|
| JSON | –í–µ–ª–∏–∫–∏–π | –°–µ—Ä–µ–¥–Ω—è | ‚úì | ‚úì |
| TOML | –°–µ—Ä–µ–¥–Ω—ñ–π | –°–µ—Ä–µ–¥–Ω—è | ‚úì | ‚úì |
| bincode | –ú–∞–ª–∏–π | –®–≤–∏–¥–∫–∞ | ‚úó | Rust-only |
| MessagePack | –ú–∞–ª–∏–π | –®–≤–∏–¥–∫–∞ | ‚úó | ‚úì |

---

## –ü–†–ê–ö–¢–ò–ß–ù–Ü –†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–á

### –ü—Ä–∞–≤–∏–ª–æ 1: –í–µ–ª–∏–∫—ñ —á–∏—Å–ª–∞ —è–∫ —Ä—è–¥–∫–∏ –≤ JSON

```rust
#[derive(Serialize, Deserialize)]
struct Transaction {
    #[serde(with = "string_u64")]
    id: u64,
    
    #[serde(with = "string_u64")]
    amount_cents: u64,
}
```

### –ü—Ä–∞–≤–∏–ª–æ 2: –û–±—Ä–æ–±–ª—è–π—Ç–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ float –∑–Ω–∞—á–µ–Ω–Ω—è

```rust
fn validate_for_json(value: f64) -> Result<f64, Error> {
    if value.is_nan() {
        Err(Error::NaN)
    } else if value.is_infinite() {
        Err(Error::Infinite)
    } else {
        Ok(value)
    }
}
```

### –ü—Ä–∞–≤–∏–ª–æ 3: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ default –¥–ª—è –∑–≤–æ—Ä–æ—Ç–Ω—å–æ—ó —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ

```rust
#[derive(Deserialize)]
struct Config {
    #[serde(default)]
    new_field: Option<String>,
    
    #[serde(default = "default_timeout")]
    timeout: u32,
}
```

### –ü—Ä–∞–≤–∏–ª–æ 4: BTreeMap –¥–ª—è –¥–µ—Ç–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫—É

```rust
use std::collections::BTreeMap;

#[derive(Serialize)]
struct Data {
    metadata: BTreeMap<String, String>,  // –ó–∞–≤–∂–¥–∏ –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–æ
}
```

### –ü—Ä–∞–≤–∏–ª–æ 5: –Ø–≤–Ω–æ –≤–∫–∞–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç enum

```rust
#[derive(Serialize, Deserialize)]
#[serde(tag = "type")]  // –Ø–≤–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç
enum Command {
    Start,
    Stop,
    Move { x: f64, y: f64 },
}
```

### –ü—Ä–∞–≤–∏–ª–æ 6: –¢–µ—Å—Ç—É–π—Ç–µ round-trip

```rust
#[test]
fn test_roundtrip() {
    let original = Data {
        id: u64::MAX,
        value: 3.14159,
    };
    
    let json = serde_json::to_string(&original).unwrap();
    let restored: Data = serde_json::from_str(&json).unwrap();
    
    assert_eq!(original.id, restored.id);
    assert!((original.value - restored.value).abs() < 1e-10);
}
```

---

## –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –¥–æ —Ä–æ—é –ë–ü–õ–ê

### –¢–µ–ª–µ–º–µ—Ç—Ä—ñ—è –∑ –±–µ–∑–ø–µ—á–Ω–∏–º–∏ —á–∏—Å–ª–∞–º–∏

```rust
use serde::{Serialize, Deserialize};
use std::collections::BTreeMap;

#[derive(Serialize, Deserialize)]
pub struct DroneTelemetry {
    /// ID –¥—Ä–æ–Ω–∞ —è–∫ —Ä—è–¥–æ–∫ –¥–ª—è —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ –∑ JavaScript
    #[serde(with = "string_u64")]
    pub drone_id: u64,
    
    /// Timestamp —è–∫ —Ä—è–¥–æ–∫ (–º—ñ–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∏ –º–æ–∂—É—Ç—å –ø–µ—Ä–µ–≤–∏—â–∏—Ç–∏ safe integer)
    #[serde(with = "string_u64")]
    pub timestamp_us: u64,
    
    /// –ü–æ–∑–∏—Ü—ñ—è ‚Äî –∑–≤–∏—á–∞–π–Ω—ñ float, –±–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –≤ –±–µ–∑–ø–µ—á–Ω–æ–º—É –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ
    pub position: Position,
    
    /// –ë–∞—Ç–∞—Ä–µ—è ‚Äî –º–æ–∂–µ –±—É—Ç–∏ NaN —è–∫—â–æ —Å–µ–Ω—Å–æ—Ä –≤—ñ–¥–º–æ–≤–∏–≤
    #[serde(serialize_with = "serialize_optional_f64")]
    pub battery_percent: Option<f64>,
    
    /// –ú–µ—Ç–∞–¥–∞–Ω—ñ –≤ –¥–µ—Ç–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É
    pub metadata: BTreeMap<String, String>,
}

#[derive(Serialize, Deserialize)]
pub struct Position {
    pub latitude: f64,
    pub longitude: f64,
    pub altitude: f64,
}

fn serialize_optional_f64<S>(value: &Option<f64>, serializer: S) -> Result<S::Ok, S::Error>
where
    S: serde::Serializer,
{
    match value {
        Some(v) if v.is_finite() => serializer.serialize_some(v),
        _ => serializer.serialize_none(),
    }
}

mod string_u64 {
    use serde::{self, Deserialize, Deserializer, Serializer};
    
    pub fn serialize<S>(value: &u64, serializer: S) -> Result<S::Ok, S::Error>
    where
        S: Serializer,
    {
        serializer.serialize_str(&value.to_string())
    }
    
    pub fn deserialize<'de, D>(deserializer: D) -> Result<u64, D::Error>
    where
        D: Deserializer<'de>,
    {
        let s = String::deserialize(deserializer)?;
        s.parse().map_err(serde::de::Error::custom)
    }
}
```

### –ö–æ–º–∞–Ω–¥–∏ –∑ –≤–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è–º

```rust
#[derive(Serialize, Deserialize)]
#[serde(tag = "command", rename_all = "snake_case")]
pub enum DroneCommand {
    /// –ó–ª—ñ—Ç –Ω–∞ –∑–∞–¥–∞–Ω—É –≤–∏—Å–æ—Ç—É
    Takeoff { 
        altitude: f64,
        #[serde(default)]
        speed: Option<f64>,
    },
    
    /// –ü–æ—Å–∞–¥–∫–∞
    Land {
        #[serde(default)]
        emergency: bool,
    },
    
    /// –ü–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è –¥–æ —Ç–æ—á–∫–∏
    MoveTo {
        target: Position,
        #[serde(default = "default_speed")]
        speed: f64,
    },
    
    /// –í–∏–∫–æ–Ω–∞—Ç–∏ –º—ñ—Å—ñ—é (ID —è–∫ —Ä—è–¥–æ–∫!)
    ExecuteMission {
        #[serde(with = "string_u64")]
        mission_id: u64,
    },
}

fn default_speed() -> f64 {
    5.0  // –º/—Å
}
```

### –ë—ñ–Ω–∞—Ä–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö

```rust
use bincode;

/// –ö–æ–º–ø–∞–∫—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è high-frequency —Ç–µ–ª–µ–º–µ—Ç—Ä—ñ—ó
#[derive(Serialize, Deserialize)]
pub struct CompactTelemetry {
    pub drone_id: u32,
    pub timestamp_ms: u64,
    pub lat: f32,  // –î–æ—Å—Ç–∞—Ç–Ω—è —Ç–æ—á–Ω—ñ—Å—Ç—å –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
    pub lon: f32,
    pub alt: f32,
    pub battery: u8,  // 0-100
    pub status: DroneStatus,
}

impl CompactTelemetry {
    pub fn to_bytes(&self) -> Vec<u8> {
        bincode::serialize(self).expect("Serialization cannot fail")
    }
    
    pub fn from_bytes(bytes: &[u8]) -> Result<Self, bincode::Error> {
        bincode::deserialize(bytes)
    }
}

// –†–æ–∑–º—ñ—Ä: ~25 –±–∞–π—Ç –∑–∞–º—ñ—Å—Ç—å ~200+ –±–∞–π—Ç JSON
```

### –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö

```rust
impl DroneTelemetry {
    pub fn validate(&self) -> Result<(), ValidationError> {
        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
        if !(-90.0..=90.0).contains(&self.position.latitude) {
            return Err(ValidationError::InvalidLatitude(self.position.latitude));
        }
        if !(-180.0..=180.0).contains(&self.position.longitude) {
            return Err(ValidationError::InvalidLongitude(self.position.longitude));
        }
        
        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–∏—Å–æ—Ç–∏ (NaN —Ç–∞ Infinity –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ñ)
        if !self.position.altitude.is_finite() {
            return Err(ValidationError::InvalidAltitude);
        }
        if self.position.altitude < -100.0 || self.position.altitude > 50000.0 {
            return Err(ValidationError::AltitudeOutOfRange(self.position.altitude));
        }
        
        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–∞—Ç–∞—Ä–µ—ó
        if let Some(battery) = self.battery_percent {
            if !(0.0..=100.0).contains(&battery) {
                return Err(ValidationError::InvalidBattery(battery));
            }
        }
        
        Ok(())
    }
}

pub fn deserialize_and_validate(json: &str) -> Result<DroneTelemetry, Error> {
    let telemetry: DroneTelemetry = serde_json::from_str(json)?;
    telemetry.validate()?;
    Ok(telemetry)
}
```

---

## –†–µ–∑—é–º–µ

–£ —Ü—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ –º–∏ —Ä–æ–∑–≥–ª—è–Ω—É–ª–∏ –ø—ñ–¥—Å—Ç—É–ø–Ω—ñ –∞—Å–ø–µ–∫—Ç–∏ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó.

**JSON —ñ –≤–µ–ª–∏–∫—ñ —á–∏—Å–ª–∞**: JavaScript Number —Ç–æ—á–Ω–∏–π –ª–∏—à–µ –¥–æ 2^53. u64 —Ç–∞ i64 –º–æ–∂—É—Ç—å –≤—Ç—Ä–∞—á–∞—Ç–∏ —Ç–æ—á–Ω—ñ—Å—Ç—å. –°–µ—Ä—ñ–∞–ª—ñ–∑—É–π—Ç–µ –≤–µ–ª–∏–∫—ñ —á–∏—Å–ª–∞ —è–∫ —Ä—è–¥–∫–∏.

**NaN —Ç–∞ Infinity**: JSON –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ float –∑–Ω–∞—á–µ–Ω–Ω—è. –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –ø–µ—Ä–µ–¥ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—î—é –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Option/null.

**Enum —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è**: serde –º–∞—î –∫—ñ–ª—å–∫–∞ —Ñ–æ—Ä–º–∞—Ç—ñ–≤ (externally tagged, internally tagged, untagged). –í–∏–±—ñ—Ä –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ —ñ–Ω—à–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.

**Option —ñ null**: None –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º = –≤—ñ–¥—Å—É—Ç–Ω—î –ø–æ–ª–µ, –Ω–µ null. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∞—Ç—Ä–∏–±—É—Ç–∏ –¥–ª—è –ø–æ—Ç—Ä—ñ–±–Ω–æ—ó –ø–æ–≤–µ–¥—ñ–Ω–∫–∏.

**–ü–æ—Ä—è–¥–æ–∫ –ø–æ–ª—ñ–≤**: HashMap –Ω–µ –≥–∞—Ä–∞–Ω—Ç—É—î –ø–æ—Ä—è–¥–æ–∫. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ BTreeMap –∞–±–æ IndexMap –¥–ª—è –¥–µ—Ç–µ—Ä–º—ñ–Ω—ñ–∑–º—É.

**–í–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è**: –Ω–æ–≤—ñ –ø–æ–ª—è –º–∞—é—Ç—å –±—É—Ç–∏ Option –∞–±–æ –º–∞—Ç–∏ default. –†–æ–∑–≥–ª—è–Ω—å—Ç–µ —è–≤–Ω–µ –≤–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö —Å—Ö–µ–º.

**–í–∏–±—ñ—Ä —Ñ–æ—Ä–º–∞—Ç—É**: JSON –¥–ª—è API —Ç–∞ —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ, bincode/MessagePack –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ç–∞ –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç—ñ.

---

## üîó –ó–≤'—è–∑–æ–∫ –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –º–∞—Ç–µ—Ä—ñ–∞–ª–æ–º

–û–ø–∞–Ω—É–≤–∞–≤—à–∏ –ø—ñ–¥—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó, –≤–∏ –≥–æ—Ç–æ–≤—ñ –¥–æ –≤–∏–≤—á–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º —Ä–æ–±–æ—Ç–∏ –∑ —Ñ–∞–π–ª–∞–º–∏ —Ç–∞ —à–ª—è—Ö–∞–º–∏ ‚Äî cross-platform —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å, –∫–æ–¥—É–≤–∞–Ω–Ω—è —ñ–º–µ–Ω —Ñ–∞–π–ª—ñ–≤, —Ç–∞ –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω—ñ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ –º—ñ–∂ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.
